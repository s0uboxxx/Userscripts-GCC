// ==UserScript==
// @name                     GoogleGPT 🤖
// @name:zh-CN               GoogleGPT 🤖
// @description              Adds AI answers to Google Search (powered by Google Gemma + GPT-4o!)
// @description:af           Voeg AI-antwoorde by Google Search (aangedryf deur Google Gemma + GPT-4o!)
// @description:am           የ Google Search ውስጥ AI መልቀቅን አድርግ፣ (Google Gemma + GPT-4o በመሣሪያዎቹ ውስጥ!)
// @description:ar           يضيف إجابات AI إلى Google Search (مدعوم بواسطة Google Gemma + GPT-4o!)
// @description:as           Google Search-লৈ AI উত্তৰ যোগ দিয়ে (Google Gemma + GPT-4o দ্বাৰা পাওৱা হৈছে!)
// @description:az           Google Search-ya AI cavablarını əlavə edir (Google Gemma + GPT-4o tərəfindən dəstəklənir!)
// @description:be           Дадае ІА адказы на Google Search (падтрымліваецца Google Gemma + GPT-4o!)
// @description:bg           Добавя ИИ отговори в Google Search (поддържан от Google Gemma + GPT-4o!)
// @description:bn           Google Search-ত AI উত্তর যোগ করে (Google Gemma + GPT-4o দ্বারা প্রচালিত!)
// @description:bs           Dodaje AI odgovore na Google Search (pokreće Google Gemma + GPT-4o!)
// @description:ca           Afegeix respostes d'IA a Google Search (impulsat per Google Gemma + GPT-4o!)
// @description:ceb          Nagdugang ug mga tubag AI ngadto sa Google Search (gipadagan sa Google Gemma + GPT-4o!)
// @description:co           Aggiunge risposte AI a Google Search (supportate da Google Gemma + GPT-4o!)
// @description:cs           Přidává AI odpovědi do Google Search (poháněno Google Gemma + GPT-4o!)
// @description:cy           Ychwanegu atebion AI i Google Search (a yrrir gan Google Gemma + GPT-4o!)
// @description:da           Tilføjer AI-svar til Google Search (drevet af Google Gemma + GPT-4o!)
// @description:de           Fügt AI-Antworten zu Google Search hinzu (betrieben von Google Gemma + GPT-4o!)
// @description:el           Προσθέτει απαντήσεις AI στο Google Search (τροφοδοτούμενο από Google Gemma + GPT-4o!)
// @description:en           Adds AI answers to Google Search (powered by Google Gemma + GPT-4o!)
// @description:eo           Aldonas AI-respondojn al Google Search (ebligita de Google Gemma + GPT-4o!)
// @description:es           Añade respuestas de IA a Google Search (impulsado por Google Gemma + GPT-4o!)
// @description:et           Lisab AI-vastused Google Search'le (juhitud Google Gemma + GPT-4o-ga!)
// @description:eu           Gehitu IA erantzunak Google Search-n (Google Gemma + GPT-4o-k bultzatuta!)
// @description:fa           پاسخهای هوشمصنوعی به Google Search اضافه میشود (توسط Google Gemma + GPT-4o پشتیبانی میشود!)
// @description:fi           Lisää tekoälyvastauksia Google Search:hun (ohjattu Google Gemma + GPT-4o:lla!)
// @description:fil          Nagdaragdag ng mga sagot ng AI sa Google Search (pinapagana ng Google Gemma + GPT-4o!)
// @description:fo           Bætir AI svar við Google Search (drifin af Google Gemma + GPT-4o!)
// @description:fr           Ajoute des réponses IA à Google Search (propulsé par Google Gemma + GPT-4o!)
// @description:fr-CA        Ajoute des réponses IA à Google Search (propulsé par Google Gemma + GPT-4o!)
// @description:fy           Foeget AI-antwurden ta oan Google Search (dreaun troch Google Gemma + GPT-4o!)
// @description:ga           Cuirtear freagraí AI le Google Search (dírítear ag Google Gemma + GPT-4o!)
// @description:gd           Cur freagairtichean AI ris an Google Search (air a thug seachad le Google Gemma + GPT-4o!)
// @description:gl           Engade respostas de IA a Google Search (impulsado por Google Gemma + GPT-4o!)
// @description:gu           Google Search માટે AI જવાબો ઉમેરે છે (Google Gemma + GPT-4o દ્વારા પોવરેડ!)
// @description:ha           Ƙaddara takardun AI zu Google Search (da aka fi Google Gemma + GPT-4o!)
// @description:haw          Hoʻohui aku i nā hoʻopiʻi AI iā Google Search (hoʻohui ʻia e Google Gemma + GPT-4o!)
// @description:he           מוסיף תשובות AI ל-Google Search (מופעל על ידי Google Gemma + GPT-4o!)
// @description:hi           Google Search में AI उत्तर जोड़ता है (Google Gemma + GPT-4o द्वारा संचालित!)
// @description:hmn          Ntxig AI nruab nruab rau Google Search (pab cuam Google Gemma + GPT-4o!)
// @description:hr           Dodaje AI odgovore na Google Search (pokreće Google Gemma + GPT-4o!)
// @description:ht           Ajoute repons AI nan Google Search (pòte pa Google Gemma + GPT-4o!)
// @description:hu           AI válaszokat ad hozzá a Google Search-hoz (Google Gemma + GPT-4o által hajtva!)
// @description:hy           Ավելացնում է AI պատասխաններ Google Search-ում (աջակցված է Google Gemma + GPT-4o-ով!)
// @description:ia           Adde responas AI a Google Search (propulsate per Google Gemma + GPT-4o!)
// @description:id           Menambahkan jawaban AI ke Google Search (didukung oleh Google Gemma + GPT-4o!)
// @description:ig           Tinye ihe ndekọ AI n'ụzọ ọgụgụ Google Search (n'efu na Google Gemma + GPT-4o!)
// @description:ii           Google Search ᐸᔦᒪᔪᐃᓃᑦ AI ᓇᑕᐅᒪᐃᑦᓯ (Google Gemma + GPT-4o ᓂᑕᔪᑦᓯᐏᑦᑕᒥᔭ!)
// @description:is           Bætir AI svar við Google Search (keyrir á Google Gemma + GPT-4o!)
// @description:it           Aggiunge risposte AI a Google Search (alimentato da Google Gemma + GPT-4o!)
// @description:iu           Google Search ᑲᑎᒪᔪᖅᑐᖅᑐᐃᓐᓇᓂᒃ AI ᑎᑎᕋᖃᕐᓯᒪᓂᖏᓐ (Google Gemma + GPT-4o ᑐᑭᒧᑦᑖᑦ!)
// @description:ja           Google Search に AI 回答を追加します (Google Gemma + GPT-4o で動作！)
// @description:jv           Nambéhi pirangga AI nganti Google Search (diduweni déning Google Gemma + GPT-4o!)
// @description:ka           ამატებს AI პასუხებს Google Search-ს (იმართება Google Gemma + GPT-4o!)
// @description:kk           Google Search-ға AI жауаптарын қосады (Google Gemma + GPT-4o арқылы жұмыс істейді!)
// @description:kl           Google Search-mi AI-t Kalaallit Nunaanni iluani (Google Gemma + GPT-4o! -nip ilaanni!)
// @description:km           បន្ថែមចម្លើយ AI ទៅ Google Search (ដំណើរការដោយ Google Gemma + GPT-4o!)
// @description:kn           Google Search ಗೆ AI ಉತ್ತರಗಳನ್ನು ಸೇರಿಸುತ್ತದೆ (Google Gemma + GPT-4o ನಿಂದ ನಡೆಸಲ್ಪಡುತ್ತಿದೆ!)
// @description:ko           Google Search에 AI 답변을 추가합니다(Google Gemma + GPT-4o 제공!)
// @description:ku           Bersivên AI-ê li Google Search zêde dike (ji hêla Google Gemma + GPT-4o ve hatî hêzdar kirin!)
// @description:ky           Google Search'го AI жоопторун кошот (Google Gemma + GPT-4o тарабынан иштейт!)
// @description:la           Addit AI responsa Google Search (powered per Google Gemma + GPT-4o!)
// @description:lb           Füügt AI Äntwerten op Google Search (ugedriwwen duerch Google Gemma + GPT-4o!)
// @description:lg           Yambula emisomo ey'ensobi ku Google Search (enkuuma Google Gemma + GPT-4o!)
// @description:ln           Ebakisi biyano ya AI na Google Search (ezali na nguya ya Google Gemma + GPT-4o!)
// @description:lo           ເພີ່ມຄໍາຕອບ AI ໃຫ້ກັບ Google Search (ຂັບເຄື່ອນໂດຍ Google Gemma + GPT-4o!)
// @description:lt           Prideda AI atsakymus į „Google Search“ (maitina Google Gemma + GPT-4o!)
// @description:lv           Pievieno AI atbildes Google Search (darbina Google Gemma + GPT-4o!)
// @description:mg           Manampy valiny AI amin'ny Google Search (nampiasain'ny Google Gemma + GPT-4o!)
// @description:mi           Ka taapirihia nga whakautu AI ki a Google Search (whakamahia e Google Gemma + GPT-4o!)
// @description:mk           Додава одговори со вештачка интелигенција на Google Search (напојувано од Google Gemma + GPT-4o!)
// @description:ml           Google Search-യിലേക്ക് AI ഉത്തരങ്ങൾ ചേർക്കുന്നു (Google Gemma + GPT-4o നൽകുന്നതാണ്!)
// @description:mn           Google Search-д AI хариултуудыг нэмдэг (Google Gemma + GPT-4o-оор ажилладаг!)
// @description:mr           Google Search ला AI उत्तरे जोडते (Google Gemma + GPT-4o द्वारे समर्थित!)
// @description:ms           Menambahkan jawapan AI pada Google Search (dikuasakan oleh Google Gemma + GPT-4o!)
// @description:mt           Iżżid it-tweġibiet AI għal Google Search (mħaddma minn Google Gemma + GPT-4o!)
// @description:my           Google Search (Google Gemma + GPT-4o ဖြင့် စွမ်းဆောင်ထားသည့်) တွင် AI အဖြေများကို ပေါင်းထည့်သည်
// @description:na           Aeta AI teroma i Google Search (ira Google Gemma + GPT-4o reke akea!)
// @description:nb           Legger til AI-svar på Google Search (drevet av Google Gemma + GPT-4o!)
// @description:nd           Iyatholakala amaswelelo e-AI kuGoogle Search (kuyatholakala ngokulawula uGoogle Gemma + GPT-4o!)
// @description:ne           Google Search मा AI जवाफहरू थप्छ (Google Gemma + GPT-4o द्वारा संचालित!)
// @description:ng           Ondjova mbelelo dha AI moGoogle Search (uumbuli nguGoogle Gemma + GPT-4o!)
// @description:nl           Voegt AI-antwoorden toe aan Google Search (mogelijk gemaakt door Google Gemma + GPT-4o!)
// @description:nn           Legg til AI-svar på Google Search (drevet av Google Gemma + GPT-4o!)
// @description:no           Legger til AI-svar til Google Search (drevet av Google Gemma + GPT-4o!)
// @description:nso          Ya go etela ditshenyegi tsa AI mo Google Search (e dirwang ke Google Gemma + GPT-4o!)
// @description:ny           Imawonjezera mayankho a AI ku Google Search (yoyendetsedwa ndi Google Gemma + GPT-4o!)
// @description:oc           Ajusta de respòstas d'IA a Google Search (amb Google Gemma + GPT-4o!)
// @description:om           Deebii AI Google Search (Google Gemma + GPT-4o'n kan hojjetu!) irratti dabalata.
// @description:or           Google Search କୁ AI ଉତ୍ତର ଯୋଗ କରେ (Google Gemma + GPT-4o ଦ୍ୱାରା ଚାଳିତ!)
// @description:pa           Google Search (Google Gemma + GPT-4o ਦੁਆਰਾ ਸੰਚਾਲਿਤ!) ਵਿੱਚ AI ਜਵਾਬ ਸ਼ਾਮਲ ਕਰਦਾ ਹੈ
// @description:pl           Dodaje odpowiedzi AI do Google Search (obsługiwane przez Google Gemma + GPT-4o!)
// @description:ps           Google Search ته د AI ځوابونه اضافه کوي (د Google Gemma + GPT-4o لخوا پرمخ وړل کیږي!)
// @description:pt           Adiciona respostas de IA ao Google Search (desenvolvido por Google Gemma + GPT-4o!)
// @description:pt-BR        Adiciona respostas de IA ao Google Search (desenvolvido por Google Gemma + GPT-4o!)
// @description:qu           Google Search (Google Gemma + GPT-4o nisqawan kallpachasqa!) nisqaman AI kutichiykunata yapan.
// @description:rm           Agiuntescha respostas d'IA a Google Search (propulsà da Google Gemma + GPT-4o!)
// @description:rn           Abafasha inyandiko z'IA ku Google Search (yashyizweho na Google Gemma + GPT-4o!)
// @description:ro           Adaugă răspunsuri AI la Google Search (alimentat de Google Gemma + GPT-4o!)
// @description:ru           Добавляет ответы ИИ в Google Search (на базе Google Gemma + GPT-4o!)
// @description:rw           Ongeraho ibisubizo bya AI kuri Google Search (ikoreshwa na Google Gemma + GPT-4o!)
// @description:sa           Google Search (Google Gemma + GPT-4o द्वारा संचालितम्!) इत्यत्र AI उत्तराणि योजयति ।
// @description:sat          Google Search ar AI jawab khon ojantok (Google Gemma + GPT-4o! sebadha manju)
// @description:sc           Agiungit rispostas de IA a Google Search (motorizadu da Google Gemma + GPT-4o!)
// @description:sd           شامل ڪري ٿو AI جوابن کي Google Search (Google Gemma + GPT-4o پاران طاقتور!)
// @description:se           Lávdegáhtii AI vástid Google Search (Google Gemma + GPT-4o! vuosttas!)
// @description:sg           Nâ tî-kûzâ mái vêdáara AI mbi Google Search (ngâ Google Gemma + GPT-4o!)
// @description:si           Google Search වෙත AI පිළිතුරු එක් කරයි (Google Gemma + GPT-4o මගින් බලගන්වයි!)
// @description:sk           Pridáva odpovede AI do Google Search (poháňané Google Gemma + GPT-4o!)
// @description:sl           Dodaja odgovore AI v Google Search (poganja Google Gemma + GPT-4o!)
// @description:sm           Faʻaopoopo tali AI ile Google Search (faʻamalosia e Google Gemma + GPT-4o!)
// @description:sn           Inowedzera mhinduro dzeAI kuGoogle Search (inofambiswa neGoogle Gemma + GPT-4o!)
// @description:so           Waxay ku dartay jawaabaha AI Google Search (waxaa ku shaqeeya Google Gemma + GPT-4o!)
// @description:sq           Shton përgjigjet e AI në Google Search (mundësuar nga Google Gemma + GPT-4o!)
// @description:sr           Додаје АИ одговоре у Google Search (покреће ГПТ-4о!)
// @description:ss           Iphendvulela izindlela zezilungiselelo ku-Google Search (izenzakalo nge-Google Gemma + GPT-4o!)
// @description:st           E kopanetse diqoqo tsa AI ka Google Search (ka sebelisoa ke Google Gemma + GPT-4o!)
// @description:su           Nambahkeun jawaban AI kana Google Search (dikuatkeun ku Google Gemma + GPT-4o!)
// @description:sv           Lägger till AI-svar till Google Search (driven av Google Gemma + GPT-4o!)
// @description:sw           Inaongeza majibu ya AI kwa Google Search (inaendeshwa na Google Gemma + GPT-4o!)
// @description:ta           Google Search க்கு AI பதில்களைச் சேர்க்கிறது (Google Gemma + GPT-4o மூலம் இயக்கப்படுகிறது!)
// @description:te           Google Searchకి AI సమాధానాలను జోడిస్తుంది (Google Gemma + GPT-4o ద్వారా ఆధారితం!)
// @description:tg           Ба Google Search ҷавобҳои AI илова мекунад (аз ҷониби Google Gemma + GPT-4o!)
// @description:th           เพิ่มคำตอบ AI ให้กับ Google Search (ขับเคลื่อนโดย Google Gemma + GPT-4o!)
// @description:ti           ናብ Google Search (ብGoogle Gemma + GPT-4o ዝሰርሕ!) ናይ AI መልስታት ይውስኸሉ።
// @description:tk           Google Search-a AI jogaplaryny goşýar (Google Gemma + GPT-4o bilen işleýär!)
// @description:tl           Nagdadagdag ng mga sagot ng AI sa Google Search (pinapatakbo ng Google Gemma + GPT-4o!)
// @description:tn           O amogela dipotso tsa AI mo Google Search (e a nang le Google Gemma + GPT-4o!)
// @description:to           Tambisa mabizo a AI ku Google Search (mukutenga na Google Gemma + GPT-4o!)
// @description:tr           Google Search'ya yapay zeka yanıtları ekler (Google Gemma + GPT-4o tarafından desteklenmektedir!)
// @description:ts           Ku engetela tinhlamulo ta AI eka Google Search (leyi fambiwaka hi Google Gemma + GPT-4o!)
// @description:tt           Google Search'ка AI җаваплары өсти (Google Gemma + GPT-4o белән эшләнгән!)
// @description:tw           Ɔde AI mmuae ka Google Search (a Google Gemma + GPT-4o na ɛma ahoɔden!) ho.
// @description:ug           Google Search ۋەبسېتكە AI جاۋابلار قوشۇدۇ (Google Gemma + GPT-4o تەكشۈرگۈچى بىلەن!)
// @description:uk           Додає відповіді штучного інтелекту в Google Search (на базі Google Gemma + GPT-4o!)
// @description:ur           Google Search میں AI جوابات شامل کرتا ہے (Google Gemma + GPT-4o کے ذریعے تقویت یافتہ!)
// @description:uz           Google Search-ga AI javoblarini qo'shadi (Google Gemma + GPT-4o tomonidan quvvatlanadi!)
// @description:vi           Thêm câu trả lời AI vào Google Search (được cung cấp bởi Google Gemma + GPT-4o!)
// @description:xh           Yongeza iimpendulo ze-AI kwi-Google Search (ixhaswe yi-Google Gemma + GPT-4o!)
// @description:yi           לייגט אַי ענטפֿערס צו Google Search (Powered דורך Google Gemma + GPT-4o!)
// @description:yo           Ṣe afikun awọn idahun AI si Google Search (agbara nipasẹ Google Gemma + GPT-4o!)
// @description:zh           为 Google Search 添加 AI 答案（由 Google Gemma + GPT-4o 提供支持！）
// @description:zh-CN        为 Google Search 添加 AI 答案（由 Google Gemma + GPT-4o 提供支持！）
// @description:zh-HK        為 Google Search 添加 AI 答案（由 Google Gemma + GPT-4o 提供支援！）
// @description:zh-SG        为 Google Search 添加 AI 答案（由 Google Gemma + GPT-4o 提供支持！）
// @description:zh-TW        為 Google Search 添加 AI 答案（由 Google Gemma + GPT-4o 提供支援！）
// @description:zu           Yengeza izimpendulo ze-AI ku-Google Search (inikwa amandla yi-Google Gemma + GPT-4o!)
// @author                   KudoAI
// @namespace                https://kudoai.com
// @version                  2024.12.19.6
// @license                  MIT
// @icon                     https://media.googlegpt.io/images/icons/googlegpt/black/icon48.png?8652a6e
// @icon64                   https://media.googlegpt.io/images/icons/googlegpt/black/icon64.png?8652a6e
// @antifeature              ads A very tiny text ad displays below GoogleGPT chatbar. This motivates me to spend otherwise unpaid time upgrading script w/ new features & APIs.
// @antifeature              referral-link
// @compatible               chrome except for Streaming Mode w/ Tampermonkey (use ScriptCat instead)
// @compatible               firefox
// @compatible               edge except for Streaming Mode w/ Tampermonkey (use ScriptCat instead)
// @compatible               safari
// @compatible               opera after allowing userscript manager access to search page results in opera://extensions
// @compatible               brave except for Streaming Mode w/ Tampermonkey (use ScriptCat instead)
// @compatible               vivaldi except for Streaming Mode w/ Tampermonkey (use ScriptCat instead)
// @compatible               waterfox
// @compatible               librewolf
// @compatible               ghost
// @compatible               qq
// @compatible               whale
// @compatible               kiwi
// @compatible               mask
// @compatible               orion
// @match                    *://*.google.com/search*
// @match                    *://*.google.ad/search*
// @match                    *://*.google.ae/search*
// @match                    *://*.google.com.af/search*
// @match                    *://*.google.com.ag/search*
// @match                    *://*.google.com.ai/search*
// @match                    *://*.google.al/search*
// @match                    *://*.google.am/search*
// @match                    *://*.google.co.ao/search*
// @match                    *://*.google.com.ar/search*
// @match                    *://*.google.as/search*
// @match                    *://*.google.at/search*
// @match                    *://*.google.com.au/search*
// @match                    *://*.google.az/search*
// @match                    *://*.google.ba/search*
// @match                    *://*.google.com.bd/search*
// @match                    *://*.google.be/search*
// @match                    *://*.google.bf/search*
// @match                    *://*.google.bg/search*
// @match                    *://*.google.com.bh/search*
// @match                    *://*.google.bi/search*
// @match                    *://*.google.bj/search*
// @match                    *://*.google.com.bn/search*
// @match                    *://*.google.com.bo/search*
// @match                    *://*.google.com.br/search*
// @match                    *://*.google.bs/search*
// @match                    *://*.google.bt/search*
// @match                    *://*.google.co.bw/search*
// @match                    *://*.google.by/search*
// @match                    *://*.google.com.bz/search*
// @match                    *://*.google.ca/search*
// @match                    *://*.google.cd/search*
// @match                    *://*.google.cf/search*
// @match                    *://*.google.cg/search*
// @match                    *://*.google.ch/search*
// @match                    *://*.google.ci/search*
// @match                    *://*.google.co.ck/search*
// @match                    *://*.google.cl/search*
// @match                    *://*.google.cm/search*
// @match                    *://*.google.cn/search*
// @match                    *://*.google.com.co/search*
// @match                    *://*.google.co.cr/search*
// @match                    *://*.google.com.cu/search*
// @match                    *://*.google.cv/search*
// @match                    *://*.google.com.cy/search*
// @match                    *://*.google.cz/search*
// @match                    *://*.google.de/search*
// @match                    *://*.google.dj/search*
// @match                    *://*.google.dk/search*
// @match                    *://*.google.dm/search*
// @match                    *://*.google.com.do/search*
// @match                    *://*.google.dz/search*
// @match                    *://*.google.com.ec/search*
// @match                    *://*.google.ee/search*
// @match                    *://*.google.com.eg/search*
// @match                    *://*.google.es/search*
// @match                    *://*.google.com.et/search*
// @match                    *://*.google.fi/search*
// @match                    *://*.google.com.fj/search*
// @match                    *://*.google.fm/search*
// @match                    *://*.google.fr/search*
// @match                    *://*.google.ga/search*
// @match                    *://*.google.ge/search*
// @match                    *://*.google.gg/search*
// @match                    *://*.google.com.gh/search*
// @match                    *://*.google.com.gi/search*
// @match                    *://*.google.gl/search*
// @match                    *://*.google.gm/search*
// @match                    *://*.google.gr/search*
// @match                    *://*.google.com.gt/search*
// @match                    *://*.google.gy/search*
// @match                    *://*.google.com.hk/search*
// @match                    *://*.google.hn/search*
// @match                    *://*.google.hr/search*
// @match                    *://*.google.ht/search*
// @match                    *://*.google.hu/search*
// @match                    *://*.google.co.id/search*
// @match                    *://*.google.ie/search*
// @match                    *://*.google.co.il/search*
// @match                    *://*.google.im/search*
// @match                    *://*.google.co.in/search*
// @match                    *://*.google.iq/search*
// @match                    *://*.google.is/search*
// @match                    *://*.google.it/search*
// @match                    *://*.google.je/search*
// @match                    *://*.google.com.jm/search*
// @match                    *://*.google.jo/search*
// @match                    *://*.google.co.jp/search*
// @match                    *://*.google.co.ke/search*
// @match                    *://*.google.com.kh/search*
// @match                    *://*.google.ki/search*
// @match                    *://*.google.kg/search*
// @match                    *://*.google.co.kr/search*
// @match                    *://*.google.com.kw/search*
// @match                    *://*.google.kz/search*
// @match                    *://*.google.la/search*
// @match                    *://*.google.com.lb/search*
// @match                    *://*.google.li/search*
// @match                    *://*.google.lk/search*
// @match                    *://*.google.co.ls/search*
// @match                    *://*.google.lt/search*
// @match                    *://*.google.lu/search*
// @match                    *://*.google.lv/search*
// @match                    *://*.google.com.ly/search*
// @match                    *://*.google.co.ma/search*
// @match                    *://*.google.md/search*
// @match                    *://*.google.me/search*
// @match                    *://*.google.mg/search*
// @match                    *://*.google.mk/search*
// @match                    *://*.google.ml/search*
// @match                    *://*.google.com.mm/search*
// @match                    *://*.google.mn/search*
// @match                    *://*.google.ms/search*
// @match                    *://*.google.com.mt/search*
// @match                    *://*.google.mu/search*
// @match                    *://*.google.mv/search*
// @match                    *://*.google.mw/search*
// @match                    *://*.google.com.mx/search*
// @match                    *://*.google.com.my/search*
// @match                    *://*.google.co.mz/search*
// @match                    *://*.google.com.na/search*
// @match                    *://*.google.com.ng/search*
// @match                    *://*.google.com.ni/search*
// @match                    *://*.google.ne/search*
// @match                    *://*.google.nl/search*
// @match                    *://*.google.no/search*
// @match                    *://*.google.com.np/search*
// @match                    *://*.google.nr/search*
// @match                    *://*.google.nu/search*
// @match                    *://*.google.co.nz/search*
// @match                    *://*.google.com.om/search*
// @match                    *://*.google.com.pa/search*
// @match                    *://*.google.com.pe/search*
// @match                    *://*.google.com.pg/search*
// @match                    *://*.google.com.ph/search*
// @match                    *://*.google.com.pk/search*
// @match                    *://*.google.pl/search*
// @match                    *://*.google.pn/search*
// @match                    *://*.google.com.pr/search*
// @match                    *://*.google.ps/search*
// @match                    *://*.google.pt/search*
// @match                    *://*.google.com.py/search*
// @match                    *://*.google.com.qa/search*
// @match                    *://*.google.ro/search*
// @match                    *://*.google.ru/search*
// @match                    *://*.google.rw/search*
// @match                    *://*.google.com.sa/search*
// @match                    *://*.google.com.sb/search*
// @match                    *://*.google.sc/search*
// @match                    *://*.google.se/search*
// @match                    *://*.google.com.sg/search*
// @match                    *://*.google.sh/search*
// @match                    *://*.google.si/search*
// @match                    *://*.google.sk/search*
// @match                    *://*.google.com.sl/search*
// @match                    *://*.google.sn/search*
// @match                    *://*.google.so/search*
// @match                    *://*.google.sm/search*
// @match                    *://*.google.sr/search*
// @match                    *://*.google.st/search*
// @match                    *://*.google.com.sv/search*
// @match                    *://*.google.td/search*
// @match                    *://*.google.tg/search*
// @match                    *://*.google.co.th/search*
// @match                    *://*.google.com.tj/search*
// @match                    *://*.google.tl/search*
// @match                    *://*.google.tm/search*
// @match                    *://*.google.tn/search*
// @match                    *://*.google.to/search*
// @match                    *://*.google.com.tr/search*
// @match                    *://*.google.tt/search*
// @match                    *://*.google.com.tw/search*
// @match                    *://*.google.co.tz/search*
// @match                    *://*.google.com.ua/search*
// @match                    *://*.google.co.ug/search*
// @match                    *://*.google.co.uk/search*
// @match                    *://*.google.com.uy/search*
// @match                    *://*.google.co.uz/search*
// @match                    *://*.google.com.vc/search*
// @match                    *://*.google.co.ve/search*
// @match                    *://*.google.vg/search*
// @match                    *://*.google.co.vi/search*
// @match                    *://*.google.com.vn/search*
// @match                    *://*.google.vu/search*
// @match                    *://*.google.ws/search*
// @match                    *://*.google.rs/search*
// @match                    *://*.google.co.za/search*
// @match                    *://*.google.co.zm/search*
// @match                    *://*.google.co.zw/search*
// @match                    *://*.google.cat/search*
// @include                  https://auth0.openai.com
// @connect                  api.binjie.fun
// @connect                  api.openai.com
// @connect                  api11.gptforlove.com
// @connect                  cdn.jsdelivr.net
// @connect                  chatai.mixerbox.com
// @connect                  chatgpt.com
// @connect                  update.greasyfork.org
// @connect                  fanyi.sogou.com
// @require                  https://cdn.jsdelivr.net/npm/@kudoai/chatgpt.js@3.3.5/dist/chatgpt.min.js#sha256-rfC4kk8q0byrafp7X0Qf9vaa3JNvkHRwNnUt6uL2hUE=
// @require                  https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js#sha256-dppVXeVTurw1ozOPNE3XqhYmDJPOosfbKQcHyQSE58w=
// @require                  https://cdn.jsdelivr.net/npm/generate-ip@2.4.4/dist/generate-ip.min.js#sha256-aQQKAQcMgCu8IpJp9HKs387x0uYxngO+Fb4pc5nSF4I=
// @require                  https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js#sha256-g3pvpbDHNrUrveKythkPMF2j/J7UFoHbUyFQcFe1yEY=
// @require                  https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js#sha256-n0UwfFeU7SR6DQlfOmLlLvIhWmeyMnIDp/2RmVmuedE=
// @require                  https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js#sha256-e1fUJ6xicGd9r42DgN7SzHMzb5FJoWe44f4NbvZmBK4=
// @require                  https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js#sha256-Ffq85bZYmLMrA/XtJen4kacprUwNbYdxEKd0SqhHqJQ=
// @resource ggptIconBlack   https://cdn.jsdelivr.net/gh/KudoAI/googlegpt@c5323fb/media/images/icons/googlegpt/black/icon64.png.b64#sha256-yiTqggYRNsWcJtyIUDzFrPqrL3yeTaPCrEGAW0QFuPM=
// @resource ggptIconWhite   https://cdn.jsdelivr.net/gh/KudoAI/googlegpt@c5323fb/media/images/icons/googlegpt/white/icon64.png.b64#sha256-BYRq92cF5knykaKnmNi1U4CrwBC/jK1V+MGfH4NGui4=
// @resource ggptLSlogo      https://cdn.jsdelivr.net/gh/KudoAI/googlegpt@612b976/media/images/logos/googlegpt/flat/black-green/logo480x64.png.b64#sha256-fzSZhLVQQolCLWYr/h29NWfR1Yl4glHv1TcsveYYv+U=
// @resource ggptDSlogo      https://cdn.jsdelivr.net/gh/KudoAI/googlegpt@612b976/media/images/logos/googlegpt/flat/white-green/logo480x64.png.b64#sha256-3qRdGKhF3pojDqVVh/5kODIg7QvYbbLf4zFkEh5xoGc=
// @resource hljsCSS         https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/dark.min.css#sha256-v0N76BFFkH0dCB8bUr4cHSVN8A/zCaOopMuSmJWV/5w=
// @resource brsCSS          https://assets.aiwebextensions.com/styles/rising-stars/dist/black.min.css?v=0cde30f9ae3ce99ae998141f6e7a36de9b0cc2e7#sha256-4nbm81/JSas4wmxFIdliBBzoEEHRZ057TpzNX1PoQIs=
// @resource wrsCSS          https://assets.aiwebextensions.com/styles/rising-stars/dist/white.min.css?v=0cde30f9ae3ce99ae998141f6e7a36de9b0cc2e7#sha256-pW8xWWV6tm8Q6Ms+HWZv6+QzzTLJPyL1DyE18ywpVaE=
// @grant                    GM_getValue
// @grant                    GM_setValue
// @grant                    GM_deleteValue
// @grant                    GM_cookie
// @grant                    GM_registerMenuCommand
// @grant                    GM_unregisterMenuCommand
// @grant                    GM_openInTab
// @grant                    GM_getResourceText
// @grant                    GM_xmlhttpRequest
// @grant                    GM.xmlHttpRequest
// @noframes
// @homepageURL              https://www.googlegpt.io
// @supportURL               https://support.googlegpt.io
// @contributionURL          https://github.com/sponsors/KudoAI
// @downloadURL https://raw.githubusercontent.com/s0uboxxx/Userscripts-GCC/release/release/GoogleGPT20F09FA496.user.js
// @updateURL https://raw.githubusercontent.com/s0uboxxx/Userscripts-GCC/release/release/GoogleGPT20F09FA496.meta.js
// ==/UserScript==
(async()=>{const e={browser:{language:chatgpt.getUserLanguage()},scriptManager:{name:(()=>{try{return GM_info.scriptHandler}catch(e){return"unknown"}})(),version:(()=>{try{return GM_info.version}catch(e){return"unknown"}})()}};["Chrome","Firefox","Edge","Brave","Mobile"].forEach((t=>e.browser[`is${"Firefox"==t?"FF":t}`]=chatgpt.browser["is"+t]())),e.browser.isPortrait=e.browser.isMobile&&window.innerWidth<window.innerHeight,e.userLocale=location.hostname.endsWith(".com")?"us":location.hostname.split(".").pop();const t="undefined"!=typeof GM&&GM.xmlHttpRequest||GM_xmlhttpRequest,s={name:"GoogleGPT",version:GM_info.script.version,symbol:"🤖",configKeyPrefix:"googleGPT",cssPrefix:"googlegpt",chatgptJSver:/chatgpt\.js@([\d.]+)/.exec(GM_info.scriptMetaStr)[1],urls:{app:"https://www.googlegpt.io",chatgptJS:"https://chatgpt.js.org",gitHub:"https://github.com/KudoAI/googlegpt",greasyFork:"https://greasyfork.org/scripts/478597-googlegpt",publisher:"https://www.kudoai.com",relatedExtensions:"https://github.com/adamlui/ai-web-extensions",review:{greasyFork:"https://greasyfork.org/scripts/478597-googlegpt/feedback#post-discussion"},support:"https://support.googlegpt.io"},latestAssetCommitHash:"ab9d07b"};s.urls.assetHost=s.urls.gitHub.replace("github.com","cdn.jsdelivr.net/gh")+`@${s.latestAssetCommitHash}`,s.urls.update=s.urls.greasyFork.replace("https://","https://update.").replace(/(\d+)-?([a-z-]*)$/i,((e,t,s)=>`${t}/${s||"script"}.meta.js`)),s.msgs={appDesc:"Adds AI answers to Google Search (powered by Google Gemma + GPT-4o!)",menuLabel_autoGetAnswers:"Auto-Get Answers",menuLabel_autoFocusChatbar:"Auto-Focus Chatbar",menuLabel_whenStreaming:"when streaming",menuLabel_proxyAPImode:"Proxy API Mode",menuLabel_show:"Show",menuLabel_relatedQueries:"Related Queries",menuLabel_require:"Require",menuLabel_beforeQuery:"before query",menuLabel_afterQuery:"after query",menuLabel_widerSidebar:"Wider Sidebar",menuLabel_stickySidebar:"Sticky Sidebar",menuLabel_pinTo:"Pin to",menuLabel_top:"Top",menuLabel_sidebar:"Sidebar",menuLabel_bottom:"Bottom",menuLabel_background:"Background",menuLabel_foreground:"Foreground",menuLabel_animations:"Animations",menuLabel_replyLanguage:"Reply Language",menuLabel_colorScheme:"Color Scheme",menuLabel_auto:"Auto",menuLabel_about:"About",menuLabel_settings:"Settings",about_version:"Version",about_poweredBy:"Powered by",about_sourceCode:"Source code",scheme_light:"Light",scheme_dark:"Dark",mode_proxy:"Proxy Mode",mode_streaming:"Streaming Mode",mode_autoScroll:"Auto-Scroll",mode_prefix:"Prefix Mode",mode_suffix:"Suffix Mode",mode_anchor:"Anchor Mode",mode_debug:"Debug Mode",tooltip_playAnswer:"Play answer",tooltip_fontSize:"Font size",tooltip_sendReply:"Send reply",tooltip_feelingLucky:"I'm Feeling Lucky",tooltip_minimize:"Minimize",tooltip_restore:"Restore",tooltip_expand:"Expand",tooltip_shrink:"Shrink",tooltip_close:"Close",tooltip_copy:"Copy",tooltip_regen:"Regenerate",tooltip_reply:"Reply",tooltip_code:"Code",tooltip_sendRelatedQuery:"Send related query",helptip_proxyAPImode:"Uses a Proxy API for no-login access to AI",helptip_streamingMode:"Receive replies in a continuous text stream",helptip_autoGetAnswers:"Auto-send queries to GoogleGPT when using search engine",helptip_autoFocusChatbar:"Auto-focus chatbar whenever it appears",helptip_autoScroll:"Auto-scroll responses as they generate in Streaming Mode",helptip_showRelatedQueries:"Show related queries below chatbar",helptip_prefixMode:'Require "/" before queries for answers to show',helptip_suffixMode:'Require "?" after queries for answers to show',helptip_widerSidebar:"Horizontally expand search page sidebar",helptip_stickySidebar:"Makes GoogleGPT visible in sidebar even as you scroll",helptip_anchorMode:"Anchor GoogleGPT to bottom of window",helptip_bgAnimations:"Show animated backgrounds in UI components",helptip_fgAnimations:"Show foreground animations in UI components",helptip_replyLanguage:"Language for GoogleGPT to reply in",helptip_colorScheme:"Scheme to display GoogleGPT UI components in",helptip_debugMode:"Show detailed logging in browser console",placeholder_askSomethingElse:"Ask something else",placeholder_typeSomething:"Type something",prompt_updateReplyLang:"Update reply language",alert_langUpdated:"Language updated",alert_willReplyIn:"will reply in",alert_yourSysLang:"your system language",alert_choosePlatform:"Choose a platform",alert_updateAvail:"Update available",alert_newerVer:"An update to",alert_isAvail:"is available",alert_upToDate:"Up-to-date",alert_isUpToDate:"is up-to-date",alert_isUnsupportedIn:"is unsupported in",alert_whenUsing:"when using",alert_pleaseUse:"Please use",alert_instead:"instead",alert_unavailable:"unavailable",alert_isOnlyAvailFor:"is only available for",alert_and:"and",alert_userscriptMgrNoStream:"Your userscript manager does not support returning stream responses",alert_isCurrentlyOnlyAvailBy:"is currently only available by",alert_openAIsupportSoon:"Support for OpenAI API will be added shortly",alert_waitingFor:"Waiting for",alert_response:"response",alert_login:"Please login",alert_thenRefreshPage:"then refresh this page",alert_tooManyRequests:"ChatGPT is flooded with too many requests",alert_parseFailed:"Failed to parse response JSON",alert_checkCloudflare:"Please pass Cloudflare security check",alert_notWorking:"is not working",alert_ifIssuePersists:"If issue persists",alert_try:"Try",alert_switchingOn:"switching on",alert_switchingOff:"switching off",notif_copiedToClipboard:"Copied to clipboard",btnLabel_sendQueryToApp:"Send search query to GoogleGPT",btnLabel_moreAIextensions:"More AI Extensions",btnLabel_rateUs:"Rate Us",btnLabel_getSupport:"Get Support",btnLabel_checkForUpdates:"Check for Updates",btnLabel_update:"Update",btnLabel_dismiss:"Dismiss",link_viewChanges:"View changes",link_shareFeedback:"Share Feedback",prefix_exit:"Exit",state_on:"On",state_off:"Off"};const o={},r={load(...e){Array.isArray(e[0])&&(e=e[0]),e.forEach((e=>o[e]=GM_getValue(s.configKeyPrefix+"_"+e,!1)))},save(e,t){GM_setValue(s.configKeyPrefix+"_"+e,t),o[e]=t}};r.load("debugMode");const a={styles:{prefix:{base:"color: white ; padding: 2px 3px 2px 5px ; border-radius: 2px ; "+(e.browser.isFF?"font-size: 13px ;":""),info:"background: linear-gradient(344deg, rgba(0,0,0,1) 0%,rgba(0,0,0,1) 39%, rgba(30,29,43,0.6026611328125) 93%)",working:"background: linear-gradient(342deg, rgba(255,128,0,1) 0%,rgba(255,128,0,0.9612045501794468) 57%, rgba(255,128,0,0.7539216370141807) 93%)",success:"background: linear-gradient(344deg, rgba(0,107,41,1) 0%,rgba(3,147,58,1) 39%, rgba(24,126,42,0.7735294801514356) 93%)",warning:"background: linear-gradient(344deg, rgba(255,0,0,1) 0%,rgba(232,41,41,0.9079832616640406) 57%, rgba(222,49,49,0.6530813008797269) 93%)",caller:"color: blue"},msg:{working:"color: #ff8000",warning:"color: red"}},regEx:{greenVals:{caseInsensitive:/\b(?:true|\d+)\b|success\W?/i,caseSensitive:/\bON\b/},redVals:{caseInsensitive:/\bfalse\b|error\W?/i,caseSensitive:/\BOFF\b/},purpVals:/[ '"]\w+['"]?: /},prettifyObj:e=>JSON.stringify(e).replace(/([{,](?=")|":)/g,"$1 ").replace(/((?<!\})\})/g," $1").replace(/"/g,"'"),toTitleCase:e=>e.charAt(0).toUpperCase()+e.slice(1)};if(["info","error","debug"].forEach((e=>a[e]=function(){if("debug"==e&&!o.debugMode)return;const t=Array.from(arguments).map((e=>"object"==typeof e?JSON.stringify(e):e)),r=t.some((e=>/\.{3}$/.test(e)))?"working":t.some((e=>/\bsuccess\b|!$/i.test(e)))?"success":t.some((e=>/\b(?:error|fail)\b/i.test(e)))||"error"==e?"warning":"info",n=a.styles.prefix.base+a.styles.prefix[r],i=a.styles.msg[r],l=[],c=Object.values(a.regEx).flatMap((e=>e instanceof RegExp?[e]:Object.values(e).filter((e=>e instanceof RegExp)))),p=new RegExp(c.map((e=>e.source)).join("|"),"g");let d="error"==e&&1==t.length?"ERROR: ":"";t.forEach(((e,t)=>{d+=t>0?1==t?": ":" ":"",d+=e?.toString().replace(p,(e=>(!(Object.values(a.regEx.greenVals).some((t=>{if(t.test(e))return l.push("color: green",i),!0}))||Object.values(a.regEx.redVals).some((t=>{if(t.test(e))return l.push("color: red",i),!0})))&&a.regEx.purpVals.test(e)&&l.push("color: #dd29f4",i),`%c${e}%c`)))})),console["error"==e?e:"info"](`${s.symbol} %c${s.name}%c ${a.caller?`${a.caller} » `:""}%c${d}`,n,a.styles.prefix.caller,i,...l)})),!e.browser.language.startsWith("en")){a.debug("Localizing app messages...");const o=await new Promise((o=>{const r=s.urls.assetHost+"/greasemonkey/_locales/",a=(e.browser.language?e.browser.language.replace("-","_"):"en")+"/";let n=r+a+"messages.json",i=0;function l(){t({method:"GET",url:n,onload:c})}function c(t){try{const e=JSON.parse(t.responseText),s={};for(const t in e)"object"==typeof e[t]&&"message"in e[t]&&(s[t]=e[t].message);o(s)}catch(t){if(i++,3==i)return o({});n=e.browser.language.includes("-")&&1==i?n.replace(/([^_]+_[^_]+)_[^/]*(\/.*)/,"$1$2"):r+"en/messages.json",l()}}l()}));Object.assign(s.msgs,o),a.debug(`Success! app.msgs = ${a.prettifyObj(s.msgs)}`)}a.debug("Initializing compatibility flags...");const n={byBrowser:!("Tampermonkey"==e.scriptManager.name&&(e.browser.isChrome||e.browser.isEdge||e.browser.isBrave)),byScriptManager:/Tampermonkey|ScriptCat/.test(e.scriptManager.name)};a.debug(`Success! streamingSupported = ${a.prettifyObj(n)}`),a.debug("Initializing settings..."),Object.assign(r,{controls:{proxyAPIenabled:{type:"toggle",icon:"sunglasses",label:s.msgs.menuLabel_proxyAPImode,helptip:s.msgs.helptip_proxyAPImode},streamingDisabled:{type:"toggle",icon:"signalStream",label:s.msgs.mode_streaming,helptip:s.msgs.helptip_streamingMode},autoGet:{type:"toggle",icon:"speechBalloonLasso",label:s.msgs.menuLabel_autoGetAnswers,helptip:s.msgs.helptip_autoGetAnswers},autoFocusChatbarDisabled:{type:"toggle",mobile:!1,icon:"caretsInward",label:s.msgs.menuLabel_autoFocusChatbar,helptip:s.msgs.helptip_autoFocusChatbar},autoScroll:{type:"toggle",mobile:!1,icon:"arrowsDown",label:`${s.msgs.mode_autoScroll} (${s.msgs.menuLabel_whenStreaming})`,helptip:s.msgs.helptip_autoScroll},rqDisabled:{type:"toggle",icon:"speechBalloons",label:`${s.msgs.menuLabel_show} ${s.msgs.menuLabel_relatedQueries}`,helptip:s.msgs.helptip_showRelatedQueries},prefixEnabled:{type:"toggle",icon:"slash",label:`${s.msgs.menuLabel_require} "/" ${s.msgs.menuLabel_beforeQuery}`,helptip:s.msgs.helptip_prefixMode},suffixEnabled:{type:"toggle",icon:"questionMark",label:`${s.msgs.menuLabel_require} "?" ${s.msgs.menuLabel_afterQuery}`,helptip:s.msgs.helptip_suffixMode},widerSidebar:{type:"toggle",mobile:!1,icon:"widescreen",label:s.msgs.menuLabel_widerSidebar,helptip:s.msgs.helptip_widerSidebar},stickySidebar:{type:"toggle",mobile:!1,icon:"webCorner",label:s.msgs.menuLabel_stickySidebar,helptip:s.msgs.helptip_stickySidebar},anchored:{type:"toggle",mobile:!1,icon:"anchor",label:s.msgs.mode_anchor,helptip:s.msgs.helptip_anchorMode},bgAnimationsDisabled:{type:"toggle",icon:"sparkles",label:`${s.msgs.menuLabel_background} ${s.msgs.menuLabel_animations}`,helptip:s.msgs.helptip_bgAnimations},fgAnimationsDisabled:{type:"toggle",icon:"sparkles",label:`${s.msgs.menuLabel_foreground} ${s.msgs.menuLabel_animations}`,helptip:s.msgs.helptip_fgAnimations},replyLang:{type:"prompt",icon:"languageChars",label:s.msgs.menuLabel_replyLanguage,helptip:s.msgs.helptip_replyLanguage},scheme:{type:"modal",icon:"scheme",label:s.msgs.menuLabel_colorScheme,helptip:s.msgs.helptip_colorScheme},debugMode:{type:"toggle",icon:"bug",label:s.msgs.mode_debug,helptip:s.msgs.helptip_debugMode},about:{type:"modal",icon:"questionMarkCircle",label:`${s.msgs.menuLabel_about} ${s.name}...`}}}),Object.assign(o,{minFontSize:11,maxFontSize:24,lineHeightRatio:e.browser.isMobile?1.357:1.375}),r.load("anchored","autoGet","autoFocusChatbarDisabled","autoScroll","bgAnimationsDisabled","expanded","fgAnimationsDisabled","fontSize","minimized","notFirstRun","prefixEnabled","proxyAPIenabled","replyLanguage","rqDisabled","scheme","stickySidebar","streamingDisabled","suffixEnabled","widerSidebar"),o.replyLanguage||r.save("replyLanguage",e.browser.language),o.fontSize||r.save("fontSize",e.browser.isMobile?14:16.55),n.byBrowser&&n.byScriptManager||r.save("streamingDisabled",!0),!o.notFirstRun&&e.browser.isMobile&&r.save("autoGet",!0),r.save("notFirstRun",!0),a.debug(`Success! config = ${a.prettifyObj(o)}`);const i={AIchatOS:{endpoint:"https://api.binjie.fun/api/generateStream",expectedOrigin:{url:"https://chat18.aichatos68.com",headers:{Accept:"application/json, text/plain, */*",Priority:"u=0","Sec-Fetch-Site":"cross-site"}},method:"POST",streamable:!0,accumulatesText:!1,failFlags:["很抱歉地","系统公告"],userID:"#/chat/"+Date.now()},GPTforLove:{endpoint:"https://api11.gptforlove.com/chat-process",expectedOrigin:{url:"https://ai27.gptforlove.com",headers:{Accept:"application/json, text/plain, */*",Priority:"u=0","Sec-Fetch-Site":"same-site"}},method:"POST",streamable:!0,accumulatesText:!0,failFlags:["['\"]?status['\"]?:\\s*['\"]Fail['\"]"]},"MixerBox AI":{endpoint:"https://chatai.mixerbox.com/api/chat/stream",expectedOrigin:{url:"https://chatai.mixerbox.com",headers:{Accept:"*/*","Alt-Used":"chatai.mixerbox.com","Sec-Fetch-Site":"same-origin"}},method:"POST",streamable:!0,accumulatesText:!1},OpenAI:{endpoints:{auth:"https://auth0.openai.com",completions:"https://api.openai.com/v1/chat/completions",session:"https://chatgpt.com/api/auth/session"},expectedOrigin:{url:"https://chatgpt.com",headers:{Accept:"*/*",Priority:"u=4","Sec-Fetch-Site":"same-site"}},method:"POST",streamable:!0}},l={};["down","move","up"].forEach((t=>l[t]=(window.PointerEvent?"pointer":e.browser.isMobile?"touch":"mouse")+t)),Object.assign(s,{alerts:{waitingResponse:`${s.msgs.alert_waitingFor} ${s.name} ${s.msgs.alert_response}...`,login:`${s.msgs.alert_login} @ `,checkCloudflare:`${s.msgs.alert_checkCloudflare} @ `,tooManyRequests:`${s.msgs.alert_tooManyRequests}.`,parseFailed:`${s.msgs.alert_parseFailed}.`,proxyNotWorking:`${s.msgs.mode_proxy} ${s.msgs.alert_notWorking}.`,openAInotWorking:`OpenAI API ${s.msgs.alert_notWorking}.`,suggestProxy:`${s.msgs.alert_try} ${s.msgs.alert_switchingOn} ${s.msgs.mode_proxy}`,suggestOpenAI:`${s.msgs.alert_try} ${s.msgs.alert_switchingOff} ${s.msgs.mode_proxy}`}});const c={ids:[],state:{symbols:["❌","✔️"],separator:"Tampermonkey"==e.scriptManager.name?" — ":": ",words:[s.msgs.state_off.toUpperCase(),s.msgs.state_on.toUpperCase()]},register(){const t="Tampermonkey"==e.scriptManager.name&&parseInt(e.scriptManager.version.split(".")[0])>=5,a=c.state.symbols[+o.proxyAPIenabled]+" "+r.controls.proxyAPIenabled.label+" "+c.state.separator+c.state.words[+o.proxyAPIenabled];c.ids.push(GM_registerMenuCommand(a,k.proxyMode,t?{title:r.controls.proxyAPIenabled.helptip}:void 0));const n=`💡 ${r.controls.about.label}`;c.ids.push(GM_registerMenuCommand(n,(()=>m.open("about")),t?{title:" "}:void 0));const i=`⚙️ ${s.msgs.menuLabel_settings}`;c.ids.push(GM_registerMenuCommand(i,(()=>m.open("settings")),t?{title:" "}:void 0))},refresh(){if("undefined"!=typeof GM_unregisterMenuCommand){for(const e of c.ids)GM_unregisterMenuCommand(e);c.register()}else a.debug("GM_unregisterMenuCommand not supported.")}};const p={anchor(e,t,s={}){const o=document.createElement("a"),r={...{href:e,target:"_blank",rel:"noopener"},...s};return Object.entries(r).forEach((([e,t])=>o.setAttribute(e,t))),t&&o.append(t),o},style(e){const t=document.createElement("style");return e&&(t.innerText=e),t},svgElem(e,t){const s=document.createElementNS("http://www.w3.org/2000/svg",e);for(const e in t)s.setAttributeNS(null,e,t[e]);return s}};function d(...e){e=e.flat(),E.textContent="";const t=document.createElement("p");t.id=`${s.cssPrefix}-alert`,t.className="no-user-select",e.includes("waitingResponse")||(t.style.marginBottom="16px"),e.forEach(((e,o)=>{let r=s.alerts[e]||e;o>0&&(r=" "+r),r.includes(s.alerts.login)&&$.deleteOpenAIcookies(),r.includes(s.alerts.waitingResponse)&&t.classList.add("loading"),r.includes("@")&&(r+=`<a class="alert-link" target="_blank" rel="noopener" href="https://chatgpt.com">chatgpt.com</a>, ${s.msgs.alert_thenRefreshPage}. (${s.msgs.alert_ifIssuePersists}, ${s.msgs.alert_try.toLowerCase()} ${s.msgs.alert_switchingOn} ${s.msgs.mode_proxy})`);const a=["On","Off"].find((e=>r.includes(s.msgs["alert_switching"+e])||new RegExp(`\\b${e}\\b`,"i").test(r)));if(a){const e=s.msgs["alert_switching"+a]||"switching "+a.toLowerCase();r=r.replace(e,`<a class="alert-link" href="#">${e}</a>`)}const n=document.createElement("span");n.innerHTML=r,t.append(n),n.querySelector('[href="#"]')?.addEventListener("click",k.proxyMode)})),E.append(t)}function g(e,t="",s="",o="shadow"){const a=c.state.words.find((t=>e.includes(t)));a&&(e=e.replace(a,"")),chatgpt.notify(e,t,s,o);const n=document.querySelector(".chatgpt-notif:last-child"),i=h.googleGPT.create("white");i.style.cssText="width: 26px ; position: relative ; top: 2.8px ; margin-right: 6px",n.prepend(i);const l=Object.keys(r.controls).find((t=>r.controls[t].label.includes(e.trim())));if(l&&!/(?:pre|suf)fix/.test(l)){const e=h[r.controls[l].icon].create();e.style.cssText="width: 28px ; height: 28px ; position: relative ; top: 3px ; margin-left: 11px ;"+(/autoget|debug|focus|scroll/i.test(l)?"top: 0.5px":"")+(/animation|debug/i.test(l)?"width: 23px ; height: 23px":""),n.append(e)}if(a){const e=document.createElement("span");e.style.cssText="color: "+(a==c.state.words[0]?"#ef4848 ; text-shadow: rgba(255, 169, 225, 0.44) 2px 1px 5px":"#5cef48 ; text-shadow: rgba(255, 250, 169, 0.38) 2px 1px 5px"),e.append(a),n.insertBefore(e,n.children[2])}}const m={stack:[],class:`${s.cssPrefix}-modal`,alert(e="",t="",s="",o="",r=""){const a=chatgpt.alert(e,t,s,o,r),n=document.getElementById(a).firstChild;return this.init(n),n},open(e,t){const s=t?m[e][t]():(m[e].show||m[e])();"prompt"!=r.controls[e]?.type&&(this.stack.unshift(t?`${e}_${t}`:e),a.debug(`Modal stack: ${JSON.stringify(m.stack)}`)),this.init(s),this.observeRemoval(s,e,t),m.handlers.key.added||(document.addEventListener("keydown",m.handlers.key),m.handlers.key.added=!0)},init(t){if(this.styles||this.stylize(),t.classList.add(this.class),t.parentNode.classList.add(`${this.class}-bg`),t.onwheel=t.ontouchmove=e=>e.preventDefault(),t.onmousedown=m.handlers.drag.mousedown,!t.parentNode.className.includes("chatgpt-modal")){[t.parentNode,t.querySelector('[class*="-close-btn"]')].forEach((e=>e.onclick=m.handlers.click))}y(t),setTimeout((()=>{t.parentNode.style.backgroundColor=`rgba(67, 70, 72, ${"dark"==e.ui.app.scheme?.62:.33})`,t.parentNode.classList.add("animated")}),100),"dark"!=e.ui.app.scheme||o.fgAnimationsDisabled||k.btnGlow()},stylize(){this.styles||(this.styles=document.createElement("style"),this.styles.id=`${this.class}-styles`,document.head.append(this.styles)),this.styles.innerText=`@keyframes modal-zoom-fade-out {0% { opacity: 1 } 50% { opacity: 0.25 ; transform: scale(1.05) }100% { opacity: 0 ; transform: scale(1.35) }}.chatgpt-modal > div {padding: 17px 20px 24px 20px !important ;background-color: white ; color: #202124 }.chatgpt-modal p { margin: 14px 0 -29px 4px ; font-size: 1.28em ; line-height: 1.57 }.modal-buttons {margin: 42px 4px ${e.browser.isMobile?"2px 4px":"-3px -4px"} !important ; width: 100% }.chatgpt-modal button {font-size: 0.84rem ; text-transform: uppercase ; min-width: 113px ;padding: ${e.browser.isMobile?"5px":"4px 10px"} !important ;cursor: pointer ; border-radius: 0 !important ; height: 39px ;border: 1px solid `+("dark"==e.ui.app.scheme?"white":"black")+" !important }.primary-modal-btn { background: black !important ; color: white !important }.chatgpt-modal button:hover { background-color: #9cdaff !important ; color: black !important }"+("dark"==e.ui.app.scheme?".chatgpt-modal > div, .chatgpt-modal button:not(.primary-modal-btn) {background-color: black !important ; color: white }.primary-modal-btn { background: hsl(186 100% 69%) !important ; color: black !important }.chatgpt-modal a { color: #00cfff !important }.chatgpt-modal button:hover {background-color: #00cfff !important ; color: black !important }":"")+`.${m.class} { display: grid ; place-items: center }[class*="modal-close-btn"] {position: absolute !important ; float: right ; top: 14px !important ; right: 16px !important ;cursor: pointer ; width: 33px ; height: 33px ; border-radius: 20px }`+`[class*="modal-close-btn"] path {${"dark"==e.ui.app.scheme?"stroke: white ; fill: white":"stroke: #9f9f9f ; fill: #9f9f9f"}}`+("dark"==e.ui.app.scheme?'[class*="modal-close-btn"]:hover path { stroke: black ; fill: black }':"")+'[class*="modal-close-btn"]:hover { background-color: #f2f2f2 }[class*="modal-close-btn"] svg { margin: 11.5px }[class*="-modal"] h2 {font-size: 1.65rem ; line-height: 32px ; padding: 0 ; margin: 9px 0 -3px !important ;'+(e.browser.isMobile?"text-align: center":"justify-self: start")+'}[class*="-modal"] p { justify-self: start ; font-size: 20px }[class*="-modal"] button { font-size: 12px }[class*="-modal-bg"] {pointer-events: auto ;position: fixed ; top: 0 ; left: 0 ; width: 100% ; height: 100% ;transition: background-color .25s ease !important ;display: flex ; justify-content: center ; align-items: center ; z-index: 9999 }[class*="-modal-bg"].animated > div {z-index: 13456 ; opacity: 0.98 ; transform: translateX(0) translateY(0) }[class$="-modal"] {position: absolute ;opacity: 0 ;'+`background-image: linear-gradient(180deg, ${"dark"==e.ui.app.scheme?"#99a8a6 -200px, black 200px":"#b6ebff -296px, white 171px"}) ;`+`border: 1px solid ${"dark"==e.ui.app.scheme?"white":"#b5b5b5"} !important ;`+`color: ${"dark"==e.ui.app.scheme?"white":"black"} ;transform: translateX(-3px) translateY(7px) ;transition: opacity 0.65s cubic-bezier(.165,.84,.44,1),transform 0.55s cubic-bezier(.165,.84,.44,1) !important }`+(o.fgAnimationsDisabled||e.browser.isMobile?"":'[class$="-modal"] button { transition: transform 0.15s ease }[class$="-modal"] button:hover { transform: scale(1.055) }')+":root { --glow-color: hsl(186 100% 69%); }.glowing-btn {perspective: 2em ; font-weight: 900 ; animation: border-flicker 2s linear infinite ;-webkit-box-shadow: inset 0 0 0.5em 0 var(--glow-color), 0 0 0.5em 0 var(--glow-color) ;box-shadow: inset 0 0 0.5em 0 var(--glow-color), 0 0 0.5em 0 var(--glow-color) ;-moz-box-shadow: inset 0 0 0.5em 0 var(--glow-color), 0 0 0.5em 0 var(--glow-color) }.glowing-txt {animation: text-flicker 3s linear infinite ;-webkit-text-shadow: 0 0 0.125em hsl(0 0% 100% / 0.3), 0 0 0.45em var(--glow-color) ;-moz-text-shadow: 0 0 0.125em hsl(0 0% 100% / 0.3), 0 0 0.45em var(--glow-color) ;text-shadow: 0 0 0.125em hsl(0 0% 100% / 0.3), 0 0 0.45em var(--glow-color) }.faulty-letter {opacity: 0.5 ; animation: faulty-flicker 2s linear infinite }"+(e.browser.isMobile?"":"background: var(--glow-color) ;transform: translateY(120%) rotateX(95deg) scale(1, 0.35)")+'}.glowing-btn::after {content: "" ; position: absolute ; top: 0 ; bottom: 0 ; left: 0 ; right: 0 ;opacity: 0 ; z-index: -1 ; box-shadow: 0 0 2em 0.2em var(--glow-color) ;background-color: var(--glow-color) ; transition: opacity 100ms linear }.glowing-btn:hover { color: rgba(0, 0, 0, 0.8) ; text-shadow: none ; animation: none }.glowing-btn:hover .glowing-txt { animation: none }.glowing-btn:hover .faulty-letter { animation: none ; text-shadow: none ; opacity: 1 }.glowing-btn:hover:before { filter: blur(1.5em) ; opacity: 1 }.glowing-btn:hover:after { opacity: 1 }@keyframes faulty-flicker {0% { opacity: 0.1 } 2% { opacity: 0.1 } 4% { opacity: 0.5 } 19% { opacity: 0.5 }21% { opacity: 0.1 } 23% { opacity: 1 } 80% { opacity: 0.5 } 83% { opacity: 0.4 }87% { opacity: 1 }}@keyframes text-flicker {0% { opacity: 0.1 } 2% { opacity: 1 } 8% { opacity: 0.1 } 9% { opacity: 1 }12% { opacity: 0.1 } 20% { opacity: 1 } 25% { opacity: 0.3 } 30% { opacity: 1 }70% { opacity: 0.7 } 72% { opacity: 0.2 } 77% { opacity: 0.9 } 100% { opacity: 0.9 }}@keyframes border-flicker {0% { opacity: 0.1 } 2% { opacity: 1 } 4% { opacity: 0.1 } 8% { opacity: 1 }70% { opacity: 0.7 } 100% { opacity: 1 }}'+`#${s.cssPrefix}-settings {`+`min-width: ${e.browser.isPortrait?288:698}px ;max-width: 75vw ; word-wrap: break-word ;margin: 12px 23px ; border-radius: 15px ; box-shadow: 0 30px 60px rgba(0, 0, 0, .12) ;`+("dark"==e.ui.app.scheme?"stroke: white ; fill: white":"stroke: black ; fill: black")+"}"+`#${s.cssPrefix}-settings-title {font-weight: bold ; line-height: 19px ; text-align: center ;`+`margin: 0 -6px ${e.browser.isPortrait?2:-15}px 0 }`+`#${s.cssPrefix}-settings-title h4 {`+`font-size: ${e.browser.isPortrait?22:29}px ; font-weight: bold ;`+`margin: 0 0 ${e.browser.isPortrait?9:27}px }`+`#${s.cssPrefix}-settings ul {list-style: none ; padding: 0 ; margin-bottom: 2px ;`+`width: ${e.browser.isPortrait?100:50}% }`+`#${s.cssPrefix}-settings li {`+`color: ${"dark"==e.ui.app.scheme?"rgb(255, 255, 255, 0.65)":"rgba(0, 0, 0, 0.45)"} ;`+`fill: ${"dark"==e.ui.app.scheme?"rgb(255, 255, 255, 0.65)":"rgba(0, 0, 0, 0.45)"} ;`+`stroke: ${"dark"==e.ui.app.scheme?"rgb(255, 255, 255, 0.65)":"rgba(0, 0, 0, 0.45)"} ;height: 24px ; font-size: 13.5px ; transition: transform 0.1s ease ;`+`padding: 6px 10px ; border-bottom: 1px dotted ${"dark"==e.ui.app.scheme?"white":"black"} ;border-radius: 3px }`+`#${s.cssPrefix}-settings li.active {`+`color: ${"dark"==e.ui.app.scheme?"rgb(255, 255, 255)":"rgba(0, 0, 0)"} ;`+`fill: ${"dark"==e.ui.app.scheme?"rgb(255, 255, 255)":"rgba(0, 0, 0)"} ;`+`stroke: ${"dark"==e.ui.app.scheme?"rgb(255, 255, 255)":"rgba(0, 0, 0)"}}`+`#${s.cssPrefix}-settings li label { padding-right: 20px }`+`#${s.cssPrefix}-settings li:last-of-type { border-bottom: none }`+`#${s.cssPrefix}-settings li, #${s.cssPrefix}-settings li label { cursor: pointer }`+`#${s.cssPrefix}-settings li:hover {opacity: 1 ;background: rgba(100, 149, 237, 0.88) ; color: white ; fill: white ; stroke: white ;`+(o.fgAnimationsDisabled||e.browser.isMobile?"":"transform: scale(1.22)")+"}"+`#${s.cssPrefix}-settings li > input { float: right }#scheme-settings-entry > span { margin: 0 -2px !important }#scheme-settings-entry > span > svg {position: relative ; top: 3px ; margin-left: 4px }`+(o.fgAnimationsDisabled?"":'#scheme-settings-entry svg:has([d^="M204-318q-22"]),.chatgpt-notif svg:has([d^="M204-318q-22"]) { animation: rotation 5s linear infinite }')+"@keyframes rotation { from { transform: rotate(0deg) } to { transform: rotate(360deg) }}"+`#about-settings-entry span { color: ${"dark"==e.ui.app.scheme?"#28ee28":"green"}}#about-settings-entry > span {`+`width: ${e.browser.isPortrait?"15vw":"95px"} ; height: 20px ; overflow: hidden ;`+(e.browser.isPortrait?"position: relative ; bottom: 3px ;":"")+(o.fgAnimationsDisabled?"":"mask-image: linear-gradient(to right, transparent, black 20%, black 89%, transparent) ;-webkit-mask-image: linear-gradient(to right, transparent, black 20%, black 89%, transparent)")+"}#about-settings-entry > span > div {"+`text-wrap: nowrap ; ${o.fgAnimationsDisabled?"":"animation: ticker linear 60s infinite"}}@keyframes ticker { 0% { transform: translateX(100%) } 100% { transform: translateX(-2000%) }}`+`.about-em { color: ${"dark"==e.ui.app.scheme?"white":"green"} !important }`},observeRemoval(e,t,s){const o=e.parentNode;new MutationObserver((([e],r)=>{e.removedNodes.forEach((e=>{if(e==o){if(m.stack[0].includes(s||t)){m.stack.shift();const e=m.stack[0];e&&(m.stack.shift(),m.open(e))}r.disconnect()}}))})).observe(o.parentNode,{childList:!0,subtree:!0})},hide(e){a.caller="modals.hide()",a.debug(`Dismissing div#${e?.id}...`);const t=e?.parentNode;t&&(t.style.animation="modal-zoom-fade-out .135s ease-out",setTimeout((()=>{t.remove(),a.debug(`Success! div#${e?.id} dismissed`)}),105))},handlers:{click(e){a.caller="modals.handlers.click()";const t=e.target;if(t==e.currentTarget||t.closest('[class*="-close-btn]')){const e=(t.closest('[class*="-modal-bg"]')||t).firstChild;a.debug(`Dismiss element of div#${e?.id} clicked`),m.hide(e)}},drag:{mousedown(e){if(0!=e.button)return;if("pointer"==getComputedStyle(e.target).cursor)return;m.handlers.drag.draggableElem=e.currentTarget,m.handlers.drag.draggableElem.style.cursor="grabbing",e.preventDefault(),["mousemove","mouseup"].forEach((e=>document.addEventListener(e,m.handlers.drag[e])));const t=m.handlers.drag.draggableElem.getBoundingClientRect();m.handlers.drag.offsetX=e.clientX-t.left+21,m.handlers.drag.offsetY=e.clientY-t.top+12},mousemove(e){if(m.handlers.drag.draggableElem){const t=e.clientX-m.handlers.drag.offsetX,s=e.clientY-m.handlers.drag.offsetY;Object.assign(m.handlers.drag.draggableElem.style,{left:`${t}px`,top:`${s}px`})}},mouseup(){m.handlers.drag.draggableElem.style.cursor="inherit",["mousemove","mouseup"].forEach((e=>document.removeEventListener(e,m.handlers.drag[e]))),m.handlers.drag.draggableElem=null}},key(e){if(a.caller="modals.handlers.key()",e.key.startsWith("Esc")||27==e.keyCode){a.debug("Escape pressed");const e=document.querySelector('[class$="-modal"]');e&&m.hide(e)}}},about(){a.caller="modals.about()",a.debug("Showing About modal...");const o=m.alert("",`🏷️ ${s.msgs.about_version}: <span class="about-em">${s.version}</span>\n⚡ `+s.msgs.about_poweredBy+": "+`<a href="${s.urls.chatgptJS}" target="_blank" rel="noopener">chatgpt.js</a>`+` v${s.chatgptJSver}\n📜 `+s.msgs.about_sourceCode+`: <a href="${s.urls.gitHub}" target="_blank" rel="nopener">`+s.urls.gitHub+"</a>",[function(){a.caller="updateCheck()",a.debug(`currentVer = ${s.version}`),a.debug("Fetching latest userscript metadata..."),t({method:"GET",url:s.urls.update+"?t="+Date.now(),headers:{"Cache-Control":"no-cache"},onload:e=>{a.debug("Success! Response received"),a.debug("Comparing versions..."),s.latestVer=/@version +(.*)/.exec(e.responseText)[1];for(let e=0;e<4;e++){const t=parseInt(s.version.split(".")[e],10)||0,o=parseInt(s.latestVer.split(".")[e],10)||0;if(t>o)break;if(o>t)return m.open("update","available")}m.open("update","unavailable")}})},function(){},function(){},function(){}],"",585),r=b.googleGPT.create();return r.width=405,r.style.cssText=`max-width: 98% ; margin: 15px ${e.browser.isMobile?"auto":"14.5%"} -1px`,o.insertBefore(r,o.firstChild.nextSibling),o.querySelector("h2").remove(),o.querySelector("p").style.cssText="justify-self: center ; text-align: center ; overflow-wrap: anywhere ;margin: "+(e.browser.isPortrait?"21px 0 -20px":"15px 0 -19px"),o.querySelectorAll("button").forEach((e=>{if(e.style.cssText="height: 50px ; min-width: 136px",/support|rate|extensions/i.test(e.textContent)){const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),(e=t).onclick=()=>m.safeWinOpen(e.textContent.includes(s.msgs.btnLabel_getSupport)?s.urls.support:e.textContent.includes(s.msgs.btnLabel_rateUs)?s.urls.review.greasyFork:s.urls.relatedExtensions)}/updates/i.test(e.textContent)?e.textContent=`🚀 ${s.msgs.btnLabel_checkForUpdates}`:/support/i.test(e.textContent)?e.textContent=`🧠 ${s.msgs.btnLabel_getSupport}`:/rate/i.test(e.textContent)?e.textContent=`⭐ ${s.msgs.btnLabel_rateUs}`:/extensions/i.test(e.textContent)?e.textContent=`🤖 ${s.msgs.btnLabel_moreAIextensions}`:e.style.display="none"})),a.debug("Success! About Modal shown"),o},feedback(){a.caller="modals.feedback()",a.debug("Showing Feedback modal...");let e=[function(){}];"about"!=m.stack[1]&&e.push((function(){}));const t=m.alert(`${s.msgs.alert_choosePlatform}:`,"",e,"",333);t.querySelector("h2").style.justifySelf="center";const o=t.querySelector(".modal-buttons");return o.style.cssText+="display: flex ; flex-wrap: wrap ; justify-content: center ;margin: 16px 0 5px !important",e=o.querySelectorAll("button"),e.forEach(((t,o)=>{0==o&&(t.style.display="none"),o==e.length-1&&t.classList.remove("primary-modal-btn"),t.style.marginTop=t.style.marginBottom="5px";const r=t.cloneNode(!0);t.parentNode.replaceChild(r,t),(t=r).onclick=()=>m.safeWinOpen("Greasy Fork"==t.textContent?s.urls.review.greasyFork:`${s.urls.gitHub}/discussions/new/choose`)})),a.debug("Success! Feedback modal shown"),t},replyLang(){for(a.caller="modals.replyLang()";;){let t=prompt(s.msgs.prompt_updateReplyLang+":",o.replyLanguage);if(null==t)break;if(!/\d/.test(t)){t=t.length<4||t.includes("-")?t.toUpperCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),a.debug("Saving reply language..."),r.save("replyLanguage",t||e.browser.language),a.debug(`Success! config.replyLanguage = ${o.replyLanguage}`),m.alert(`${s.msgs.alert_langUpdated}!`,`${s.name} ${s.msgs.alert_willReplyIn} `+(t||s.msgs.alert_yourSysLang)+".","","",330),m.settings.get()&&(document.querySelector("#replyLang-settings-entry span").textContent=t);break}}},scheme(){a.caller="modals.scheme()",a.debug("Showing Scheme modal...");const e=m.alert(`${s.name} ${s.msgs.menuLabel_colorScheme.toLowerCase()}:`,"",[function(){},function(){},function(){}]);e.querySelector("h2").style.justifySelf="center",e.querySelector(".modal-buttons").style.cssText="justify-content: center ; margin: 20px 0 9px !important";const t=e.querySelectorAll("button"),n={light:"☀️",dark:"🌘",auto:"🌗"};for(const a of t){const t=a.textContent.toLowerCase();a.classList=o.scheme==a.textContent.toLowerCase()||"Auto"==a.textContent&&!o.scheme?"primary-modal-btn":"",Object.prototype.hasOwnProperty.call(n,t)?a.textContent=`${n[t]} ${s.msgs["scheme_"+t]||s.msgs["menuLabel_"+t]||t.toUpperCase()}`:a.style.display="none";const l=a.cloneNode(!0);a.parentNode.replaceChild(l,a),l.onclick=()=>{const s="auto"==t?x()?"dark":"light":t;r.save("scheme","auto"!=t&&s),e.querySelectorAll("button").forEach((e=>e.classList="")),l.classList="primary-modal-btn",l.style.cssText="pointer-events: none",setTimeout((()=>{l.style.pointerEvents="auto"}),100),f.scheme(s),i(t)}}function i(e){g(`${s.msgs.menuLabel_colorScheme}: `+("light"==e?s.msgs.scheme_light||"Light":"dark"==e?s.msgs.scheme_dark||"Dark":s.msgs.menuLabel_auto).toUpperCase());const t=document.querySelectorAll(".chatgpt-notif"),o=t[t.length-1],r=h["light"==e?"sun":"dark"==e?"moon":"arrowsCycle"].create();r.style.cssText="width: 23px ; height: 23px ; position: relative ;top: 1px ; margin-left: 6px",o.append(r)}return a.debug("Success! Scheme modal shown"),e},settings:{createAppend(){a.caller="modals.settings.createAppend()";const t=document.createElement("div"),i=document.createElement("div");i.id=`${s.cssPrefix}-settings`,t.append(i),a.debug("Initializing settings keys...");const l=Object.keys(r.controls).filter((t=>!(e.browser.isMobile&&0==r.controls[t].mobile)));a.debug(`Success! settingsKeys = ${a.prettifyObj(l)}`);const p=h.googleGPT.create();p.style.cssText+=`width: ${e.browser.isPortrait?64:65}px ;margin: 13px 0 ${e.browser.isPortrait?"-35":"-27"}px ;position: relative ; top: -42px ; `+(e.browser.isPortrait?"left: 6px":"");const d=document.createElement("div");d.id=`${s.cssPrefix}-settings-title`;const u=document.createElement("h4");u.textContent=s.msgs.menuLabel_settings;const b=h.cogwheel.create();b.style.cssText="width: 20px ; height: 20px ;position: relative ; top: 1px ; right: 7px",u.prepend(b),d.append(u),a.debug("Initializing settings lists...");const f=[],x=document.createElement("div"),y=e.browser.isMobile&&(e.browser.isPortrait||l.length<8)?1:2,w=Math.floor(l.length/2);for(let e=0;e<y;e++)f.push(document.createElement("ul"));x.style.width="95%",y>1&&(x.style.cssText+="display: flex ; padding: 11px 0 13px ; gap: 15px",f[0].style.cssText="padding-right: 15px ; border-right: 1px dotted "+("dark"==e.ui.app.scheme?"white":"black ")),a.debug(`Success! settingsListCnt = ${y}`),l.forEach(((t,i)=>{const l=r.controls[t],p=document.createElement("li");p.id=t+"-settings-entry",p.title=l.helptip||"";const d=document.createElement("label");d.textContent=l.label,p.append(d),f[e.browser.isPortrait?0:+(i>=w)].append(p);const u=h[l.icon].create(/bg|fg/.exec(t)?.[0]??"");if(u.style.cssText="position: relative ;"+(/proxy/i.test(t)?"top: 3px ; left: -0.5px ; margin-right: 9px":/streaming/i.test(t)?"top: 3px ; left: 0.5px ; margin-right: 9px":/auto(?:get|focus)/i.test(t)?"top: 4.5px ; margin-right: 7px":/autoscroll/i.test(t)?"top: 3.5px ; left: -1.5px ; margin-right: 6px":/^rq/.test(t)?"top: 2.5px ; left: 0.5px ; margin-right: 9px ; transform: scaleY(-1)":/prefix/i.test(t)?"top: 2.5px ; left: 0.5px ; margin-right: 9px":/suffix/i.test(t)?"top: 4px ; left: -1.5px ; margin-right: 7px":/sidebar/i.test(t)?"top: 4px ; left: -1.5px ; margin-right: 7.5px":/anchor/i.test(t)?"top: 3px ; left: -2.5px ; margin-right: 5.5px":/animation/i.test(t)?"top: 3px ; left: -1.5px ; margin-right: 6.5px":/replylang/i.test(t)?"top: 3px ; left: -1.5px ; margin-right: 9px":/scheme/i.test(t)?"top: 2.5px ; left: -1.5px ; margin-right: 8px":/debug/i.test(t)?"top: 3.5px ; left: -1.5px ; margin-right: 8px":/about/i.test(t)?"top: 3px ; left: -3px ; margin-right: 5.5px":""),p.prepend(u),"toggle"==l.type){const e=document.createElement("input");[["type","checkbox"],["disabled",!0]].forEach((([t,s])=>e.setAttribute(t,s))),e.checked=o[t]^t.includes("Disabled")&&!("streamingDisabled"==t&&!o.proxyAPIenabled),e.style.display="none";const s=document.createElement("span");Object.assign(s.style,{position:"relative",left:"-1px",bottom:"-5.5px",float:"right",backgroundColor:e.checked?"#ccc":"#AD68FF",width:"26px",height:"13px","-webkit-transition":".4s",transition:"0.4s",borderRadius:"28px"});const l=document.createElement("span");Object.assign(l.style,{position:"absolute",left:"1px",bottom:"1px",width:"11px",height:"11px",content:'""',borderRadius:"28px",transform:e.checked?"translateX(0)":"translateX(14px) translateY(0)",backgroundColor:"white","-webkit-transition":"0.2s",transition:"0.2s"}),s.append(l),p.append(e,s),setTimeout((()=>m.settings.toggle.updateStyles(e)),25*i-25),p.onclick=()=>{("streamingDisabled"!=t||n.byBrowser&&n.byScriptManager&&o.proxyAPIenabled)&&m.settings.toggle.switch(e);const s=/(?:suf|pre)fix/.exec(t);t.includes("proxy")?k.proxyMode():t.includes("streaming")?k.streaming():/autoget/i.test(t)?k.autoGet():t.includes("rq")?k.relatedQueries():s?k.manualGet(s[0]):t.includes("Sidebar")?k.sidebar(/(.*?)Sidebar$/.exec(t)[1]):t.includes("anchor")?k.anchorMode():t.includes("bgAnimation")?k.animations("bg"):t.includes("fgAnimation")?k.animations("fg"):(a.caller="settings.createAppend()",a.debug(`Toggling ${p.textContent} ${t.includes("Disabled")^o[t]?"OFF":"ON"}...`),r.save(t,!o[t]),g(`${r.controls[t].label} ${c.state.words[+(t.includes("Disabled")^o[t])]}`),a[t.includes("debug")?"info":"debug"](`Success! config.${t} = ${o[t]}`))}}else{p.classList.add("active");const e=document.createElement("span");if(e.style.cssText="float: right ; font-size: 11px ; margin-top: "+(t.includes("about")?"5px":"3px ; text-transform: uppercase !important"),t.includes("replyLang"))e.textContent=o.replyLanguage,p.onclick=()=>m.open("replyLang");else if(t.includes("scheme"))m.settings.updateSchemeStatus(e),p.onclick=()=>m.open("scheme");else if(t.includes("about")){const t=document.createElement("div"),r="&emsp;&emsp;&emsp;&emsp;&emsp;";m.settings.aboutContent={},m.settings.aboutContent.short=`v${GM_info.script.version}`,m.settings.aboutContent.long=`${s.msgs.about_version}: <span class="about-em">v${GM_info.script.version+r}</span>${s.msgs.about_poweredBy} <span class="about-em">chatgpt.js</span>${r}`;for(let e=0;e<7;e++)m.settings.aboutContent.long+=m.settings.aboutContent.long;t.innerHTML=m.settings.aboutContent[o.fgAnimationsDisabled?"short":"long"],t.style.float=o.fgAnimationsDisabled?"right":"",e.append(t),p.onclick=()=>m.open("about")}p.append(e)}})),x.append(...f);const v=document.createElement("div");v.classList.add(`${s.cssPrefix}-modal-close-btn`,"no-mobile-tap-outline"),v.title=s.msgs.tooltip_close;const $=h.x.create();return v.append($),i.append(p,d,v,x),document.body.append(t),t},get:()=>document.getElementById(`${s.cssPrefix}-settings`),show(){a.caller="modals.settings.show()",a.debug("Showing Settings modal...");const t=m.settings.get()?.parentNode||m.settings.createAppend();if(t.style.display="",a.caller="modals.settings.show()",e.browser.isMobile){a.debug("Scaling 93% to viewport sides...");const e=t.querySelector(`#${s.cssPrefix}-settings`),o=.93*window.innerWidth/e.offsetWidth;e.style.transform=`scale(${o})`}return a.debug("Success! Settings modal shown"),t.firstChild},toggle:{switch(e){e.checked=!e.checked,m.settings.toggle.updateStyles(e)},updateStyles(e){const t=e.parentNode,s=t.querySelector("span"),o=s.querySelector("span");setTimeout((()=>{s.style.backgroundColor=e.checked?"#ad68ff":"#ccc",s.style.boxShadow=e.checked?"2px 1px 9px #d8a9ff":"none",o.style.transform=e.checked?"translateX(14px) translateY(0)":"translateX(0)",t.classList[e.checked?"add":"remove"]("active")}),1)}},updateSchemeStatus(e=null){(e=e||document.querySelector("#scheme-settings-entry span"))&&(e.textContent="",e.append(..."dark"==o.scheme?[document.createTextNode(s.msgs.scheme_dark),h.moon.create()]:"light"==o.scheme?[document.createTextNode(s.msgs.scheme_light),h.sun.create()]:[document.createTextNode(s.msgs.menuLabel_auto),h.arrowsCycle.create()]),e.style.cssText+=`; margin-top: ${o.scheme?-3:0}px !important`)}},update:{width:377,available(){const t=m.alert(`🚀 ${s.msgs.alert_updateAvail}!`,`${s.msgs.alert_newerVer} ${s.name} (v${s.latestVer}) ${s.msgs.alert_isAvail}!  <a target="_blank" rel="noopener" style="font-size: 0.97rem" href="`+s.urls.update.replace(/.+\/([^/]+)meta\.js/,`${s.urls.gitHub}/commits/main/greasemonkey/$1user.js`)+`">${s.msgs.link_viewChanges}</a>`,(function(){GM_openInTab(s.urls.update.replace("meta.js","user.js")+"?t="+Date.now(),{active:!0,insert:!0}).onclose=()=>location.reload()}),"",m.update.width);if(!e.browser.language.startsWith("en")){const e=t.querySelectorAll("button");e[1].textContent=s.msgs.btnLabel_update,e[0].textContent=s.msgs.btnLabel_dismiss}return t},unavailable:()=>m.alert(`${s.msgs.alert_upToDate}!`,`${s.name} (v${s.version}) ${s.msgs.alert_isUpToDate}!`,"","",m.update.width)},safeWinOpen(e){open(e,"_blank","noopener")}},u={fadeInDelay:5,show(e){e.style.display="",setTimeout((()=>e.classList.add("active")),u.fadeInDelay)},pin:{clickHandler(e){const t=e.target.closest(`#${s.cssPrefix}-pin-menu`),o=e.target.textContent,r=E.offsetTop;o==s.msgs.menuLabel_top?k.sidebar("sticky"):o==s.msgs.menuLabel_sidebar?(k.sidebar("sticky","off"),k.anchorMode("off")):o==s.msgs.menuLabel_bottom&&k.anchorMode(),E.offsetTop!=r?t.remove():u.pin.update(t)},createAppend(){const e=document.createElement("div");return e.id=`${s.cssPrefix}-pin-menu`,e.classList.add(`${s.cssPrefix}-menu`,`${s.cssPrefix}-btn-tooltip`,"fade-in-less","no-user-select"),u.pin.update(e),E.append(e),e},update(e){e.textContent="";const t=document.querySelector(`#${s.cssPrefix}-pin-menu ul`)||document.createElement("ul"),r=[],a=[`${s.msgs.menuLabel_pinTo}...`,s.msgs.menuLabel_top,s.msgs.menuLabel_sidebar,s.msgs.menuLabel_bottom],n=[h.webCorner.create(),h.sidebar.create(),h.anchor.create(),h.checkmark.create()];n.forEach((e=>e.style.cssText="width: 12px ; height: 12px ; position: relative ; top: 1px ; right: 5px ; margin-left: 5px")),n[0].style.width=n[0].style.height="11px",n[3].style.cssText="position: relative ; float: right ; margin-right: -16px ; top: 4px";for(let e=0;e<4;e++)r.push(document.createElement("li")),r[e].textContent=a[e],r[e].className=`${s.cssPrefix}-menu-item`,0==e?(r[e].innerHTML=`<b>${a[e]}</b>`,r[e].classList.add(`${s.cssPrefix}-menu-header`),r[e].style.cssText="margin-bottom: 1px ; border-bottom: 1px dotted white"):1==e&&(r[e].style.marginTop="3px"),r[e].style.paddingRight="24px",r[e].prepend(e>0?n[e-1]:""),(1==e&&o.stickySidebar||2==e&&!o.stickySidebar&&!o.anchored||3==e&&o.anchored)&&r[e].append(n[n.length-1]),r[e].onclick=u.pin.clickHandler,t.append(r[e]);e.append(t),e.onmouseover=e.onmouseout=u.pin.toggle},toggle(e){const t=document.getElementById(`${s.cssPrefix}-pin-menu`)||u.pin.createAppend();u.pin.topPos||(u.pin.topPos=(e.clientY||e.touches?.[0]?.clientY)<195?51:-81),u.pin.rightPos||(u.pin.rightPos=E.getBoundingClientRect().right-e.clientX-t.offsetWidth/2),t.style.top=`${u.pin.topPos}px`,t.style.right=`${u.pin.rightPos}px`,clearTimeout(u.pin.hideTimeout),"mouseover"==e.type?t.style.opacity=1:u.pin.hideTimeout=setTimeout((()=>t.remove()),55)}}},h={anchor:{create(){const e=p.svgElem("svg",{width:19,height:19,viewBox:"0 0 24 24"}),t=p.svgElem("path",{stroke:"none",d:"M12,2 C13.6568542,2 15,3.34314575 15,5 C15,6.30588222 14.1656226,7.41688515 13.0009007,7.82897577 L13.0008722,19.9379974 C15.8984799,19.5763478 18.3147266,17.665053 19.3940412,15.0596838 L19.417,15 L17,15 C15.9853611,15 15.6358608,13.6848035 16.4495309,13.1641077 L16.5527864,13.1055728 L20.5527864,11.1055728 C21.2176875,10.7731223 22,11.256618 22,12 C22,17.5228475 17.5228475,22 12,22 C6.4771525,22 2,17.5228475 2,12 C2,11.2957433 2.70213089,10.8247365 3.34138467,11.0597803 L3.4472136,11.1055728 L7.4472136,13.1055728 C8.35473419,13.5593331 8.07916306,14.8919819 7.11853213,14.9938221 L7,15 L4.582,15 L4.60595876,15.0596838 C5.68539551,17.6653477 8.10206662,19.5767802 11.0001109,19.9381201 L11.0000889,7.82932572 C9.8348501,7.41751442 9,6.30625206 9,5 C9,3.34314575 10.3431458,2 12,2 Z M12,4 C11.4477153,4 11,4.44771525 11,5 C11,5.55228475 11.4477153,6 12,6 C12.5522847,6 13,5.55228475 13,5 C13,4.44771525 12.5522847,4 12,4 Z"});return e.append(t),e}},arrowDownRight:{create(){const e=p.svgElem("svg",{width:18,height:18,viewBox:"0 0 24 24",fill:"currentColor",style:"transform: rotate(180deg)"}),t=p.svgElem("path",{d:"M16 10H6.83L9 7.83l1.41-1.41L9 5l-6 6 6 6 1.41-1.41L9 14.17 6.83 12H16c1.65 0 3 1.35 3 3v4h2v-4c0-2.76-2.24-5-5-5z"});return e.append(t),e}},arrowsCycle:{create(){const e=p.svgElem("svg",{width:13,height:13,viewBox:"197 -924 573 891",style:"transform: rotate(14deg)"}),t=p.svgElem("path",{stroke:"none",d:"M204-318q-22-38-33-78t-11-82q0-134 93-228t227-94h7l-64-64 56-56 160 160-160 160-56-56 64-64h-7q-100 0-170 70.5T240-478q0 26 6 51t18 49l-60 60ZM481-40 321-200l160-160 56 56-64 64h7q100 0 170-70.5T720-482q0-26-6-51t-18-49l60-60q22 38 33 78t11 82q0 134-93 228t-227 94h-7l64 64-56 56Z"});return e.append(t),e}},arrowsDiagonal:{inwardSVGpath:()=>p.svgElem("path",{stroke:"none",d:"M5 1h2v6H1V5h2.59L0 1.41 1.41 0 5 3.59zm7.41 10H15V9H9v6h2v-2.59L14.59 16 16 14.59z"}),outwardSVGpath:()=>p.svgElem("path",{stroke:"none",d:"M8 6.59L6.59 8 3 4.41V7H1V1h6v2H4.41zM13 9v2.59L9.41 8 8 9.41 11.59 13H9v2h6V9z"}),create(){const e=p.svgElem("svg",{id:"arrows-diagonal-icon",width:16,height:16,viewBox:"0 0 16 16"});return h.arrowsDiagonal.update(e),e},update(...e){0==(e=e.flat()).length&&(e=document.querySelectorAll("#arrows-diagonal-icon")),e.forEach((e=>{e.firstChild?.remove(),e.append(h.arrowsDiagonal[o.expanded?"inwardSVGpath":"outwardSVGpath"]())}))}},arrowsDown:{create(){const e=p.svgElem("svg",{width:19,height:19,viewBox:"0 0 24 24"});return e.append(p.svgElem("path",{stroke:"none",d:"M18,13H6a1,1,0,0,1,0-2H18a1,1,0,0,1,0,2Z"}),p.svgElem("path",{stroke:"none",d:"M14.71,18.29a1,1,0,0,1,0,1.42l-2,2a1,1,0,0,1-1.42,0l-2-2a1,1,0,0,1,1.42-1.42l.29.3V16a1,1,0,0,1,2,0v2.59l.29-.3A1,1,0,0,1,14.71,18.29ZM11.29,8.71a1,1,0,0,0,1.42,0l2-2a1,1,0,1,0-1.42-1.42l-.29.3V3a1,1,0,0,0-2,0V5.59l-.29-.3A1,1,0,0,0,9.29,6.71Z"})),e}},arrowsTwistedRight:{create(){const e=p.svgElem("svg",{width:21,height:21,viewBox:"-1 -1 32 32"}),t=p.svgElem("path",{stroke:"",d:"M23.707,16.293L28.414,21l-4.707,4.707l-1.414-1.414L24.586,22H23c-2.345,0-4.496-1.702-6.702-3.753c0.498-0.458,0.984-0.92,1.46-1.374C19.624,18.6,21.393,20,23,20h1.586l-2.293-2.293L23.707,16.293zM23,11h1.586l-2.293,2.293l1.414,1.414L28.414,10l-4.707-4.707l-1.414,1.414L24.586,9H23c-2.787,0-5.299,2.397-7.957,4.936C12.434,16.425,9.736,19,7,19H4v2h3c3.537,0,6.529-2.856,9.424-5.618C18.784,13.129,21.015,11,23,11zM11.843,14.186c0.5-0.449,0.995-0.914,1.481-1.377C11.364,11.208,9.297,10,7,10H4v2h3C8.632,12,10.25,12.919,11.843,14.186z"});return e.append(t),e}},arrowUp:{create(){const e=p.svgElem("svg",{width:16,height:16,viewBox:"4 2 16 16","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t=p.svgElem("path",{stroke:"",fill:"none","stroke-width":"2",linecap:"round","stroke-linejoin":"round",d:"M7 11L12 6L17 11M12 18V7"});return e.append(t),e}},bug:{create(){const e=p.svgElem("svg",{width:16,height:16,viewBox:"0 0 17 17"});return e.append(p.svgElem("path",{d:"M7 0V1.60002C7.32311 1.53443 7.65753 1.5 8 1.5C8.34247 1.5 8.67689 1.53443 9 1.60002V0H11V2.49963C11.8265 3.12041 12.4543 3.99134 12.7711 5H3.2289C3.5457 3.99134 4.17354 3.12041 5 2.49963V0H7Z"}),p.svgElem("path",{d:"M0 7V9H3V10.4957L0.225279 11.2885L0.774721 13.2115L3.23189 12.5095C3.87194 14.5331 5.76467 16 8 16C10.2353 16 12.1281 14.5331 12.7681 12.5095L15.2253 13.2115L15.7747 11.2885L13 10.4957V9H16V7H9V12H7V7H0Z"})),e}},caretsInward:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 24 24"}),t=p.svgElem("path",{stroke:"",d:"M11.29,9.71a1,1,0,0,0,1.42,0l5-5a1,1,0,1,0-1.42-1.42L12,7.59,7.71,3.29A1,1,0,0,0,6.29,4.71Zm1.42,4.58a1,1,0,0,0-1.42,0l-5,5a1,1,0,0,0,1.42,1.42L12,16.41l4.29,4.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z"});return e.append(t),e}},checkmark:{create(){const e=p.svgElem("svg",{id:`${s.cssPrefix}-checkmark-icon`,width:10,height:10,viewBox:"0 0 20 20"}),t=p.svgElem("path",{stroke:"none",d:"M0 11l2-2 5 5L18 3l2 2L7 18z"});return e.append(t),e}},checkmarkDouble:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 24 24"});return e.append(p.svgElem("path",{stroke:"none",d:"M23.228 8.01785C23.6186 7.62741 23.6187 6.99424 23.2283 6.60363L22.5213 5.89638C22.1309 5.50577 21.4977 5.50563 21.1071 5.89607L10.0862 16.9122C9.69563 17.3027 9.6955 17.9359 10.0859 18.3265L10.7929 19.0337C11.1833 19.4243 11.8165 19.4245 12.2071 19.034L23.228 8.01785Z"}),p.svgElem("path",{stroke:"none",d:"M17.2285 8.01777C17.619 7.62724 17.619 6.99408 17.2285 6.60356L16.5214 5.89645C16.1309 5.50592 15.4977 5.50592 15.1072 5.89645L5.54542 15.4582L2.76773 12.6805C2.37721 12.29 1.74404 12.29 1.35352 12.6805L0.646409 13.3876C0.255884 13.7782 0.255885 14.4113 0.646409 14.8019L4.83831 18.9938C5.22883 19.3843 5.862 19.3843 6.25252 18.9938L17.2285 8.01777Z"})),e}},chevronDown:{create(){const e=p.svgElem("svg",{width:20,height:20,viewBox:"0 0 16 16"}),t=p.svgElem("path",{stroke:"none",d:"M1 5l7 4.61L15 5v2.39L8 12 1 7.39z"});return e.append(t),e}},chevronUp:{create(){const e=p.svgElem("svg",{width:20,height:20,viewBox:"0 0 16 16"}),t=p.svgElem("path",{stroke:"none",d:"M15 11L8 6.39 1 11V8.61L8 4l7 4.61z"});return e.append(t),e}},cogwheel:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 24 24"});return e.append(p.svgElem("path",{"fill-rule":"evenodd",d:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"})),e}},copy:{create(){const e=p.svgElem("svg",{width:18,height:18,viewBox:"0 0 1024 1024"});return e.append(p.svgElem("path",{stroke:"none",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64h64z"}),p.svgElem("path",{stroke:"none",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64H384zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64z"})),e}},fontSize:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 512 512"});return e.append(p.svgElem("path",{stroke:"none",d:"M234.997 448.199h-55.373a6.734 6.734 0 0 1-6.556-5.194l-11.435-48.682a6.734 6.734 0 0 0-6.556-5.194H86.063a6.734 6.734 0 0 0-6.556 5.194l-11.435 48.682a6.734 6.734 0 0 1-6.556 5.194H7.74c-4.519 0-7.755-4.363-6.445-8.687l79.173-261.269a6.734 6.734 0 0 1 6.445-4.781h69.29c2.97 0 5.59 1.946 6.447 4.79l78.795 261.269c1.303 4.322-1.933 8.678-6.448 8.678zm-88.044-114.93l-19.983-84.371c-1.639-6.921-11.493-6.905-13.111.02l-19.705 84.371c-.987 4.224 2.22 8.266 6.558 8.266H140.4c4.346 0 7.555-4.056 6.553-8.286z"}),p.svgElem("path",{stroke:"none",d:"M502.572 448.199h-77.475a9.423 9.423 0 0 1-9.173-7.268l-16-68.114a9.423 9.423 0 0 0-9.173-7.268H294.19a9.423 9.423 0 0 0-9.173 7.268l-16 68.114a9.423 9.423 0 0 1-9.173 7.268h-75.241c-6.322 0-10.851-6.104-9.017-12.155L286.362 70.491a9.422 9.422 0 0 1 9.017-6.69h96.947a9.422 9.422 0 0 1 9.021 6.702l110.245 365.554c1.825 6.047-2.703 12.142-9.02 12.142zM379.385 287.395l-27.959-118.047c-2.293-9.683-16.081-9.661-18.344.029l-27.57 118.047c-1.38 5.91 3.106 11.565 9.175 11.565h55.529c6.082-.001 10.571-5.676 9.169-11.594z"})),e}},googleGPT:{create(e=""){const t=document.createElement("img");return t.id=`${s.cssPrefix}-icon`,h.googleGPT.update(t,e),t},update(t=[],o=""){Array.isArray(t)||(t=[t]),0==t.length&&(t=document.querySelectorAll(`#${s.cssPrefix}-icon`)),t.forEach((t=>{t.src=GM_getResourceText(`ggptIcon${o.charAt(0).toUpperCase()+o.slice(1)||("dark"==e.ui.app.scheme?"White":"Black")}`),t.style.filter=t.style.webkitFilter="drop-shadow(5px 5px 15px rgba(0, 0, 0, 0.3))drop-shadow(2px 1px 0 #ff5b5b) drop-shadow(-1px -1px 0 rgb(73, 215, 73, 0.75))"+("light"==e.ui.app.scheme?"drop-shadow(white 1px 1px)":"")}))}},languageChars:{create(){const e=p.svgElem("svg",{width:15,height:15,viewBox:"0 -960 960 960"}),t=p.svgElem("path",{stroke:"none",d:"m459-48 188-526h125L960-48H847l-35-100H603L568-48H459ZM130-169l-75-75 196-196q-42-45-78-101t-55-105h117q17 32 40.5 67.5T325-514q35-37 70-93t64-119H0v-106h290v-80h106v80h290v106H572q-23 74-70 152T399-438l82 85-39 111-118-121-194 194Zm508-79h139l-69-197-70 197Z"});return e.append(t),e}},moon:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 24 24"}),t=p.svgElem("path",{fill:"none",stroke:"","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z"});return e.append(t),e}},pin:{create(){const e=p.svgElem("svg",{id:"pin-icon",width:17,height:17,viewBox:"0 0 16 16"}),t=p.svgElem("path",{stroke:"",d:"M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a5.927 5.927 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182c-.195.195-1.219.902-1.414.707-.195-.195.512-1.22.707-1.414l3.182-3.182-2.828-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a5.922 5.922 0 0 1 1.013.16l3.134-3.133a2.772 2.772 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146z"});return e.append(t),e}},questionMark:{create(){const e=p.svgElem("svg",{width:18,height:18,viewBox:"0 -960 960 960"}),t=p.svgElem("path",{stroke:"none",d:"M428-383q0-71 16-111t63-74q47-35 58.5-55.5T577-683q0-35-25-57.5T488-763q-26 0-61 18t-50 70l-114-47q27-82 90.5-122.5T488-885q93 0 151.5 59.5T698-682q0 55-17 95t-70 83q-37 29-48.5 55T550-383H428Zm60 265q-41 0-69.5-28.5T390-216q0-41 28.5-69.5T488-314q41 0 69.5 28.5T586-216q0 41-28.5 69.5T488-118Z"});return e.append(t),e}},questionMarkCircle:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 56.693 56.693"}),t=p.svgElem("path",{stroke:"none",d:"M28.765,4.774c-13.562,0-24.594,11.031-24.594,24.594c0,13.561,11.031,24.594,24.594,24.594  c13.561,0,24.594-11.033,24.594-24.594C53.358,15.805,42.325,4.774,28.765,4.774z M31.765,42.913c0,0.699-0.302,1.334-0.896,1.885  c-0.587,0.545-1.373,0.82-2.337,0.82c-0.993,0-1.812-0.273-2.431-0.814c-0.634-0.551-0.954-1.188-0.954-1.891v-1.209  c0-0.703,0.322-1.34,0.954-1.891c0.619-0.539,1.438-0.812,2.431-0.812c0.964,0,1.75,0.277,2.337,0.82  c0.594,0.551,0.896,1.186,0.896,1.883V42.913z M38.427,24.799c-0.389,0.762-0.886,1.432-1.478,1.994  c-0.581,0.549-1.215,1.044-1.887,1.473c-0.643,0.408-1.248,0.852-1.798,1.315c-0.539,0.455-0.99,0.963-1.343,1.512  c-0.336,0.523-0.507,1.178-0.507,1.943v0.76c0,0.504-0.247,1.031-0.735,1.572c-0.494,0.545-1.155,0.838-1.961,0.871l-0.167,0.004  c-0.818,0-1.484-0.234-1.98-0.699c-0.532-0.496-0.801-1.055-0.801-1.658c0-1.41,0.196-2.611,0.584-3.572  c0.385-0.953,0.86-1.78,1.416-2.459c0.554-0.678,1.178-1.27,1.854-1.762c0.646-0.467,1.242-0.93,1.773-1.371  c0.513-0.428,0.954-0.885,1.312-1.354c0.328-0.435,0.489-0.962,0.489-1.608c0-1.066-0.289-1.83-0.887-2.334  c-0.604-0.512-1.442-0.771-2.487-0.771c-0.696,0-1.294,0.043-1.776,0.129c-0.471,0.083-0.905,0.223-1.294,0.417  c-0.384,0.19-0.745,0.456-1.075,0.786c-0.346,0.346-0.71,0.783-1.084,1.301c-0.336,0.473-0.835,0.83-1.48,1.062  c-0.662,0.239-1.397,0.175-2.164-0.192c-0.689-0.344-1.11-0.793-1.254-1.338c-0.135-0.5-0.135-1.025-0.002-1.557  c0.098-0.453,0.369-1.012,0.83-1.695c0.451-0.67,1.094-1.321,1.912-1.938c0.814-0.614,1.847-1.151,3.064-1.593  c1.227-0.443,2.695-0.668,4.367-0.668c1.648,0,3.078,0.249,4.248,0.742c1.176,0.496,2.137,1.157,2.854,1.967  c0.715,0.809,1.242,1.738,1.568,2.762c0.322,1.014,0.486,2.072,0.486,3.146C39.024,23.075,38.823,24.024,38.427,24.799z"});return e.append(t),e}},scheme:{create(){const e=p.svgElem("svg",{width:15,height:15,viewBox:"0 -960 960 960"}),t=p.svgElem("path",{stroke:"none",d:"M479.92-34q-91.56 0-173.4-35.02t-142.16-95.34q-60.32-60.32-95.34-142.24Q34-388.53 34-480.08q0-91.56 35.02-173.4t95.34-142.16q60.32-60.32 142.24-95.34Q388.53-926 480.08-926q91.56 0 173.4 35.02t142.16 95.34q60.32 60.32 95.34 142.24Q926-571.47 926-479.92q0 91.56-35.02 173.4t-95.34 142.16q-60.32 60.32-142.24 95.34Q571.47-34 479.92-34ZM530-174q113-19 186.5-102.78T790-480q0-116.71-73.5-201.35Q643-766 530-785v611Z"});return e.append(t),e}},sidebar:{create(){const e=p.svgElem("svg",{width:15,height:15,viewBox:"0 -975 900 1000"}),t=p.svgElem("path",{stroke:"none",d:"M800-160q33 0 56.5-23.5T880-240v-480q0-33-23.5-56.5T800-800H160q-33 0-56.5 23.5T80-720v480q0 33 23.5 56.5T160-160h640Zm-240-80H160v-480h400v480Zm80 0v-480H800v480H640Zm160 0v-480 480Zm-160 0h-80 80Zm0-480h-80 80Z"});return e.append(t),e}},signalStream:{create(){const e=p.svgElem("svg",{width:16,height:16,viewBox:"0 0 32 32"}),t=p.svgElem("path",{stroke:"","stroke-width":.5,d:"M16 11.75c-2.347 0-4.25 1.903-4.25 4.25s1.903 4.25 4.25 4.25c2.347 0 4.25-1.903 4.25-4.25v0c-0.003-2.346-1.904-4.247-4.25-4.25h-0zM16 17.75c-0.966 0-1.75-0.784-1.75-1.75s0.784-1.75 1.75-1.75c0.966 0 1.75 0.784 1.75 1.75v0c-0.001 0.966-0.784 1.749-1.75 1.75h-0zM3.25 16c0.211-3.416 1.61-6.471 3.784-8.789l-0.007 0.008c0.223-0.226 0.361-0.536 0.361-0.879 0-0.69-0.56-1.25-1.25-1.25-0.344 0-0.655 0.139-0.881 0.363l0-0c-2.629 2.757-4.31 6.438-4.506 10.509l-0.001 0.038c0.198 4.109 1.879 7.79 4.514 10.553l-0.006-0.006c0.226 0.228 0.54 0.369 0.886 0.369 0.69 0 1.249-0.559 1.249-1.249 0-0.346-0.141-0.659-0.368-0.885l-0-0c-2.173-2.307-3.573-5.363-3.774-8.743l-0.002-0.038zM9.363 16c0.149-2.342 1.109-4.436 2.6-6.026l-0.005 0.005c0.224-0.226 0.363-0.537 0.363-0.88 0-0.69-0.56-1.25-1.25-1.25-0.345 0-0.657 0.139-0.883 0.365l0-0c-1.94 2.035-3.179 4.753-3.323 7.759l-0.001 0.028c0.145 3.032 1.384 5.75 3.329 7.79l-0.005-0.005c0.226 0.228 0.54 0.369 0.886 0.369 0.69 0 1.249-0.559 1.249-1.249 0-0.346-0.141-0.659-0.368-0.885l-0-0c-1.49-1.581-2.451-3.676-2.591-5.993l-0.001-0.027zM26.744 5.453c-0.226-0.227-0.54-0.368-0.886-0.368-0.691 0-1.251 0.56-1.251 1.251 0 0.345 0.139 0.657 0.365 0.883l-0-0c2.168 2.31 3.567 5.365 3.775 8.741l0.002 0.040c-0.21 3.417-1.609 6.471-3.784 8.789l0.007-0.008c-0.224 0.226-0.362 0.537-0.362 0.88 0 0.691 0.56 1.251 1.251 1.251 0.345 0 0.657-0.14 0.883-0.365l-0 0c2.628-2.757 4.308-6.439 4.504-10.509l0.001-0.038c-0.198-4.108-1.878-7.79-4.512-10.553l0.006 0.007zM21.811 8.214c-0.226-0.224-0.537-0.363-0.881-0.363-0.69 0-1.25 0.56-1.25 1.25 0 0.343 0.138 0.653 0.361 0.879l-0-0c1.486 1.585 2.447 3.678 2.594 5.992l0.001 0.028c-0.151 2.343-1.111 4.436-2.601 6.027l0.005-0.005c-0.224 0.226-0.362 0.537-0.362 0.88 0 0.691 0.56 1.251 1.251 1.251 0.345 0 0.657-0.14 0.883-0.365l-0 0c1.939-2.036 3.178-4.754 3.323-7.759l0.001-0.028c-0.145-3.033-1.385-5.751-3.331-7.791l0.005 0.005z"});return e.append(t),e}},slash:{create(){const e=p.svgElem("svg",{width:15,height:15,viewBox:"0 0 15 15"}),t=p.svgElem("path",{stroke:"",d:"M4.10876 14L9.46582 1H10.8178L5.46074 14H4.10876Z"});return e.append(t),e}},sparkles:{create(e){const t=p.svgElem("svg",{width:18,height:18,viewBox:"0 0 512 512"});return t.append(p.svgElem("path",{fill:"bg"==e?"none":"",stroke:"","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":32,d:"M259.92,262.91,216.4,149.77a9,9,0,0,0-16.8,0L156.08,262.91a9,9,0,0,1-5.17,5.17L37.77,311.6a9,9,0,0,0,0,16.8l113.14,43.52a9,9,0,0,1,5.17,5.17L199.6,490.23a9,9,0,0,0,16.8,0l43.52-113.14a9,9,0,0,1,5.17-5.17L378.23,328.4a9,9,0,0,0,0-16.8L265.09,268.08A9,9,0,0,1,259.92,262.91Z"})),t.append(p.svgElem("polygon",{fill:"fg"==e?"none":"",stroke:"","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":24,points:"108 68 88 16 68 68 16 88 68 108 88 160 108 108 160 88 108 68"})),t.append(p.svgElem("polygon",{fill:"fg"==e?"none":"",stroke:"","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":32,points:"426.67 117.33 400 48 373.33 117.33 304 144 373.33 170.67 400 240 426.67 170.67 496 144 426.67 117.33"})),t}},speaker:{create(){const e=p.svgElem("svg",{width:22,height:22,viewBox:"0 0 32 32"});return e.append(p.svgElem("path",{stroke:"","stroke-width":"2px",fill:"none",d:"M24.5,26c2.881,-2.652 4.5,-6.249 4.5,-10c0,-3.751 -1.619,-7.348 -4.5,-10"}),p.svgElem("path",{stroke:"","stroke-width":"2px",fill:"none",d:"M22,20.847c1.281,-1.306 2,-3.077 2,-4.924c0,-1.846 -0.719,-3.617 -2,-4.923"}),p.svgElem("path",{stroke:"none",fill:"",d:"M9.957,10.88c-0.605,0.625 -1.415,0.98 -2.262,0.991c-4.695,0.022 -4.695,0.322 -4.695,4.129c0,3.806 0,4.105 4.695,4.129c0.846,0.011 1.656,0.366 2.261,0.991c1.045,1.078 2.766,2.856 4.245,4.384c0.474,0.49 1.18,0.631 1.791,0.36c0.611,-0.272 1.008,-0.904 1.008,-1.604c0,-4.585 0,-11.936 0,-16.52c0,-0.7 -0.397,-1.332 -1.008,-1.604c-0.611,-0.271 -1.317,-0.13 -1.791,0.36c-1.479,1.528 -3.2,3.306 -4.244,4.384Z"})),e}},speechBalloonLasso:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 -960 960 960"}),t=p.svgElem("path",{stroke:"none",d:"M323-41v-247h-10q-105 0-172.5-67T73-528q0-105 74-179t179-74h36l-44-44 69-69 162 162-162 162-69-69 44-44h-36q-64 0-109.5 45.5T171-528q0 64 45.5 109.5T326-373h95v96l96-96h117q64 0 109.5-45.5T789-528q0-64-45.5-109.5T634-683h10v-98h-10q105 0 179 74t74 179q0 105-74 179t-179 74h-77L323-41Z"});return e.append(t),e}},speechBalloons:{create(){const e=p.svgElem("svg",{width:16,height:16,viewBox:"0 -960 960 960"}),t=p.svgElem("path",{stroke:"none",d:"M350-212q-32.55 0-55.27-22.73Q272-257.45 272-290v-64h492v-342h63.67q33.33 0 55.83 22.72Q906-650.55 906-618v576L736-212H350ZM54-256v-582.4q0-32.38 22.72-54.99Q99.45-916 132-916h482q32.55 0 55.28 22.72Q692-870.55 692-838v334q0 32.55-22.72 55.27Q646.55-426 614-426H224L54-256Zm540-268v-294H152v294h442Zm-442 0v-294 294Z"});return e.append(t),e}},sun:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 -960 960 960"}),t=p.svgElem("path",{stroke:"none",d:"M440-760v-160h80v160h-80Zm266 110-55-55 112-115 56 57-113 113Zm54 210v-80h160v80H760ZM440-40v-160h80v160h-80ZM254-652 140-763l57-56 113 113-56 54Zm508 512L651-255l54-54 114 110-57 59ZM40-440v-80h160v80H40Zm157 300-56-57 112-112 29 27 29 28-114 114Zm283-100q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm0-80q66 0 113-47t47-113q0-66-47-113t-113-47q-66 0-113 47t-47 113q0 66 47 113t113 47Zm0-160Z"});return e.append(t),e}},sunglasses:{create(){const e=p.svgElem("svg",{width:17,height:17,viewBox:"0 0 512 512"}),t=p.svgElem("path",{stroke:"none",d:"M507.44,185.327c-4.029-5.124-10.185-8.112-16.704-8.112c0,0-48.021,0-156.827,0h-65.774H243.87h-65.774c-108.806,0-156.827,0-156.827,0c-6.519,0-12.675,2.988-16.714,8.112c-4.028,5.125-5.486,11.815-3.965,18.152c0,0,12.421,56.269,19.927,82.534c7.506,26.265,26.265,48.772,86.29,48.772s59.827,0,74.828,0c21.258,0,46.256-19.99,55.028-45.023c4.97-14.16,12.756-32.738,19.338-47.876c6.582,15.138,14.368,33.716,19.338,47.876c8.773,25.033,33.77,45.023,55.028,45.023c15.001,0,14.803,0,74.828,0s78.784-22.507,86.29-48.772c7.496-26.264,19.918-82.534,19.918-82.534C512.935,197.142,511.478,190.452,507.44,185.327z M90.339,278.734C45.314,263.732,40.318,198.7,40.318,198.7s22.507,0,55.028,0L90.339,278.734z M340.464,278.734c-45.015-15.001-50.022-80.034-50.022-80.034s22.508,0,55.029,0L340.464,278.734z"});return e.append(t),e}},webCorner:{create(){const e=p.svgElem("svg",{width:18,height:18,viewBox:"0 0 32 32"}),t=p.svgElem("path",{stroke:"none",d:"M29.9,2.6c-0.1-0.2-0.3-0.4-0.5-0.5C29.3,2,29.1,2,29,2H3C2.4,2,2,2.4,2,3s0.4,1,1,1h2c5,0,9,4,9,9c0,1.9-0.6,3.8-1.8,5.4l-4.9,4.9c-0.4,0.4-0.4,1,0,1.4C7.5,24.9,7.7,25,8,25s0.5-0.1,0.7-0.3l4.9-4.9c1.6-1.2,3.4-1.8,5.4-1.8c5,0,9,4,9,9v2    c0,0.6,0.4,1,1,1s1-0.4,1-1V3C30,2.9,30,2.7,29.9,2.6zM26.6,4l-4.8,4.8c0-1.9-0.8-3.5-2-4.8H26.6z M11.3,4H15c2.7,0,4.8,2.2,4.8,4.8c0,1-0.3,2-0.9,2.9l-3,3C16,14.2,16,13.6,16,13C16,9.3,14.1,6,11.3,4z M19,16c-0.6,0-1.2,0-1.7,0.1l3-3c0.8-0.6,1.8-0.9,2.9-0.9c2.7,0,4.8,2.2,4.8,4.8v3.7C26,17.9,22.7,16,19,16z M23.2,10.2L28,5.4v6.8C26.8,11,25.1,10.2,23.2,10.2z"});return e.append(t),e}},widescreen:{wideSVGpath:()=>p.svgElem("path",{stroke:"",fill:"","fill-rule":"evenodd",d:"m26,13 0,10 -16,0 0,-10 z m-14,2 12,0 0,6 -12,0 0,-6 z"}),tallSVGpath:()=>p.svgElem("path",{stroke:"",fill:"","fill-rule":"evenodd",d:"m28,11 0,14 -20,0 0,-14 z m-18,2 16,0 0,10 -16,0 0,-10 z"}),create(){const e=p.svgElem("svg",{id:"widescreen-icon",width:18,height:18,viewBox:"8 8 20 20"});return h.widescreen.update(e),e},update(...e){0==(e=e.flat()).length&&(e=document.querySelectorAll("#widescreen-icon:not(.chatgpt-notif *)")),e.forEach((e=>{e.firstChild?.remove(),e.append(h.widescreen[o.widerSidebar?"wideSVGpath":"tallSVGpath"]())}))}},x:{create(){const e=p.svgElem("svg",{height:10,viewBox:"0 0 14 14",fill:"none"}),t=p.svgElem("path",{d:"M13.7071 1.70711C14.0976 1.31658 14.0976 0.683417 13.7071 0.292893C13.3166 -0.0976312 12.6834 -0.0976312 12.2929 0.292893L7 5.58579L1.70711 0.292893C1.31658 -0.0976312 0.683417 -0.0976312 0.292893 0.292893C-0.0976312 0.683417 -0.0976312 1.31658 0.292893 1.70711L5.58579 7L0.292893 12.2929C-0.0976312 12.6834 -0.0976312 13.3166 0.292893 13.7071C0.683417 14.0976 1.31658 14.0976 1.70711 13.7071L7 8.41421L12.2929 13.7071C12.6834 14.0976 13.3166 14.0976 13.7071 13.7071C14.0976 13.3166 14.0976 12.6834 13.7071 12.2929L8.41421 7L13.7071 1.70711Z"});return e.append(t),e}}},b={googleGPT:{create(){const e=document.createElement("img");return e.id=`${s.cssPrefix}-logo`,e.className="no-mobile-tap-outline",b.googleGPT.update(e),e},update(...t){0==(t=t.flat()).length&&(t=document.querySelectorAll(`#${s.cssPrefix}-logo`)),t.forEach((t=>t.src=GM_getResourceText(`ggpt${"dark"==e.ui.app.scheme?"DS":"LS"}logo`)))}}},f={appBottomPos(){E.style.bottom=(o.minimized?36-E.offsetHeight:-33)+"px"},chatbarWidth(){const t=E.querySelector(`#${s.cssPrefix}-chatbar`);t&&(t.style.width=(e.browser.isMobile?81.4:o.anchored?o.expanded?87.4:83.3:o.widerSidebar?e.ui.site.hasSidebar?85.4:85.9:e.ui.site.hasSidebar?79.3:80.1)+"%")},footerContent(){function t(e){let t,s,o=e.length;for(;0!=o;)s=Math.floor(chatgpt.randomFloat()*o),o-=1,t=e[o],e[o]=e[s],e[s]=t;return e}function o(e){let t=[...e],s=t.length-1;return e.forEach((([e,o])=>{if(o.boost){const r=parseInt(o.boost)/100,a=Math.ceil(s/(1-r))*r-1;for(let s=0;s<a;s++)t.push([e,o]);s+=a}})),t}_.json("https://cdn.jsdelivr.net/gh/KudoAI/ads-library/advertisers/index.json",((r,a)=>{if(r)return;let n,i;const l=new RegExp(s.name.toLowerCase(),"i"),c=(()=>{const e=new Date;return e.getFullYear()+String(e.getMonth()+1).padStart(2,"0")+String(e.getDate()).padStart(2,"0")})();for(const[e,s]of t(o(Object.entries(a))))if(s.campaigns.text){n=e;break}if(n){const r="https://cdn.jsdelivr.net/gh/KudoAI/ads-library/advertisers/"+n+"/text/campaigns.json";_.json(r,((r,a)=>{if(!r)for(const[r,n]of t(o(Object.entries(a)))){if(n.active&&(!n.endDate||c<=n.endDate)){for(const[a,c]of t(o(Object.entries(n.adGroups)))){if(/^self$/i.test(a)&&!l.test(r)||l.test(r)&&!/^self$/i.test(a)||0==c.active||c.targetBrowsers&&!c.targetBrowsers.some((e=>new RegExp(e,"i").test(navigator.userAgent)))||c.targetLocations&&(!e.userLocale||!c.targetLocations.some((t=>t.includes(e.userLocale)||e.userLocale.includes(t)))))continue;const t=c.ads.filter((e=>0!=e.active));if(0==t.length)continue;const o=t[Math.floor(chatgpt.randomFloat()*t.length)];let d=o.destinationURL||c.destinationURL||n.destinationURL||"";if(d.includes("http")){const[e,t]=d.split("?"),o=new URLSearchParams(t||"");o.set("utm_source",s.name.toLowerCase()),o.set("utm_content","app_footer_link"),d=e+"?"+o.toString()}const g=d?p.anchor(d):document.createElement("span");F.replaceWith(g),F=g,F.textContent=o.text,F.setAttribute("title",o.tooltip||""),i=!0;break}if(i)break}}}))}}))},replyPrefix(){const t=E.querySelector("pre p");if(!t)return;const s="dark"==e.ui.app.scheme&&!o.bgAnimationsDisabled,r=t.textContent.startsWith(">> ");s&&!r?t.prepend(">> "):!s&&r&&(t.textContent=t.textContent.replace(/^>> /,""))},rqVisibility(){const e=E.querySelector(`.${s.cssPrefix}-related-queries`);e&&(e.style.display=o.rqDisabled||o.anchored?"none":"flex")},scheme(t){a.caller=`update.scheme('${t}')`,a.debug(`Updating ${s.name} scheme to ${a.toTitleCase(t)}...`),e.ui.app.scheme=t,b.googleGPT.update(),h.googleGPT.update(),f.style.app(),f.stars(),f.replyPrefix(),k.btnGlow(),m.settings.updateSchemeStatus(),a.debug(`Success! ${s.name} updated to ${a.toTitleCase(t)} scheme`)},stars(){["sm","med","lg"].forEach((t=>document.querySelectorAll(`[id*="stars-${t}"]`).forEach((s=>s.id=o.bgAnimationsDisabled?`stars-${t}-off`:`${"dark"==e.ui.app.scheme?"white":"black"}-stars-${t}`))))},style:{app(){const t="dark"==e.ui.app.scheme&&!o.bgAnimationsDisabled;m.stylize(),s.styles.innerText=`:root {--app-bg-color-light-scheme: #ffffff ; --app-bg-color-dark-scheme: #282828 ;--pre-bg-color-light-scheme: #e7e7e799 ; --pre-bg-color-dark-scheme: #3a3a3a ;--font-color-light-scheme: #282828 ; --font-color-dark-scheme: #f2f2f2 }@keyframes btn-zoom-fade-out {0% { opacity: 1 } 50% { opacity: 0.65 ; transform: scale(1.85) }75% { opacity: 0.05 ; transform: scale(3.15) } 100% { opacity: 0 ; transform: scale(5.85) }}.no-user-select {-webkit-user-select: none ; -moz-user-select: none ;-ms-user-select: none ; user-select: none }.no-mobile-tap-outline { outline: none ; -webkit-tap-highlight-color: transparent }#${s.cssPrefix} *::-webkit-scrollbar { width: 7px }#${s.cssPrefix} *::-webkit-scrollbar-thumb { background: #cdcdcd }#${s.cssPrefix} *::-webkit-scrollbar-thumb:hover { background: #a6a6a6 }#${s.cssPrefix} *::-webkit-scrollbar-track { background: none }#${s.cssPrefix} * { scrollbar-width: thin }.cursor-overlay {position: fixed ; top: 0 ; left: 0 ; width: 100% ; height: 100% ;z-index: 9999 ; cursor: ew-resize }#${s.cssPrefix} {z-index: 111 ; padding: ${e.browser.isFF?20:22}px 26px 6px 26px ;flex-basis: 0 ; height: fit-content ;border: ${"dark"==e.ui.app.scheme?"none":"1px solid #dadce0"} ; border-radius: 8px ;width: ${e.browser.isMobile?"auto":"319px"} ;`+(e.browser.isMobile?"margin: 8px 0 8px":"margin-bottom: 30px")+";flex-grow: 1 ; word-wrap: break-word ; white-space: pre-wrap ;box-shadow: 0 2px 3px rgba(0, 0, 0, 0.06) ;"+(o.bgAnimationsDisabled?`background: var(--app-bg-color-${e.ui.app.scheme}-scheme) ;color: var(--font-color-${e.ui.app.scheme}-scheme) ;`:`background-image: linear-gradient(180deg, ${"dark"==e.ui.app.scheme?"#99a8a6 -245px, black 185px":"#b6ebff -163px, white 65px"}) ;`)+(o.fgAnimationsDisabled?"":"transition: bottom 0.1s cubic-bezier(0, 0, 0.2, 1),"+(o.anchored?"width 0.167s cubic-bezier(0, 0, 0.2, 1),":"")+"opacity 0.5s ease, transform 0.5s ease ;")+"}"+`#${s.cssPrefix}:hover {box-shadow: 0 9px 28px rgba(0, 0, 0, 0.09) ; transition: box-shadow 0.15s ease }`+`#${s.cssPrefix} p { margin: 0 ; ${"dark"==e.ui.app.scheme?"color: #ccc":""}}`+`#${s.cssPrefix} .alert-link {`+`color: ${"light"==e.ui.app.scheme?"#190cb0":"white ; text-decoration: underline"}}`+`.${s.cssPrefix}-name {font-size: 1.35rem ; font-weight: 700 ; text-decoration: none ;`+`color: ${"dark"==e.ui.app.scheme?"white":"black"} !important }.kudoai {`+`font-size: ${e.browser.isMobile?.85:.75}rem ;`+`position: relative ; left: ${e.browser.isMobile?8:6}px ; color: #aaa }.kudoai a, .kudoai a:visited { color: #aaa ; text-decoration: none !important }`+`.kudoai a:hover { color: ${"dark"==e.ui.app.scheme?"white":"black"}}`+`#${s.cssPrefix}-div-corner-btns { float: right }`+`.${s.cssPrefix}-div-corner-btn {float: right ; cursor: pointer ; position: relative ; top: 6px ;`+("dark"==e.ui.app.scheme?"fill: white ; stroke: white":"fill: #adadad ; stroke: #adadad")+";transition: transform 0.15s ease,opacity 0.1s ease-in-out }"+`.${s.cssPrefix}-div-corner-btn:hover {`+("dark"==e.ui.app.scheme?"fill: #d9d9d9 ; stroke: #d9d9d9":"fill: black ; stroke: black")+" ;"+(o.fgAnimationsDisabled||e.browser.isMobile?"":"transform: scale(1.285)")+"}"+`.${s.cssPrefix}-div-corner-btn:active {`+("dark"==e.ui.app.scheme?"fill: #999999 ; stroke: #999999":"fill: #638ed4 ; stroke: #638ed4")+"}"+(o.bgAnimationsDisabled?"":`#${s.cssPrefix}-logo, .${s.cssPrefix}-div-corner-btn svg, .${s.cssPrefix}-standby-btn {filter: drop-shadow(${"dark"==e.ui.app.scheme?"#7171714d 10px":"#aaaaaa21 7px"} 7px 3px) }`)+`#${s.cssPrefix} .loading {padding-bottom: 15px ; color: #b6b8ba ;animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite }`+`#${s.cssPrefix}.sidebar-free { margin-left: 60px ; height: fit-content }`+`#${s.cssPrefix}-font-size-slider-track {width: 98% ; height: 7px ; margin: 0 auto -15px ; padding: 15px 0 ;background-color: #ccc ; box-sizing: content-box; background-clip: content-box ;-webkit-background-clip: content-box }`+`#${s.cssPrefix}-font-size-slider-track::before {content: "" ; position: absolute ; top: 10px ; left: 0 ; right: 0 ;height: calc(100% - 20px) ; cursor: pointer }`+`#${s.cssPrefix}-font-size-slider-tip {z-index: 1 ; position: absolute ; bottom: 20px ;border-left: 4.5px solid transparent ; border-right: 4.5px solid transparent ;border-bottom: 16px solid #ccc }`+`#${s.cssPrefix}-font-size-slider-thumb {z-index: 2 ; width: 10px ; height: 26px ; border-radius: 30% ; position: relative ;top: -8.25px ; transition: transform 0.05s ease ;`+`background-color: ${"dark"==e.ui.app.scheme?"white":"#4a4a4a"} ;box-shadow: rgba(0, 0, 0, 0.21) 1px 1px 9px 0 ; cursor: ew-resize }`+(o.fgAnimationsDisabled||e.browser.isMobile?"":`#${s.cssPrefix}-font-size-slider-thumb:hover { transform: scale(1.125) }`)+`.${s.cssPrefix}-standby-btn {width: 100% ; margin-top: 20px ; padding: 11px 0 ; cursor: pointer ;`+`background-color: #f0f0f0${o.bgAnimationsDisabled?"":"00"} ;`+`color: ${t?"white":"black"} ; transition: transform 0.15s ease ;`+`border-radius: 4px ; border: 1px solid ${t?"#fff":"#888"} }`+`.${s.cssPrefix}-standby-btn:hover {`+("dark"==e.ui.app.scheme?"background: white ; color: black":"background: black ; color: white")+";"+(o.fgAnimationsDisabled||e.browser.isMobile?"":"transform: scaleX(1.015) scaleY(1.03)")+"}"+`.${s.cssPrefix}-reply-tip {content: "" ; position: relative ; border: 7px solid transparent ;`+`float: left ; margin: ${e.browser.isMobile?39:26}px -15px 0 0 ;`+`left: ${e.browser.isMobile?12:6}px ;border-bottom-style: solid ; border-bottom-width: 16px ; border-top: 0 ; border-bottom-color:`+(t?"#0000":`var(--pre-bg-color-${e.ui.app.scheme}-scheme)`)+"}"+`#${s.cssPrefix} > pre {`+`font-size: ${o.fontSize}px ; white-space: pre-wrap ; min-width: 0 ;`+`line-height: ${o.fontSize*o.lineHeightRatio}px ; overscroll-behavior: contain ;margin: 16px 0 0 0 ; padding: 1.25em ; border-radius: 10px ; overflow: auto ;`+(o.bgAnimationsDisabled?`background: var(--pre-bg-color-${e.ui.app.scheme}-scheme) ;color: var(--font-color-${e.ui.app.scheme}-scheme)`:("dark"==e.ui.app.scheme?"background: #2b3a40cf ; color: var(--font-color-dark-scheme) ; border: 1px solid white":"background: var(--pre-bg-color-light-scheme) ;color: var(--font-color-light-scheme) ; border: none")+" ;")+(o.fgAnimationsDisabled?"":"transition: max-height 0.167s cubic-bezier(0, 0, 0.2, 1) ;")+"}"+`#${s.cssPrefix} > pre a, #${s.cssPrefix} > pre a:visited { color: #4495d4 }`+`#${s.cssPrefix} pre a:hover { color: ${"dark"==e.ui.app.scheme?"white":"#28a017"}}@keyframes pulse { 0%, to { opacity: 1 } 50% { opacity: .5 }}`+`#${s.cssPrefix} section.loading { padding: 15px 0 14px 5px }`+`.${s.cssPrefix}-reply-corner-btns {`+`float: right ; fill: ${"dark"==e.ui.app.scheme?"white":"#6f6f6f"}}`+`code #${s.cssPrefix}-copy-btn { position: relative ; top: -6px ; right: -9px }`+`code #${s.cssPrefix}-copy-btn > svg { height: 13px ; width: 13px ; fill: white }`+`#${s.cssPrefix}-chatbar {`+`border: solid 1px ${"dark"==e.ui.app.scheme?o.bgAnimationsDisabled?"#777":"#aaa":"#638ed4"} ;border-radius: 12px 13px 12px 0 ; margin: 13px 0 15px 0 ; padding: 13px 55px 13px 10px ;`+`position: relative ; z-index: 555 ; color: ${"dark"==e.ui.app.scheme?"#eee":"#222"} ;height: 16px ; max-height: 200px ; resize: none ;`+`background: ${"light"==e.ui.app.scheme?"#eeeeee9e":"#515151"+(o.bgAnimationsDisabled?"":"9e")} ;`+("light"==e.ui.app.scheme?"box-shadow: 0 1px 2px rgba(15,17,17,.1) inset":"")+"}"+`#${s.cssPrefix}-chatbar:focus-visible { outline: -webkit-focus-ring-color auto 1px }`+`.${s.cssPrefix}-related-queries {display: flex ; flex-wrap: wrap ; width: 100% ; margin-bottom: 19px }`+`.${s.cssPrefix}-related-query {`+`font-size: ${e.browser.isMobile?1:.81}em ; cursor: pointer ;box-sizing: border-box ; width: fit-content ; max-width: 100% ;margin: 5px 4px 7px 0 ; padding: 8px 12px 8px 13px ;`+`color: ${"dark"==e.ui.app.scheme?o.bgAnimationsDisabled?"#ccc":"#f2f2f2":"#767676"} ;`+`background: ${o.bgAnimationsDisabled?"dark"==e.ui.app.scheme?"#404040":"#dadada12":"dark"==e.ui.app.scheme?"#595858d6":"#fbfbfbb0"} ;`+`border: 1px solid ${"dark"==e.ui.app.scheme?o.bgAnimationsDisabled?"#5f5f5f":"#777":"#e1e1e1"} ;border-radius: 0 13px 12px 13px ; flex: 0 0 auto ;`+`box-shadow: 1px 4px ${"dark"==e.ui.app.scheme?(o.bgAnimationsDisabled?10:18)+"px -8px lightgray":"8px -6px rgba(169, 169, 169, 0.75)"};`+(o.fgAnimationsDisabled?"":"transition: transform 0.1s ease !important")+"}"+`.${s.cssPrefix}-related-query:hover, .${s.cssPrefix}-related-query:focus {`+(o.fgAnimationsDisabled||e.browser.isMobile?"":"transform: scale(1.055) !important ;")+`background: ${"dark"==e.ui.app.scheme?"#a2a2a270":"#dae5ffa3 ; color: #000000a8 ; border-color: #a3c9ff"}}`+`.${s.cssPrefix}-related-query svg {float: left ; margin: -0.09em 6px 0 0 ;`+`color: ${"dark"==e.ui.app.scheme?"#aaa":"#c1c1c1"}}.fade-in { opacity: 0 ; transform: translateY(10px) }.fade-in-less { opacity: 0 ; transition: opacity 0.2s ease }.fade-in.active, .fade-in-less.active { opacity: 1 ; transform: translateY(0) }`+`.${s.cssPrefix}-chatbar-btn {z-index: 560 ;border: none ; float: right ; position: relative ; background: none ; cursor: pointer ;`+`bottom: ${(e.browser.isFF?46:49)+(e.ui.site.hasSidebar?3:2)}px ;`+("dark"==e.ui.app.scheme?"color: #aaa ; fill: #aaa ; stroke: #aaa":"color: lightgrey ; fill: lightgrey ; stroke: lightgrey")+"}"+`.${s.cssPrefix}-chatbar-btn:hover {`+("dark"==e.ui.app.scheme?"color: white ; fill: white ; stroke: white":"color: #638ed4 ; fill: #638ed4 ; stroke: #638ed4")+"}"+`#${s.cssPrefix} > pre h1 { font-size: 1.25em }#${s.cssPrefix} > pre h2 { font-size: 1.1em }#${s.cssPrefix} > pre > p:last-of-type { margin-bottom: -1.25em }#${s.cssPrefix} > pre ol { padding-left: 1.58em }#${s.cssPrefix} > pre ul { margin: -10px 0 -6px ; padding-left: 1.5em }#${s.cssPrefix} > pre li { margin: -10px 0 ; list-style: unset }code.hljs { text-wrap: nowrap ; overflow-x: scroll }.katex-html { display: none }`+`#${s.cssPrefix} footer {position: relative ; text-align: right ; font-size: 0.75rem ; line-height: 1.43em ;`+`right: ${e.browser.isFF?-54:-72}px ;`+`margin: ${e.browser.isFF?1:-2}px -32px 12px }`+`#${s.cssPrefix} footer * { color: #aaa ; text-decoration: none }`+`#${s.cssPrefix} footer a:hover { color: ${"dark"==e.ui.app.scheme?"white":"black"}}.chatgpt-notif { fill: white ; stroke: white ; font-size: 25px !important ; padding: 13px 14px 13px 13px !important }.notif-close-btn { display: none !important }`+`.${s.cssPrefix}-menu {position: absolute ; z-index: 12250 ;padding: 3.5px 5px !important ; font-family: "Source Sans Pro", sans-serif ; font-size: 12px }`+`.${s.cssPrefix}-menu ul { margin: 0 ; padding: 0 ; list-style: none }`+`.${s.cssPrefix}-menu-item { padding: 0 5px ; line-height: 20.5px }`+`.${s.cssPrefix}-menu-item:not(.${s.cssPrefix}-menu-header):hover {cursor: pointer ; background: white ; color: black ; fill: black }`+`#${s.cssPrefix}-checkmark-icon { fill: #b3f96d }`+`.${s.cssPrefix}-menu-item:hover #${s.cssPrefix}-checkmark-icon { fill: green }`},tweaks(){M.innerText=(o.widerSidebar?q:"")+(o.stickySidebar?T:o.anchored?z+(o.expanded?I:""):"");const e=E.querySelector(".kudoai");if(e){const t=[...E.querySelectorAll(`.${s.cssPrefix}-div-corner-btn`)].filter((e=>"none"!=getComputedStyle(e).display)).length;e.style.display=t<=(o.anchored&&o.expanded?10:!o.anchored&&o.widerSidebar?8:o.anchored&&!o.expanded?6:3)?"":"none"}const t=E.querySelector("pre"),r=E.querySelector(`.${s.cssPrefix}-related-queries`),a=window.innerHeight-r?.offsetHeight-328,n=window.innerHeight-309;t&&(t.style.maxHeight=o.stickySidebar?r?.offsetHeight>0?`${a}px`:`${n}px`:o.anchored?n-(o.expanded?115:365)+"px":"none")}}};function x(){const e=[...document.querySelectorAll("span")].find((e=>"Dark theme"==e.textContent))?.nextElementSibling.textContent;if(e)return"On"==e;for(const e of document.getElementsByTagName("img"))if("Google"==e.alt&&e.src.includes("light"))return!0;return window.matchMedia?.("(prefers-color-scheme: dark)")?.matches}function y(t){if(t.querySelector('[id*="stars"]'))return;const s=document.createElement("div");s.style.cssText="position: absolute ; top: 0 ; left: 0 ;height: 100% ; width: 100% ; border-radius: 15px ; overflow: clip ;z-index: -1",["sm","med","lg"].forEach((t=>{const r=document.createElement("div");r.id=o.bgAnimationsDisabled?`stars-${t}-off`:`${"dark"==e.ui.app.scheme?"white":"black"}-stars-${t}`,s.append(r)})),t.prepend(s)}const w={appDiv(){E.addEventListener(l.down,(e=>{0==e.button&&document.getElementById(`${s.cssPrefix}-font-size-slider-track`)&&!e.target.closest('[id*="font-size"]')&&"pointer"!=getComputedStyle(e.target).cursor&&v.toggle("off")})),E.onmouseover=E.onmouseout=e=>E.querySelectorAll(`.${s.cssPrefix}-div-corner-btn`).forEach((t=>{/about|settings|chevron/.test(t.id)||(t.style.opacity="mouseover"==e.type?1:0)}))},appDivCornerBtns(){E.querySelectorAll(`.${s.cssPrefix}-div-corner-btn`).forEach((r=>{r.id.endsWith("chevron-btn")?r.onclick=()=>{E.querySelector(`#${s.cssPrefix}-font-size-slider-track`)?.classList.contains("active")&&v.toggle("off"),k.minimized()}:r.id.endsWith("about-btn")?r.onclick=()=>m.open("about"):r.id.endsWith("settings-btn")?r.onclick=()=>m.open("settings"):r.id.endsWith("speak-btn")?r.onclick=()=>{const e=E.querySelector("pre").textContent,s={voice:2,pitch:1,speed:1.5},r=[{code:"en",regex:/^(eng(lish)?|en(-\w\w)?)$/i,rate:2},{code:"ar",regex:/^(ara?(bic)?|اللغة العربية)$/i,rate:1.5},{code:"cs",regex:/^(cze(ch)?|[cč]e[sš].*|cs)$/i,rate:1.4},{code:"da",regex:/^dan?(ish|sk)?$/i,rate:1.3},{code:"de",regex:/^(german|deu?(tsch)?)$/i,rate:1.5},{code:"es",regex:/^(spa(nish)?|espa.*|es(-\w\w)?)$/i,rate:1.5},{code:"fi",regex:/^(fin?(nish)?|suom.*)$/i,rate:1.4},{code:"fr",regex:/^fr/i,rate:1.2},{code:"hu",regex:/^(hun?(garian)?|magyar)$/i,rate:1.5},{code:"it",regex:/^ita?(lian[ao]?)?$/i,rate:1.4},{code:"ja",regex:/^(ja?pa?n(ese)?|日本語|ja)$/i,rate:1.5},{code:"nl",regex:/^(dut(ch)?|flemish|nederlandse?|vlaamse?|nld?)$/i,rate:1.3},{code:"pl",regex:/^po?l(ish|ski)?$/i,rate:1.4},{code:"pt",regex:/^(por(tugu[eê]se?)?|pt(-\w\w)?)$/i,rate:1.5},{code:"ru",regex:/^(rus?(sian)?|русский)$/i,rate:1.3},{code:"sv",regex:/^(swe?(dish)?|sv(enska)?)$/i,rate:1.4},{code:"tr",regex:/^t[uü]?r(k.*)?$/i,rate:1.6},{code:"vi",regex:/^vi[eệ]?t?(namese)?$/i,rate:1.5},{code:"zh-CHS",regex:/^(chi(nese)?|zh|中[国國])/i,rate:2}],a=r.find((e=>e.regex.test(o.replyLanguage)))||r[0],n={text:e,curTime:Date.now(),spokenDialect:a.code,rate:a.rate.toString()},i=CryptoJS.enc.Utf8.parse("76350b1840ff9832eb6244ac6d444366"),l=CryptoJS.enc.Utf8.parse(atob("AAAAAAAAAAAAAAAAAAAAAA==")||"76350b1840ff9832eb6244ac6d444366"),c=CryptoJS.AES.encrypt(JSON.stringify(n),i,{iv:l,mode:CryptoJS.mode.CBC,pad:CryptoJS.pad.Pkcs7}).toString();t({url:"https://fanyi.sogou.com/openapi/external/getWebTTS?S-AppId=102356845&S-Param="+encodeURIComponent(c),method:"GET",responseType:"arraybuffer",onload:async t=>{if(200!=t.status)chatgpt.speak(e,s);else{const o=new(window.AudioContext||window.webkitAudioContext);o.decodeAudioData(t.response,(e=>{const t=o.createBufferSource();t.buffer=e,t.connect(o.destination),t.start(0)})).catch((()=>chatgpt.speak(e,s)))}}})}:r.id.endsWith("font-size-btn")?r.onclick=()=>v.toggle():r.id.endsWith("pin-btn")?r.onmouseover=r.onmouseout=u.pin.toggle:r.id.endsWith("wsb-btn")?r.onclick=()=>k.sidebar("wider"):r.id.endsWith("arrows-btn")&&(r.onclick=()=>k.expandedMode()),e.browser.isMobile||r.id.endsWith("pin-btn")||(r.onmouseover=r.onmouseout=k.tooltip),/about|settings|speak/.test(r.id)&&(r.onmouseup=()=>{o.fgAnimationsDisabled||(r.style.animation="btn-zoom-fade-out .220s ease-out",setTimeout((()=>{Object.assign(r.style,{opacity:"0",visibility:"hidden",animation:""}),setTimeout((()=>Object.assign(r.style,{visibility:"visible",opacity:"1"})),200)}),170))})}))},replySection(){const t=E.querySelector("form");t.onkeydown=e=>{if("Enter"==e.key||13==e.keyCode)if(e.ctrlKey){const e=E.querySelector(`#${s.cssPrefix}-chatbar`),t=e.selectionStart,o=e.value.substring(0,t),r=e.value.substring(t);e.value=o+"\n"+r,e.selectionStart=e.selectionEnd=t+1,w.replySection.chatbarAutoSizer()}else e.shiftKey||w.replySection.submitHandler(e)},w.replySection.submitHandler=function(t){t.preventDefault();const o=E.querySelector(`#${s.cssPrefix}-chatbar`);if(""==o.value.trim())o.placeholder=`${s.msgs.placeholder_typeSomething}...`,o.focus();else{G.length>2&&G.splice(0,2),G=C(G);const t=E.querySelector("pre")?.textContent.substring(0,250-o.value.length)||"";G.push({role:"assistant",content:t}),G.push({role:"user",content:P(o.value)}),_.reply(G),E.querySelector(`.${s.cssPrefix}-related-queries`)?.remove(),e.browser.isMobile||(D.style.opacity=0);E.querySelector("footer").textContent="";const r=E.querySelector("section");r.classList.add("loading","no-user-select"),r.innerText=s.alerts.waitingResponse,L.reply.src=null,L.reply.chatbarFocused=!1,L.reply.userInteracted=!0}},t.onsubmit=w.replySection.submitHandler;const o=E.querySelector(`#${s.cssPrefix}-chatbar`),{paddingTop:r,paddingBottom:a}=getComputedStyle(o),n=parseInt(r)+parseInt(a);let i=o.value.length;w.replySection.chatbarAutoSizer=()=>{const e=o.value.length;e<i&&(o.style.height="auto",parseInt(getComputedStyle(o).height)<35&&(o.style.height="16px"));const t=o.scrollHeight-n;o.style.height=`${t>29?t:16}px`,i=e},o.oninput=w.replySection.chatbarAutoSizer,E.querySelectorAll(`.${s.cssPrefix}-chatbar-btn`).forEach((t=>{t.id.endsWith("shuffle-btn")&&(t.onclick=()=>{o.value=P("Generate a single random question on any topic then answer it. Don't talk about Canberra, Tokyo, blue whales, photosynthesis, oceans, deserts, mindfulness meditation, the Fibonacci sequence, the liver, Jupiter, the Great Wall of China, Sheakespeare or da Vinci. Try to give an answer that is 50-100 words. Do not type anything but the question and answer. Reply in markdown."),o.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0})),L.reply.src="shuffle"}),e.browser.isMobile||(t.onmouseover=t.onmouseout=k.tooltip)}))}},v={fadeInDelay:5,hWheelDistance:10,createAppend(){a.caller="fontSizeSlider.createAppend()",a.debug("Creating/appending Font Size slider..."),v.cursorOverlay=document.createElement("div"),v.cursorOverlay.classList.add("cursor-overlay");const t=document.createElement("div");t.id=`${s.cssPrefix}-font-size-slider-track`,t.className="fade-in-less",t.style.display="none";const n=document.createElement("div");n.id=`${s.cssPrefix}-font-size-slider-thumb`,n.title=Math.floor(10*o.fontSize)/10+"px";const i=document.createElement("div");i.id=`${s.cssPrefix}-font-size-slider-tip`,t.append(n,i),E.insertBefore(t,E.querySelector(`.${s.cssPrefix}-btn-tooltip,pre`)),setTimeout((()=>{const e=(o.fontSize-o.minFontSize)/(o.maxFontSize-o.minFontSize)*(t.offsetWidth-n.offsetWidth);n.style.left=e+"px"}),v.fadeInDelay);let c,p,d=!1;function g(e){const s=t.offsetWidth-n.offsetWidth;e<0&&(e=0),e>s&&(e=s),n.style.left=e+"px";const a=E.querySelector("pre"),i=e/s,l=o.minFontSize+i*(o.maxFontSize-o.minFontSize);a.style.fontSize=l+"px",a.style.lineHeight=l*o.lineHeightRatio+"px",r.save("fontSize",l),n.title=Math.floor(10*o.fontSize)/10+"px"}return n.addEventListener(l.down,(e=>{0==e.button&&(e.preventDefault(),d=!0,c=e.clientX,p=n.offsetLeft,document.body.appendChild(v.cursorOverlay))})),document.addEventListener(l.move,(e=>{d&&g(p+e.clientX-c)})),document.addEventListener(l.up,(()=>{d=!1,v.cursorOverlay.parentNode&&v.cursorOverlay.remove()})),e.browser.isMobile||(t.onwheel=e=>{e.preventDefault(),g(n.offsetLeft-Math.sign(e.deltaY)*v.hWheelDistance)}),t.addEventListener(l.down,(e=>{if(0!=e.button)return;e.preventDefault();const s=e.clientX||e.touches?.[0]?.clientX;g(s-t.getBoundingClientRect().left-n.offsetWidth/2),d=!0,c=s,p=n.offsetLeft,document.body.appendChild(v.cursorOverlay)})),t},toggle(e=""){a.caller=`fontSizeSlider.toggle(${e?`'${e}'`:""})`;const t=document.getElementById(`${s.cssPrefix}-font-size-slider-track`)||v.createAppend(),o=E.querySelector(`.${s.cssPrefix}-reply-tip`),r=document.getElementById(`${s.cssPrefix}-font-size-slider-tip`);if("on"==e||!e&&"none"==t.style.display){a.debug("Showing Font Size slider...");const e=document.getElementById(`${s.cssPrefix}-font-size-btn`),n={appDiv:E.getBoundingClientRect(),btnSpan:e.getBoundingClientRect()};r.style.right=n.appDiv.right-(n.btnSpan.left+n.btnSpan.right)/2-35.5+"px",t.style.display=r.style.display="",o&&(o.style.display="none"),setTimeout((()=>t.classList.add("active")),v.fadeInDelay),a.debug("Success! Font Size slider shown")}else("off"==e||!e&&"none"!=t.style.display)&&(a.debug("Hiding Font Size slider..."),t.classList.remove("active"),o&&(o.style.display=""),r.style.display=t.style.display="none",a.debug("Success! Font Size slider hidden"))}},k={anchorMode(e=""){a.caller=`toggle.anchorMode(${e?`'${e}'`:""})`;const t=o.anchored;if("on"==e||!e&&!o.anchored?(a.debug("Toggling Anchor Mode on..."),r.save("anchored",!0),o.stickySidebar&&k.sidebar("sticky")):(a.debug("Toggling Anchor Mode off..."),r.save("anchored",!1),o.expanded&&k.expandedMode("off")),f.style.app(),f.style.tweaks(),f.chatbarWidth(),f.rqVisibility(),m.settings.get()){const e=document.querySelector('[id*="anchor"][id*="menu-entry"] input');e.checked!=o.anchored&&m.settings.toggle.switch(e)}t!=o.anchored&&(u.pin.topPos=u.pin.rightPos=null,g(`${s.msgs.mode_anchor} ${c.state.words[+o.anchored]}`),a.debug("Success! Anchor Mode toggled "+(o.anchored?"ON":"OFF")))},animations(t){a.caller=`toggle.animations('${t}')`;const s=t+"AnimationsDisabled";if(a.debug(`Toggling ${t.toUpperCase()} animations ${o[s]?"ON":"OFF"}...`),r.save(s,!o[s]),f.style.app(),"bg"==t&&(f.stars(),f.replyPrefix()),"fg"==t&&m.settings.get()){const t=document.querySelector("#about-settings-entry > span > div");t.innerHTML=m.settings.aboutContent[o.fgAnimationsDisabled?"short":"long"],t.style.float=o.fgAnimationsDisabled?"right":"","dark"==e.ui.app.scheme&&k.btnGlow()}a.caller=`toggle.animations('${t}')`,a.debug(`Success! ${t.toUpperCase()} animations toggled ${o[s]?"OFF":"ON"}`),g(`${r.controls[t+"AnimationsDisabled"].label} ${c.state.words[+!o[t+"AnimationsDisabled"]]}`)},autoGet(){if(a.caller="toggle.autoGet()",a.debug(`Toggling Auto-Get ${o.autoGet?"OFF":"ON"}...`),r.save("autoGet",!o.autoGet),E.querySelector(`.${s.cssPrefix}-standby-btn`)&&L.reply.standbyBtnClickHandler(),o.autoGet&&["prefix","suffix"].forEach((e=>{o[e+"Enabled"]&&k.manualGet(e)})),g(`${r.controls.autoGet.label} ${c.state.words[+o.autoGet]}`),m.settings.get()){const e=document.querySelector('[id*="autoGet"][id*="menu-entry"] input');e.checked!=o.autoGet&&m.settings.toggle.switch(e)}a.caller="toggle.autoGet()",a.debug(`Success! config.autoget = ${o.autoGet}`)},btnGlow(t=""){const s="off"==t||"dark"!=e.ui.app.scheme||o.fgAnimationsDisabled;document.querySelectorAll('[class*="-modal"] button').forEach(((e,t)=>{setTimeout((()=>e.classList[s?"remove":"add"]("glowing-btn")),50*(t+1)*chatgpt.randomFloat());let o=e.querySelector("span");o||(o=document.createElement("span"),o.textContent=e.textContent,e.textContent="",e.append(o)),o.classList[s?"remove":"add"]("glowing-txt")}))},expandedMode(e=""){a.caller=`toggle.expandedMode(${e?`'${e}'`:""})`;const t="on"==e||!e&&!o.expanded;a.debug(`${t?"Expanding":"Shrinking"} ${s.name}...`),r.save("expanded",t),o.minimized&&k.minimized("off"),f.style.tweaks(),f.chatbarWidth(),h.arrowsDiagonal.update(),D.style.opacity=0,a.caller=`toggle.expandedMode(${e?`'${e}'`:""})`,a.debug(`Success! ${s.name} ${t?"expanded":"shrunk"}`)},manualGet(e){a.caller=`toggle.manualGet('${e}')`;const t=e+"Enabled";if(a.debug(`Toggling ${a.toTitleCase(e)} Mode ${o[t]?"OFF":"ON"}...`),r.save(t,!o[t]),o[t]&&o.autoGet&&k.autoGet(),g(`${r.controls[t].label} ${c.state.words[+o[t]]}`),m.settings.get()){const e=document.querySelector(`[id*="${t}"][id*="menu-entry"] input`);e.checked!=o[t]&&m.settings.toggle.switch(e)}a.caller=`toggle.manualGet('${e}')`,a.debug(`Success! config.${t} = ${o[t]}`)},minimized(t=""){a.caller=`toggle.minimized(${t?`'${t}'`:""})`;const n="on"==t||!t&&!o.minimized;a.debug(`${n?"Mimizing":"Restoring"} ${s.name}...`),r.save("minimized",n);const i=E.querySelector(`#${s.cssPrefix}-chevron-btn`);if(i){const e=h["chevron"+(o.minimized?"Up":"Down")].create();i.firstChild.remove(),i.append(e),i.onclick=()=>{E.querySelector(`#${s.cssPrefix}-font-size-slider-track`)?.classList.contains("active")&&v.toggle("off"),k.minimized()}}f.appBottomPos(),e.browser.isMobile||setTimeout((()=>D.style.opacity=0),1),a.caller=`toggle.minimized(${t?`'${t}'`:""})`,a.debug(`Success! ${s.name} ${n?"minimized":"restored"}`)},proxyMode(){if(a.caller="toggle.proxyMode()",a.debug(`Toggling Proxy Mode ${o.proxyAPIenabled?"OFF":"ON"}...`),r.save("proxyAPIenabled",!o.proxyAPIenabled),g(`${s.msgs.menuLabel_proxyAPImode} ${c.state.words[+o.proxyAPIenabled]}`),c.refresh(),m.settings.get()){const e=document.querySelector('[id*="proxy"][id*="menu-entry"] input'),t=document.querySelector('[id*="streaming"][id*="menu-entry"] input');e.checked!=o.proxyAPIenabled&&m.settings.toggle.switch(e),(t.checked&&!o.proxyAPIenabled||!t.checked&&o.proxyAPIenabled&&!o.streamingDisabled)&&m.settings.toggle.switch(t)}E.querySelector(`#${s.cssPrefix}-alert`)?location.reload():(a.caller="toggle.proxyMode()",a.debug(`Success! config.proxyAPIenabled = ${o.proxyAPIenabled}`))},relatedQueries(){a.caller="toggle.relatedQueries()",a.debug(`Toggling Related Queries ${o.rqDisabled?"ON":"OFF"}...`),r.save("rqDisabled",!o.rqDisabled),f.rqVisibility(),o.rqDisabled||E.querySelector(`.${s.cssPrefix}-related-queries`)||_.related(C(G)[G.length-1].content).then((e=>L.related(e))).catch((e=>{a.error(e.message),S.tryNew(_.related)})),f.style.tweaks(),g(`${s.msgs.menuLabel_relatedQueries} ${c.state.words[+!o.rqDisabled]}`),a.debug(`Success! config.rqDisabled = ${o.rqDisabled}`)},sidebar(e,t=""){a.caller=`toggle.sidebar('${e}'${t?`, '${t}'`:""})`;const n=e+"Sidebar",i="on"==t||!t&&!o[n],l=o.stickySidebar;if(a.debug(`Toggling ${a.toTitleCase(e)} Sidebar ${i?"ON":"OFF"}`),"on"==t||!t&&!o[n]?("sticky"==e&&o.anchored&&k.anchorMode(),r.save(n,!0)):r.save(n,!1),f.style.tweaks(),f.chatbarWidth(),"wider"==e&&h.widescreen.update(),m.settings.get()){const e=document.querySelector('[id*="sticky"][id*="menu-entry"] input');e.checked!=o.stickySidebar&&m.settings.toggle.switch(e)}if("sticky"==e&&l==o.stickySidebar)return a.debug(`No change to ${a.toTitleCase(e)} Sidebar`);g(`${s.msgs[`menuLabel_${e}Sidebar`]||e.charAt(0).toUpperCase()+e.slice(1)+" Sidebar"} ${c.state.words[+o[n]]}`),a.debug(`Success! ${a.toTitleCase(e)} Sidebar toggled ${i?"ON":"OFF"}`)},streaming(){a.caller="toggle.streaming()";const t=e.browser.isFF?"https://addons.mozilla.org/firefox/addon/scriptcat/":e.browser.isEdge?"https://microsoftedge.microsoft.com/addons/detail/scriptcat/liilgpjgabokdklappibcjfablkpcekh":"https://chromewebstore.google.com/detail/scriptcat/ndcooeababalnlpkfedmmbbbgkljhpjf";if(n.byScriptManager)if(n.byBrowser)if(o.proxyAPIenabled)a.debug("Toggling Streaming Mode "+(o.streamingDisabled?"ON":"OFF")),r.save("streamingDisabled",!o.streamingDisabled),g(`${r.controls.streamingDisabled.label} ${c.state.words[+!o.streamingDisabled]}`),a.debug(`Success! config.streamingDisabled = ${o.streamingDisabled}`);else{a.debug("Streaming Mode unsupported in OpenAI mode");let e=`${r.controls.streamingDisabled.label} ${s.msgs.alert_isCurrentlyOnlyAvailBy} ${s.msgs.alert_switchingOn} ${s.msgs.mode_proxy}. (${s.msgs.alert_openAIsupportSoon}!)`;const t=s.msgs.alert_switchingOn;e=e.replace(t,`<a class="alert-link" href="#">${t}</a>`);const o=m.alert(`${s.msgs.mode_streaming} ${s.msgs.alert_unavailable}`,e);o.querySelector('[href="#"]').onclick=()=>{o.querySelector(".modal-close-btn").click(),k.proxyMode()}}else a.debug("Streaming Mode unsupported in browser"),m.alert(`${r.controls.streamingDisabled.label} ${s.msgs.alert_unavailable}`,`${r.controls.streamingDisabled.label} ${s.msgs.alert_isUnsupportedIn} ${e.browser.isChrome?"Chrome":e.browser.isEdge?"Edge":"Brave"} ${s.msgs.alert_whenUsing} Tampermonkey. ${s.msgs.alert_pleaseUse} <a target="_blank" rel="noopener" href="${t}">ScriptCat</a> ${s.msgs.alert_instead}.`);else a.debug(`Streaming Mode unsupported in ${e.scriptManager.name}`),m.alert(`${r.controls.streamingDisabled.label} ${s.msgs.alert_unavailable}`,`${r.controls.streamingDisabled.label} ${s.msgs.alert_isOnlyAvailFor}`+(e.browser.isEdge||e.browser.isBrave?"":` <a target="_blank" rel="noopener" href="https://tampermonkey.net">Tampermonkey</a> ${s.msgs.alert_and}`)+` <a target="_blank" rel="noopener" href="${t}">ScriptCat</a>.`+` (${s.msgs.alert_userscriptMgrNoStream}.)`)},tooltip(e){const t=e.currentTarget,r=/[^-]+-([\w-]+)-btn/.exec(t.id)[1];D.innerText="chevron"==r?o.minimized?`${s.msgs.tooltip_restore}`:`${s.msgs.tooltip_minimize}`:"about"==r?s.msgs.menuLabel_about:"settings"==r?s.msgs.menuLabel_settings:"speak"==r?s.msgs.tooltip_playAnswer:"font-size"==r?s.msgs.tooltip_fontSize:"wsb"==r?(o.widerSidebar?`${s.msgs.prefix_exit} `:"")+s.msgs.menuLabel_widerSidebar:"arrows"==r?o.expanded?`${s.msgs.tooltip_shrink}`:`${s.msgs.tooltip_expand}`:"copy"==r?t.firstChild.id.endsWith("copy-icon")?`${s.msgs.tooltip_copy} ${s.msgs["tooltip_"+(t.closest("code")?"code":"reply")].toLowerCase()}`:`${s.msgs.notif_copiedToClipboard}!`:"regen"==r?`${s.msgs.tooltip_regen} ${s.msgs.tooltip_reply.toLowerCase()}`:"send"==r?s.msgs.tooltip_sendReply:"shuffle"==r?s.msgs.tooltip_feelingLucky:"";const a={appDiv:E,btnElem:t,tooltipDiv:D},n={};Object.keys(a).forEach((e=>n[e]=a[e].getBoundingClientRect())),D.style.top=(["chevron","about","settings","speak","font-size","pin","wsb","arrows"].includes(r)?-14:["copy","regen"].includes(r)&&!e.currentTarget.closest("code")?43:n.btnElem.top-n.appDiv.top-35-(e.currentTarget.closest("code")?6:0))+"px",D.style.right=n.appDiv.right-(n.btnElem.left+n.btnElem.right)/2-n.tooltipDiv.width/2+"px",D.style.opacity="mouseover"==e.type?1:0}},$={deleteOpenAIcookies(){a.caller="session.deleteOpenAIcookies()",a.debug("Deleting OpenAI cookies..."),GM_deleteValue(s.configKeyPrefix+"_openAItoken"),"Tampermonkey"==e.scriptManager.name&&GM_cookie.list({url:i.OpenAI.endpoints.auth},((e,t)=>{if(!t)for(const t of e)GM_cookie.delete({url:i.OpenAI.endpoints.auth,name:t.name})}))},generateGPTFLkey(){a.caller="session.generateGPTFLkey()",a.debug("Generating GPTforLove key...");const e=(e=>{let t=CryptoJS.enc.Utf8.parse(e);return CryptoJS.AES.encrypt(t,"vrewbhjvbrejhbevwjh156645",{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).toString()})(Math.floor((new Date).getTime()/1e3));return a.debug(e),e},getOAItoken:()=>(a.caller="session.getOAItoken()",a.debug("Getting OpenAI token..."),new Promise((e=>{const o=GM_getValue(s.configKeyPrefix+"_openAItoken");o?(a.debug(o),e(o)):(a.debug(`No token found. Fetching from ${i.OpenAI.endpoints.session}...`),t({url:i.OpenAI.endpoints.session,onload:t=>{if($.isBlockedByCF(t.responseText))d("checkCloudflare");else try{const o=JSON.parse(t.responseText).accessToken;GM_setValue(s.configKeyPrefix+"_openAItoken",o),a.debug(`Success! newAccessToken = ${o}`),e(o)}catch{return void("OpenAI"==_.reply.api&&d("login"))}}}))}))),isBlockedByCF(e){try{const t=(new DOMParser).parseFromString(e,"text/html");if("Just a moment..."==t.querySelector("title").innerText)return a.caller="session.isBlockedByCF",a.debug("Blocked by CloudFlare"),!0}catch(e){return!1}}},S={clearTimedOut(e){e.splice(0,e.length,...e.filter((e=>"timeout"!=Object.values(e)[0])))},createHeaders(e){const t=ipv4.generate({verbose:!1}),s={"Accept-Encoding":"gzip, deflate, br, zstd",Connection:"keep-alive","Content-Type":"application/json",DNT:"1",Host:new URL(i[e].endpoints?.completions||i[e].endpoint).hostname,Origin:i[e].expectedOrigin.url,"Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors",TE:"trailers","X-Forwarded-For":t,"X-Real-IP":t};return s.Referer=s.Origin+"/","OpenAI"==e&&(s.Authorization="Bearer "+o.openAIkey),Object.assign(s,i[e].expectedOrigin.headers),s},createPayload(e,t){let s={};return"OpenAI"==e?s={messages:t,model:"gpt-3.5-turbo",max_tokens:4e3}:"AIchatOS"==e?s={prompt:t[t.length-1].content,withoutContext:!1,userId:i.AIchatOS.userID,network:!0}:"GPTforLove"==e?(s={prompt:t[t.length-1].content,secret:$.generateGPTFLkey(),top_p:1,temperature:.8,systemMessage:"You are ChatGPT, the version is GPT-4o, a large language model trained by OpenAI.Follow the user's instructions carefully."},i.GPTforLove.parentID&&(s.options={parentMessageId:i.GPTforLove.parentID})):"MixerBox AI"==e&&(s={prompt:t,model:"gpt-3.5-turbo"}),JSON.stringify(s)},pick(e){a.caller=`get.${e.name}() » api.pick()`;const t=Object.keys(i).filter((t=>t!=(e==_.reply?"OpenAI":"")&&!e.triedAPIs.some((e=>Object.prototype.hasOwnProperty.call(e,t)))&&(o.streamingDisabled||i[t].streamable))),s=t[Math.floor(chatgpt.randomFloat()*t.length)];return s?(a.debug("Endpoint chosen",i[s].endpoints?.completions||i[s].endpoint),s):(a.error("No proxy APIs left untried"),null)},tryNew(e,t="err"){a.caller=`get.${e.name}() » api.tryNew()`,"done"!=e.status&&(a.error(`Error using ${i[e.api].endpoints?.completions||i[e.api].endpoint} due to ${t}`),e.triedAPIs.push({[e.api]:t}),e.attemptCnt<Object.keys(i).length-+(e==_.reply)?(a.debug("Trying another endpoint..."),e.attemptCnt++,e(e==_.reply?G:_.related.query).then((t=>{e==_.related&&L.related(t)}))):(a.debug("No remaining untried endpoints"),e==_.reply&&d("proxyNotWorking","suggestOpenAI")))}};function P(e){return e+` (reply in ${o.replyLanguage})`}function C(e){const t=P.toString().match(/\+/g).length;return e.map((e=>{if("user"==e.role){let s=e.content;const o=s.match(/\s*\([^)]*\)\s*/g);if(o)for(let e=0;e<t;e++)s=s.replace(o[o.length-1-e],"");return{...e,content:s.trim()}}return e}))}const _={json(e,s){t({method:"GET",url:e,onload:e=>{if(e.status>=200&&e.status<300)try{const t=JSON.parse(e.responseText);s(null,t)}catch(e){s(e,null)}else s(new Error("Failed to load data: "+e.statusText),null)}})},async reply(e){if(_.reply.status="waiting",_.reply.triedAPIs||(_.reply.triedAPIs=[]),_.reply.attemptCnt||(_.reply.attemptCnt=1),_.reply.api=o.proxyAPIenabled?S.pick(_.reply):"OpenAI",_.reply.api){if(o.proxyAPIenabled){const e=_.reply.api;setTimeout((()=>{o.proxyAPIenabled&&"done"!=_.reply.status&&!_.reply.sender&&_.reply.api==e&&_.reply.triedAPIs.length!=Object.keys(i).length-1&&S.tryNew(_.reply,"timeout")}),o.streamingDisabled?1e4:7e3)}else o.openAIkey=await Promise.race([$.getOAItoken(),new Promise((e=>setTimeout(e,3e3)))]);t({method:i[_.reply.api].method,url:i[_.reply.api].endpoints?.completions||i[_.reply.api].endpoint,responseType:o.streamingDisabled||!o.proxyAPIenabled?"text":"stream",headers:S.createHeaders(_.reply.api),data:S.createPayload(_.reply.api,e),onload:e=>A.text(_.reply,e),onloadstart:e=>A.stream(_.reply,e),onerror:e=>{a.error(e),o.proxyAPIenabled?S.tryNew(_.reply):d(o.openAIkey?["openAInotWorking","suggestProxy"]:"login")}}),o.rqDisabled||1!=_.reply.attemptCnt||_.related(C(e)[e.length-1].content).then((e=>L.related(e))).catch((e=>{a.error(e.message),S.tryNew(_.related)})),f.footerContent()}else d("proxyNotWorking","suggestOpenAI")},async related(e){if(_.related.status="waiting",_.related.triedAPIs||(_.related.triedAPIs=[]),_.related.attemptCnt||(_.related.attemptCnt=1),_.related.api=S.pick(_.related),!_.related.api)return;"OpenAI"==_.related.api&&(o.openAIkey=await Promise.race([$.getOAItoken(),new Promise((e=>setTimeout(e,3e3)))]));const s=`Print me a numbered list of ${_.related.replyIsQuestion?"possible answers to this question":"queries related to this one"}:\n\n"${e}"\n\n`+(_.related.replyIsQuestion?"Generate answers as if in reply to a search engine chatbot asking the question.":"Make sure to suggest a variety that can even greatly deviate from the original topic. For example, if the original query asked about someone's wife,  a good related query could involve a different relative and using their name. Another example, if the query asked about a game/movie/show,  good related queries could involve pertinent characters. Another example, if the original query asked how to learn JavaScript,  good related queries could ask why/when/where instead, even replacing JS w/ other langs. But the key is variety. Do not be repetitive.  You must entice user to want to ask one of your related queries.")+` Reply in ${o.replyLanguage}`,r=_.related.api;return _.related.query=e,setTimeout((()=>{"done"!=_.related.status&&_.related.api==r&&_.related.triedAPIs.length!=Object.keys(i).length&&S.tryNew(_.related,"timeout")}),7e3),new Promise((e=>t({method:i[_.related.api].method,url:i[_.related.api].endpoints?.completions||i[_.related.api].endpoint,responseType:"text",headers:S.createHeaders(_.related.api),data:S.createPayload(_.related.api,[{role:"user",content:s}]),onload:t=>A.text(_.related,t).then(e),onerror:e=>{a.error(e),S.tryNew(_.related)}})))}},A={initFailFlags(e){const{failFlags:t=[],endpoint:s=i[e].endpoints.completions,expectedOrigin:o}=i[e],r=[s,o.url].map((e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));return new RegExp([...t,...r].join("|"))},stream(e,t){if(o.streamingDisabled||!o.proxyAPIenabled)return;a.caller=`get.${e.name}() » dataProcess.stream()`;const s=A.initFailFlags(e.api),r=t.response.getReader();let n="";r.read().then((function t({done:o,value:l}){if(o)return e.sender=null,void(E.querySelector(".loading")?S.tryNew(e):(e.status="done",e.attemptCnt=null,L.replyCornerBtns(),S.clearTimedOut(e.triedAPIs)));let c=new TextDecoder("utf8").decode(new Uint8Array(l));if("MixerBox AI"==e.api){const e=Array.from(c.matchAll(/data:(.*)/g),(e=>e[1].replace(/\[SPACE\]/g," ").replace(/\[NEWLINE\]/g,"\n"))).filter((e=>!/message_(?:start|end)|done/.test(e)));c=e.join("")}if(n=i[e.api].accumulatesText?c:n+c,!/^(?:\{|event:)/.test(n)){try{let t="";if("GPTforLove"==e.api){const e=n.split("\n"),s=JSON.parse(e[e.length-1]);s.id&&(i.GPTforLove.parentID=s.id),t=s.text}else t=n;const o=s.exec(t);if(o)return a.debug("Response text",t),a.error("Fail flag detected",`'${o[0]}'`),void("done"==e.status||e.sender||S.tryNew(e));"done"!=e.status&&(e.sender||(e.sender=e.api),e.sender==e.api&&""!=t.trim()&&L.reply(t,F))}catch(e){a.error("Error showing stream",e.message)}return r.read().then((({done:s,value:o})=>{e.sender==e.api&&t({done:s,value:o})})).catch((e=>a.error("Error reading stream",e.message)))}S.tryNew(e)})).catch((e=>a.error("Error processing stream",e.message)))},text:(e,t)=>new Promise((r=>{if(e==_.reply&&o.proxyAPIenabled&&!o.streamingDisabled||"done"==e.status)return;a.caller=`get.${e.name}() » dataProcess.text()`;const n=A.initFailFlags(e.api);let l="";if(200!=t.status)a.error("Response status",t.status),a.info("Response text",t.response||t.responseText),e==_.reply&&"OpenAI"==e.api?d(401==t.status?"login":403==t.status?"checkCloudflare":429==t.status?["tooManyRequests","suggestProxy"]:["openAInotWorking","suggestProxy"]):S.tryNew(e);else if("OpenAI"==e.api&&t.response){const s=n.exec(t.response);if(s)a.debug("Response text",t.response),a.error("Fail flag detected",`'${s[0]}'`),e==_.reply?d("openAInotWorking","suggestProxy"):S.tryNew(e);else try{l=JSON.parse(t.response).choices[0].message.content,c()}catch(e){p(e)}}else if(t.responseText){if("AIchatOS"==e.api)try{const e=t.responseText,s=1024;let o=0;for(;o<e.length;){const t=e.substring(o,o+s);l+=t,o+=s}c()}catch(e){p(e)}else if("GPTforLove"==e.api)try{let e=t.responseText.trim().split("\n"),s=JSON.parse(e[e.length-1]);s.id&&(i.GPTforLove.parentID=s.id),l=s.text,c()}catch(e){p(e)}else if("MixerBox AI"==e.api)try{const e=Array.from(t.responseText.matchAll(/data:(.*)/g),(e=>e[1].replace(/\[SPACE\]/g," ").replace(/\[NEWLINE\]/g,"\n"))).filter((e=>!/message_(?:start|end)|done/.test(e)));l=e.join(""),c()}catch(e){p(e)}}else"done"!=e.status&&(a.info("Response text",t.responseText),S.tryNew(e));function c(){if("done"!=e.status){a.debug("Response text",l);const s=n.exec(l);!l||s||/^(?:\{|event:)/.test(l)?(s&&a.error("Fail flag detected",`'${s[0]}'`),S.tryNew(e)):(e.status="done",S.clearTimedOut(e.triedAPIs),e.attemptCnt=null,e==_.reply?(L.reply(l,F),L.replyCornerBtns()):r((t=l,a.caller="dataProcess.text » arrayify()",a.debug("Arrayifying related queries..."),(t.trim().match(/^\d+\.?\s*([^\n]+?)(?=\n|\\n|$)/gm)||[]).slice(0,5).map((e=>e.replace(/\*\*/g,"").replace(/^['"]*(?:\d+\.?\s*)?['"]*(.*?)['"]*$/g,"$1"))))))}var t}function p(o){a.debug("Response text",t.response),a.error(s.alerts.parseFailed,o),"OpenAI"==e.api&&e==_.reply?d("openAInotWorking","suggestProxy"):S.tryNew(e)}}))},L={replyCornerBtns(){if(document.getElementById(`${s.cssPrefix}-copy-btn`))return;const t="float: right ; cursor: pointer ;",o=document.createElement("div");o.className=`${s.cssPrefix}-reply-corner-btns`,E.querySelector("pre").prepend(o),E.querySelectorAll(`#${s.cssPrefix} > pre, code`).forEach((r=>{const a=document.createElement("btn"),n=h.copy.create(r);a.id=`${s.cssPrefix}-copy-btn`,n.id=`${s.cssPrefix}-copy-icon`,a.className="no-mobile-tap-outline",a.style.cssText=t,a.append(n);let i=a;"CODE"==r.tagName&&(i=document.createElement("div"),i.style.cssText="height: 11px ; margin: 4px 5px 0 0",i.append(a)),e.browser.isMobile||(a.onmouseover=a.onmouseout=k.tooltip),a.onclick=t=>{const o=a.querySelector(`#${s.cssPrefix}-copy-icon`);if(!o)return;const r=("PRE"==a.parentNode.tagName?a.parentNode:a.parentNode.parentNode).textContent.replace(/^>> /,"").trim(),n=h.checkmarkDouble.create();n.style.marginLeft="1px",a.replaceChild(n,o),setTimeout((()=>a.replaceChild(o,n)),1355),navigator.clipboard.writeText(r),e.browser.isMobile||k.tooltip(t)};("CODE"==r.tagName?r:o).prepend(i)}));const r=document.createElement("btn");r.id=`${s.cssPrefix}-regen-btn`,r.className="no-mobile-tap-outline",r.style.cssText=t+"position: relative ; top: 1px ; margin: 0 9px 0 5px";const a=h.arrowsCycle.create();["width","height"].forEach((e=>a.setAttribute(e,17))),r.append(a),o.append(r),e.browser.isMobile||(r.onmouseover=r.onmouseout=k.tooltip),r.onclick=()=>{_.reply(G),d("waitingResponse"),e.browser.isMobile||(D.style.opacity=0),L.reply.chatbarFocused=!1,L.reply.userInteracted=!0}},reply(t){if(!E.querySelector("pre")){E.textContent="",y(E);const a=document.createElement("span");a.id="app-prefix",a.innerText="🤖 ",a.className="no-user-select",a.style.marginRight="-2px",a.style.fontSize=e.browser.isMobile?"1.7rem":"1.1rem",E.append(a);const C=b.googleGPT.create();C.width=e.browser.isMobile?177:e.browser.isFF?124:122,C.style.cssText=`position: relative ; top: ${e.browser.isMobile?4:e.browser.isFF?3:2}px`+(e.browser.isMobile?"; margin-left: 1px":"");const A=p.anchor(s.urls.app,C);A.classList.add(`${s.cssPrefix}-name`,"no-user-select"),E.append(A);const M=document.createElement("div");if(M.id=`${s.cssPrefix}-div-corner-btns`,M.className="no-mobile-tap-outline",E.append(M),!e.browser.isMobile){var r=document.createElement("btn"),n=h["chevron"+(o.minimized?"Up":"Down")].create();r.id=`${s.cssPrefix}-chevron-btn`,r.className=`${s.cssPrefix}-div-corner-btn`,r.style.margin="-3.5px 1px 0 11px",r.style.display="none",r.append(n),M.append(r)}const q=document.createElement("btn"),T=h.questionMarkCircle.create();q.id=`${s.cssPrefix}-about-btn`,q.className=`${s.cssPrefix}-div-corner-btn`,q.style.marginTop=(e.browser.isMobile?.25:-.15)+"rem",q.append(T),M.append(q);const z=document.createElement("btn"),I=h.cogwheel.create();if(z.id=`${s.cssPrefix}-settings-btn`,z.className=`${s.cssPrefix}-div-corner-btn`,z.style.margin=(e.browser.isMobile?4.5:-2)+"px 10px 0 2.5px",z.append(I),M.append(z),"standby"!=t){var i=document.createElement("btn"),l=h.speaker.create();i.id=`${s.cssPrefix}-speak-btn`,i.className=`${s.cssPrefix}-div-corner-btn`,i.style.margin=(e.browser.isMobile?2:-4.5)+"px 6px 0 0",i.style.opacity=0,i.append(l),M.append(i)}if("standby"!=t){var c=document.createElement("btn"),g=h.fontSize.create();c.id=`${s.cssPrefix}-font-size-btn`,c.className=`${s.cssPrefix}-div-corner-btn`,c.style.margin=(e.browser.isMobile?5:-2)+"px 9px 0 0",c.style.opacity=0,c.append(g),M.append(c)}if(!e.browser.isMobile){var m=document.createElement("btn"),x=h.pin.create();m.id=`${s.cssPrefix}-pin-btn`,m.className=`${s.cssPrefix}-div-corner-btn`,m.style.margin="-1.55px 7.5px 0 0",m.style.opacity=0,m.append(x),M.append(m);var v=document.createElement("btn"),k=h.widescreen.create();v.id=`${s.cssPrefix}-wsb-btn`,v.className=`${s.cssPrefix}-div-corner-btn`,v.style.margin="-2px 12px 0 0",v.style.opacity=0,v.append(k),M.append(v);var $=document.createElement("btn"),S=h.arrowsDiagonal.create();S.style.transform="rotate(-7deg)",$.id=`${s.cssPrefix}-arrows-btn`,$.className=`${s.cssPrefix}-div-corner-btn`,$.style.margin="-1.5px 12px 0 0",$.style.display="none",$.style.opacity=0,$.append(S),M.append($)}if(e.browser.isMobile||E.append(D),w.appDivCornerBtns(),!e.browser.isMobile){const e=document.createElement("span");e.classList.add("kudoai","no-user-select"),e.textContent="by ",e.append(p.anchor(s.urls.publisher,"KudoAI")),E.querySelector(`.${s.cssPrefix}-name`).insertAdjacentElement("afterend",e)}if("standby"==t){const e=document.createElement("button");e.classList.add(`${s.cssPrefix}-standby-btn`,"no-mobile-tap-outline"),e.textContent=s.msgs.btnLabel_sendQueryToApp||`Send search query to ${s.name}`,E.append(e),L.reply.standbyBtnClickHandler=function(){d("waitingResponse"),G.push({role:"user",content:P(new URL(location.href).searchParams.get("q"))}),L.reply.userInteracted=!0,L.reply.chatbarFocused=!1,u.pin.topPos=u.pin.rightPos=null,_.reply(G)},e.onclick=L.reply.standbyBtnClickHandler}else{const e=document.createElement("pre"),t=document.createElement("span");t.className=`${s.cssPrefix}-reply-tip`,E.append(t,e)}f.style.tweaks()}if(!E.querySelector(`#${s.cssPrefix}-chatbar`)){const o=E.querySelector("section")||document.createElement("section");o.textContent="",o.classList.remove("loading","no-user-select");const r=document.createElement("form"),a=document.createElement("div"),n=document.createElement("textarea");n.id=`${s.cssPrefix}-chatbar`,n.rows="1",n.placeholder=("standby"==t?s.msgs.placeholder_askSomethingElse:s.msgs.tooltip_sendReply)+"...",a.append(n),r.append(a),o.append(r),E.insertBefore(o,E.querySelector("footer")),["send","shuffle"].forEach((t=>{const o=document.createElement("button");o.id=`${s.cssPrefix}-${t}-btn`,o.classList.add(`${s.cssPrefix}-chatbar-btn`,"no-mobile-tap-outline"),o.style.right=("send"==t?e.browser.isFF?7:5:e.browser.isFF?7:2)+"px",o.append(h["send"==t?"arrowUp":"arrowsTwistedRight"].create()),a.append(o)}));const i=E.querySelector("footer")||document.createElement("footer");i.append(F),E.querySelector("footer")||E.append(i),w.replySection(),e.browser.isMobile&&L.reply.userInteracted&&(document.body.scrollTop=0,document.documentElement.scrollTop=0)}if("standby"!=t){const r=E.querySelector("pre");try{r.innerHTML=marked.parse(t)}catch(e){a.error(e.message)}hljs.highlightAll(),f.replyPrefix(),r.querySelectorAll("code").forEach((e=>{e.innerHTML=e.innerHTML.replace(/;\s*/g,";<br>")}));[r,...r.querySelectorAll("*")].forEach((e=>{renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})),o.stickySidebar&&f.style.tweaks(),o.autoScroll&&!e.browser.isMobile&&o.proxyAPIenabled&&!o.streamingDisabled&&(o.stickySidebar||o.anchored?r.scrollTop=r.scrollHeight:window.scrollBy({top:E.querySelector(`#${s.cssPrefix}-chatbar`).getBoundingClientRect().bottom-window.innerHeight+13}))}L.reply.chatbarFocused||e.browser.isMobile||!(!o.autoFocusChatbarDisabled&&(o.anchored||E.offsetHeight<window.innerHeight-E.getBoundingClientRect().top)||o.autoFocusChatbarDisabled&&o.anchored&&L.reply.userInteracted)||(E.querySelector(`#${s.cssPrefix}-chatbar`).focus(),L.reply.chatbarFocused=!0),o.anchored&&f.appBottomPos(),f.chatbarWidth(),L.reply.userInteracted=!1},related(e){if(a.caller="show.related()","waiting"==_.reply.status)return void setTimeout((()=>L.related(e)),500,e);const t=E.querySelector(`#${s.cssPrefix} > pre`)?.textContent.trim();if("shuffle"!=L.reply.src&&!_.related.replyIsQuestion&&/[?？]/.test(t))a.debug("Re-getting related queries to answer reply question..."),_.related.replyIsQuestion=!0,_.related(t).then((e=>L.related(e))).catch((e=>{a.error(e.message),S.tryNew(_.related)}));else if(e&&!E.querySelector(`.${s.cssPrefix}-related-queries`)){const t=document.createElement("div");t.className=`${s.cssPrefix}-related-queries`,E.append(t),e.forEach(((e,o)=>{const r=document.createElement("div"),a=h.arrowDownRight.create();r.title=s.msgs.tooltip_sendRelatedQuery,r.classList.add(`${s.cssPrefix}-related-query`,"fade-in","no-user-select","no-mobile-tap-outline"),r.setAttribute("tabindex",0),r.textContent=e,r.prepend(a),t.append(r),setTimeout((()=>{r.classList.add("active"),r.onclick=r.onkeydown=e=>{if([" ","Spacebar","Enter","Return"].includes(e.key)||[32,13].includes(e.keyCode)||"click"==e.type){e.preventDefault();const t=e.target.textContent,s=E.querySelector("textarea");s&&(s.value=t,/\[[^[\]]+\]/.test(t)?(s.focus(),w.replySection.chatbarAutoSizer(),s.setSelectionRange(t.indexOf("["),t.indexOf("]")+1)):s.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0,cancelable:!0})))}}}),100*o)})),_.related.replyIsQuestion=null,f.style.tweaks()}}};if(c.register(),location.search.includes("&udm=2"))return a.debug("Exited from Google Images");await Promise.race([new Promise((e=>{!function t(){[...document.querySelectorAll("span")].find((e=>"Dark theme"==e.textContent))?e(!0):setTimeout(t,200)}()})),new Promise((e=>setTimeout(e,500)))]),e.ui={app:{scheme:o.scheme||(x()?"dark":"light")},site:{hasSidebar:!!document.querySelector('[class*="kp-"]')}};const E=document.createElement("div");E.id=s.cssPrefix,E.classList.add("fade-in"),w.appDiv(),s.styles=p.style(),f.style.app(),document.head.append(s.styles),["brs","wrs","hljs"].forEach((e=>document.head.append(p.style(GM_getResourceText(`${e}CSS`)))));const M=p.style(),q=`#center_col, #center_col div { max-width: 516px !important ; overflow: hidden }#${s.cssPrefix} { width: 455px }#${s.cssPrefix} ~ div { width: 540px !important }`,T=`#${s.cssPrefix} { position: sticky ; top: 87px }#${s.cssPrefix} ~ * { display: none }`,z=`#${s.cssPrefix} { position: fixed ; bottom: -7px ; right: 35px ; width: 388px }[class*="feedback"], .${s.cssPrefix}-related-queries, #wsb-btn  { display: none }#${s.cssPrefix}-chevron-btn, #${s.cssPrefix}-arrows-btn { display: block !important }`,I=`#${s.cssPrefix} { width: 528px }`;if(f.style.tweaks(),document.head.append(M),!e.browser.isMobile){var D=document.createElement("div");D.classList.add(`${s.cssPrefix}-btn-tooltip`,"no-user-select"),document.head.append(p.style(`.${s.cssPrefix}-btn-tooltip {background-color: rgba(0, 0, 0, 0.64) ; padding: 6px ; border-radius: 6px ; border: 1px solid #d9d9e3 ;font-size: 0.75rem ; color: white ; fill: white ; stroke: white ;position: absolute ;box-shadow: 3px 5px 16px 0 rgb(0 0 0 / 21%) ;opacity: 0 ; transition: opacity 0.1s ; height: fit-content ; z-index: 1250 }`))}const O=document.querySelector("#center_col")||document.querySelector("#main");(e.browser.isMobile?O:document.getElementById("rhs")||(()=>{const e=document.createElement("div");return e.style.display="contents",O.style.paddingRight="65px",O.insertAdjacentElement("afterend",e),e})()).prepend(E),setTimeout((()=>E.classList.add("active")),100),document.addEventListener(l.down,(t=>{let s=t.target;for(;s&&!s.href;)s=s.parentElement;if(!s)return;s.removeAttribute("ping");const o=s.getAttribute("onmousedown");o&&/\ba?rwt\(/.test(o)&&(s.removeAttribute("onmousedown"),e.browser.isChrome&&t.stopImmediatePropagation());let r=a(s);function a(e){if(!e.protocol.startsWith("http"))return;let t;if((e.hostname.startsWith("www.google.")||e.hostname==location.hostname)&&["/url","/local_url","/searchurl/rr.html","/linkredirect"].includes(e.pathname)){if(t=/[?&](?:q|url|dest)=((?:https?|ftp)[%:][^&]+)/.exec(e.search),t)return decodeURIComponent(t[1]);if(t=/[?&](?:q|url)=((?:%2[Ff]|\/)[^&]+)/.exec(e.search),t)return e.origin+decodeURIComponent(t[1]);if(t=/[#&]url=(https?[:%][^&]+)/.exec(e.hash),t)return decodeURIComponent(t[1])}return"googleweblight.com"==e.hostname&&"/fp"==e.pathname&&(t=/[?&]u=((?:https?|ftp)[%:][^&]+)/.exec(e.search),t)?decodeURIComponent(t[1]):void 0}r&&(s.href=r,r=a(s),r&&(s.href=r))}),!0),setTimeout((()=>document.querySelectorAll('a[href^="https://www.amazon."]').forEach((e=>{const t=new URL(e.href);t.searchParams.set("tag","kudo-ai-20"),e.href=t.toString()}))),1500);let F=p.anchor("#",s.msgs.link_shareFeedback,{target:"_self"});F.onclick=()=>m.open("feedback");let G=[{role:"user",content:P(new URL(location.href).searchParams.get("q"))}];!o.autoGet&&!/src=(?:first-run|asktip)/.test(location.href)||o.prefixEnabled&&!/.*q=%2F/.test(location.href)||o.suffixEnabled&&!/.*q=.*(?:%3F|？|%EF%BC%9F)(?:&|$)/.test(location.href)?(L.reply("standby",F),o.rqDisabled||_.related(C(G)[G.length-1].content).then((e=>L.related(e))).catch((e=>{a.error(e.message),S.tryNew(_.related)}))):(d("waitingResponse"),_.reply(G));const B=new MutationObserver((()=>{const e=document.getElementById("rhs");e&&(e.prepend(E),B.disconnect())}));B.observe(document.body,{subtree:!0,childList:!0}),setTimeout((()=>B.disconnect()),5e3)})();