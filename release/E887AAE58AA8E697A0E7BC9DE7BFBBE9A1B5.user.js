// ==UserScript==
// @name         自动无缝翻页
// @name:zh-CN   自动无缝翻页
// @name:zh-TW   自動無縫翻頁
// @name:en      AutoPager
// @version      6.6.43
// @author       X.I.U
// @description  ⭐无缝加载 下一页内容 至网页底部（类似瀑布流，无限滚动，无需手动点击下一页）⭐，目前支持：【所有「Discuz!、Flarum、phpBB、MyBB、Xiuno、XenForo、NexusPHP...」论坛】【百度、谷歌(Google)、必应(Bing)、搜狗、微信、360、Yahoo、Yandex 等搜索引擎...】、贴吧、豆瓣、知乎、NGA、V2EX、起点中文、千图网、千库网、Pixabay、Pixiv、3DM、游侠网、游民星空、NexusMods、Steam 创意工坊、CS.RIN.RU、RuTracker、BT之家、萌番组、动漫花园、樱花动漫、爱恋动漫、AGE 动漫、Nyaa、SrkBT、RARBG、SubHD、423Down、不死鸟、扩展迷、小众软件、【动漫狂、动漫屋、漫画猫、漫画屋、漫画 DB、HiComic、Mangabz、Xmanhua 等漫画网站...】、PubMed、Z-Library、GreasyFork、Github、StackOverflow（以上仅一小部分常见网站，更多的写不下了...
// @description:zh-TW  ⭐無縫加載 下一頁內容 至網頁底部（類似瀑布流，无限滚动，無需手働點擊下一頁）⭐，支持各論壇、社交、遊戲、漫畫、小說、學術、搜索引擎(Google、Bing、Yahoo...) 等網站~
// @description:en  Append the next page content to the bottom seamlessly (like a waterfall, Unlimited scrolling, no need to manually click on the next page)~
// @match        *://*/*
// @connect      userscript.xiu2.xyz
// @connect      userscript.xiu2.us.kg
// @connect      userscript.h233.eu.org
// @connect      bitbucket.org
// @connect      js.cdn.haah.net
// @connect      raw.ixnic.net
// @connect      raw.nuaa.cf
// @connect      raw.yzuu.cf
// @connect      raw.kkgithub.com
// @connect      raw.incept.pw
// @connect      gitdl.cn
// @connect      ghproxy.cc
// @connect      ghproxy.net
// @connect      ghp.ci
// @connect      github.moeyy.xyz
// @connect      jsd.onmicrosoft.cn
// @connect      gcore.jsdelivr.net
// @connect      fastly.jsdelivr.net
// @connect      cdn.jsdmirror.com
// @connect      jsd.proxy.aks.moe
// @connect      jsdelivr.pai233.top
// @connect      www.xuexiniu.com
// @connect      bbs.xuexiniu.com
// @connect      weili.ooopic.com
// @connect      www.ykmh.com
// @icon         data:image/png;base64,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
// @grant        GM_xmlhttpRequest
// @grant        GM_registerMenuCommand
// @grant        GM_unregisterMenuCommand
// @grant        GM_openInTab
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_notification
// @grant        GM_info
// @grant        GM.info
// @grant        window.onurlchange
// @grant        unsafeWindow
// @sandbox      JavaScript
// @license      GPL-3.0 License
// @run-at       document-end
// @namespace    https://github.com/XIU2/UserScript
// @supportURL   https://github.com/XIU2/UserScript
// @homepageURL  https://github.com/XIU2/UserScript
// @exclude      https://*.taobao.com/*
// @exclude      https://*.tmall.com/*
// @exclude      https://*.1688.com/*
// @exclude      https://*.jd.com/*
// @exclude      https://*.vip.com/*
// @exclude      https://*.suning.com/*
// @exclude      https://*.aliexpress.com/*
// @exclude      https://*.paypal.com/*
// @exclude      https://*.iqiyi.com/*
// @exclude      https://*.youku.com/*
// @exclude      https://m.v.qq.com/*
// @exclude      https://v.qq.com/*
// @exclude      https://*.acfun.cn/*
// @exclude      https://t.bilibili.com/*
// @exclude      https://www.bilibili.com/*
// @exclude      https://live.bilibili.com/*
// @exclude      https://space.bilibili.com/*
// @exclude      https://manga.bilibili.com/*
// @exclude      https://member.bilibili.com/*
// @exclude      https://message.bilibili.com/*
// @exclude      https://*.youtube.com/*
// @exclude      https://*.youtube-nocookie.com/*
// @exclude      https://*.cnki.net/*
// @exclude      https://mail.qq.com/*
// @exclude      https://weread.qq.com/*
// @exclude      https://*.weread.qq.com/*
// @exclude      https://www.qidian.com/chapter/*
// @exclude      https://bz.zzzmh.cn/*
// @exclude      https://wallhaven.cc/*
// @exclude      https://chrome.zzzmh.cn/*
// @exclude      https://*.guazi.com/*
// @exclude      https://*.liepin.com/*
// @exclude      https://*.58.com/*
// @downloadURL https://raw.githubusercontent.com/s0uboxxx/Userscripts-GCC/release/release/E887AAE58AA8E697A0E7BC9DE7BFBBE9A1B5.user.js
// @updateURL https://raw.githubusercontent.com/s0uboxxx/Userscripts-GCC/release/release/E887AAE58AA8E697A0E7BC9DE7BFBBE9A1B5.meta.js
// ==/UserScript==
(function(){"use strict";const urlArr=["https://userscript.h233.eu.org/other/Autopage/rules.json","https://userscript.xiu2.us.kg/other/Autopage/rules.json","https://bitbucket.org/xiu2/userscript/raw/master/other/Autopage/rules.json","https://raw.kkgithub.com/XIU2/UserScript/master/other/Autopage/rules.json","https://gitdl.cn/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://raw.incept.pw/XIU2/UserScript/master/other/Autopage/rules.json","https://raw.ixnic.net/XIU2/UserScript/master/other/Autopage/rules.json","https://ghproxy.cc/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://ghproxy.net/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://ghp.ci/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://github.moeyy.xyz/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://jsd.onmicrosoft.cn/gh/XIU2/UserScript/other/Autopage/rules.json","https://fastly.jsdelivr.net/gh/XIU2/UserScript/other/Autopage/rules.json","https://cdn.jsdmirror.com/gh/XIU2/UserScript/other/Autopage/rules.json","https://jsd.proxy.aks.moe/gh/XIU2/UserScript/other/Autopage/rules.json","https://jsdelivr.pai233.top/gh/XIU2/UserScript/other/Autopage/rules.json","https://js.cdn.haah.net/gh/XIU2/UserScript/other/Autopage/rules.json"],urlArr2=["https://userscript.h233.eu.org/other/Autopage/rules.json","https://userscript.xiu2.us.kg/other/Autopage/rules.json","https://userscript.xiu2.xyz/other/Autopage/rules.json","https://bitbucket.org/xiu2/userscript/raw/master/other/Autopage/rules.json","https://raw.kkgithub.com/XIU2/UserScript/master/other/Autopage/rules.json","https://gitdl.cn/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://raw.ixnic.net/XIU2/UserScript/master/other/Autopage/rules.json","https://ghproxy.net/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://ghp.ci/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json","https://github.moeyy.xyz/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json"],loadMoreExclude1=[".smzdm.com","stackoverflow.com"],loadMoreExclude2=[".steampowered.com",".zcool.com.cn"];var menuAll=[["menu_disable","✅ 已启用 (点击对当前网站禁用)","❌ 已禁用 (点击对当前网站启用)",[]],["menu_thread","帖子内自动翻页 (社区类网站)","帖子内自动翻页 (社区类网站)",!0],["menu_page_number","显示当前页码及点击暂停翻页","显示当前页码及点击暂停翻页",!0],["menu_pause_page","左键双击网页空白处暂停翻页","左键双击网页空白处暂停翻页",!1],["menu_history","添加历史记录+修改地址/标题","添加历史记录+修改地址/标题",!0],["menu_rules","更新外置翻页规则 (每天自动)","更新外置翻页规则 (每天自动)",{}],["menu_customRules","自定义翻页规则","自定义翻页规则",{}]],menuId=[],webType=0,curSite={SiteTypeID:0},DBSite,DBSite2,DBSiteNow,pausePage=!0,pageNum={now:1,_now:1},urlC=!1,nowLocation="",lp=location.pathname,scriptHandler;window.autoPage={lp:()=>location.pathname,indexOF:indexOF,isMobile:isMobile,isUrlC:isUrlC,isPager:isPager,isTitle:isTitle,blank:forceTarget,getAll:getAll,getOne:getOne,getAllXpath:getAllXpath,getXpath:getXpath,getAllCSS:getAllCSS,getCSS:getCSS,getNextE:getNextE,getNextEP:getNextEP,getNextSP:getNextSP,getNextEPN:getNextEPN,getNextUPN:getNextUPN,getNextUP:getNextUP,getNextF:getNextF,getSearch:getSearch,getCookie:getCookie,insStyle:insStyle,insScript:insScript,cleanuEvent:cleanuEvent,src_bF:src_bF,xs_bF:xs_bF,pageNumIncrement:pageNumIncrement},scriptHandler="undefined"!=typeof GM_info?GM_info.scriptHandler:"undefined"!=typeof GM&&void 0!==GM.info?GM.info.scriptHandler:"";for(let e=0;e<menuAll.length;e++)null==GM_getValue(menuAll[e][0])&&GM_setValue(menuAll[e][0],menuAll[e][3]);function registerMenuCommand(){if(menuId.length!=[])for(let e=0;e<menuId.length;e++)GM_unregisterMenuCommand(menuId[e]);for(let e=0;e<menuAll.length;e++)if(menuAll[e][3]=GM_getValue(menuAll[e][0]),"menu_disable"===menuAll[e][0]){if(menu_disable("check"))return void(menuId[e]=GM_registerMenuCommand(`${menuAll[e][2]}`,(function(){menu_disable("del")})));if(0===(webType=doesItSupport()))return menuId[0]=GM_registerMenuCommand("❌ 当前网页暂不支持 [点击申请]",(function(){GM_openInTab("https://github.com/XIU2/UserScript#xiu2userscript",{active:!0,insert:!0,setParent:!0}),GM_openInTab("https://greasyfork.org/zh-CN/scripts/419215/feedback",{active:!0,insert:!0,setParent:!0})})),menuId[1]=GM_registerMenuCommand("🔄 更新外置翻页规则 (每天自动)",(function(){getRulesUrl(!0)})),void(menuId[2]=GM_registerMenuCommand("#️⃣ 自定义翻页规则",(function(){customRules()})));if(-1===webType)return;menuId[e]=GM_registerMenuCommand(`${menuAll[e][1]}`,(function(){menu_disable("add")}))}else"menu_rules"===menuAll[e][0]?menuId[e]=GM_registerMenuCommand(`🔄 ${menuAll[e][1]}`,(function(){getRulesUrl(!0)})):"menu_customRules"===menuAll[e][0]?menuId[e]=GM_registerMenuCommand(`#️⃣ ${menuAll[e][1]}`,(function(){customRules()})):menuId[e]=GM_registerMenuCommand(`${menuAll[e][3]?"✅":"❌"} ${menuAll[e][1]}`,(function(){menu_switch(menuAll[e][3],menuAll[e][0],menuAll[e][2])}));menuId[menuId.length]=GM_registerMenuCommand("💬 反馈失效 / 申请支持",(function(){GM_openInTab("https://github.com/XIU2/UserScript#xiu2userscript",{active:!0,insert:!0,setParent:!0}),GM_openInTab("https://greasyfork.org/zh-CN/scripts/419215/feedback",{active:!0,insert:!0,setParent:!0})}))}function doesItSupport(){setDBSite();let e=!1;e:for(let t in DBSite)if(!DBSite[t].ignore)if(DBSiteNow=DBSite[t],Array.isArray(DBSite[t].host)){for(let n of DBSite[t].host)if("string"==typeof n&&"/"===n.slice(0,1)&&(n=new RegExp(n.slice(1,n.length-1))),n instanceof RegExp&&n.test(location.hostname)||"string"==typeof n&&n===location.hostname){if(self!=top&&!DBSite[t].iframe)continue e;if(DBSite[t].url)if("function"==typeof DBSite[t].url)DBSite[t].url();else try{if("/"===DBSite[t].url.slice(0,1)){if(!0!==new RegExp(DBSite[t].url.slice(1,DBSite[t].url.length-1),"i").test(location.pathname+location.search)){!0===urlC&&(e=!0);break}curSite=DBSite[t]}else{if(!new Function("fun",DBSite[t].url)(window.autoPage)){!0===urlC&&(e=!0);break}curSite=DBSite[t]}}catch(e){console.error('[自动无缝翻页] - 当前网页规则 "url" 匹配出错，请检查：\n',DBSite[t].url+"\n\n",e)}else curSite=DBSite[t];e=!0;break e}}else if("string"==typeof DBSite[t].host&&"/"===DBSite[t].host.slice(0,1)&&(DBSite[t].host=new RegExp(DBSite[t].host.slice(1,DBSite[t].host.length-1))),void 0===DBSite[t].host||DBSite[t].host instanceof RegExp&&DBSite[t].host.test(location.hostname)||"string"==typeof DBSite[t].host&&DBSite[t].host===location.hostname){if(self!=top&&!DBSite[t].iframe)continue;if(DBSite[t].url)if("function"==typeof DBSite[t].url)DBSite[t].url();else try{if("/"===DBSite[t].url.slice(0,1)){if(!0!==new RegExp(DBSite[t].url.slice(1,DBSite[t].url.length-1),"i").test(location.pathname+location.search)){!0===urlC&&(e=!0);continue}curSite=DBSite[t]}else{if(!new Function("fun",DBSite[t].url)(window.autoPage)){!0===urlC&&(e=!0);continue}curSite=DBSite[t]}}catch(e){console.error('[自动无缝翻页] - 当前网页规则 "url" 匹配出错，请检查：\n',DBSite[t].url+"\n\n",e)}else curSite=DBSite[t];e=!0;break}if(DBSiteNow=void 0,e)return console.info("[自动无缝翻页] - 独立规则 网站"),1;if(self!=top)return-1;if("undefined"!=typeof discuz_uid||getCSS('meta[name="author" i][content*="Discuz!" i], meta[name="generator" i][content*="Discuz!" i], body[id="nv_forum" i][class^="pg_" i][onkeydown*="27"], body[id="nv_search" i][onkeydown*="27"]')||getXpath('id("ft")[contains(string(),"Discuz!")]'))return console.info("[自动无缝翻页] - <Discuz!> 论坛"),2;if("undefined"!=typeof flarum||getCSS("#flarum-loading"))return console.info("[自动无缝翻页] - <Flarum> 论坛"),3;if("undefined"!=typeof phpbb||getCSS("body#phpbb"))return console.info("[自动无缝翻页] - <phpBB> 论坛"),4;if("undefined"!=typeof xn&&getXpath('//footer//a[contains(string(), "Xiuno")] | //link[contains(@href, "xiuno")] | //script[contains(@src, "xiuno")]'))return console.info("[自动无缝翻页] - <Xiuno> 论坛"),5;if("undefined"!=typeof XF)return console.info("[自动无缝翻页] - <XenForo> 论坛"),6;if("undefined"!=typeof MyBB)return console.info("[自动无缝翻页] - <MyBB> 论坛"),14;if(getCSS('head meta[name="generator" i][content="nexusphp" i]')||getXpath('id("footer")[contains(string(), "NexusPHP")]'))return console.info("[自动无缝翻页] - <NexusPHP> 论坛"),7;if(unsafeWindow.config&&(unsafeWindow.config.assetVersionEncoded&&-1!==unsafeWindow.config.assetVersionEncoded.indexOf("gitea")||unsafeWindow.config.customEmojis&&unsafeWindow.config.customEmojis.gitea))return console.info("[自动无缝翻页] - <Forgejo/Gitea> git 托管系统"),15;if(loadMoreExclude(loadMoreExclude1)&&1===getAllCSS('.load-more, .load_more, .loadmore, #load-more, #load_more, #loadmore, [id^="loadmore"], .show-more, .show_more, .ajax-more').length)return console.info("[自动无缝翻页] - 部分自带 自动无缝翻页 的网站 1"),8;if(loadMoreExclude(loadMoreExclude2)&&1===getAllXpath('//*[self::a or self::span or self::button or self::div][text()="加载更多"][not(@href) or @href="#" or starts-with(@href, "javascript")]').length)return console.info("[自动无缝翻页] - 部分自带 自动无缝翻页 的网站 2"),9;if(getCSS('link[href*="/wp-content/" i], script[src*="/wp-content/" i], link[href*="/wp-includes/" i], script[src*="/wp-includes/" i], head>meta[name=generator][content*="WordPress" i]')){if(getXpath('(//*[contains(@class, "post-page-numbers") and contains(@class, "current")])[last()]/following-sibling::a[1]')?(DBSite.wp_article_post.pager.nextL='(//*[contains(@class, "post-page-numbers") and contains(@class, "current")])[last()]/following-sibling::a[1]',DBSite.wp_article_post.pager.replaceE='//a[contains(@class,"post-page-numbers")]/..'):getXpath('(//div[contains(@class,"fenye")])[last()]//a[string()="下一页"]')&&(DBSite.wp_article_post.pager.nextL='(//div[contains(@class,"fenye")])[last()]//a[string()="下一页"]',DBSite.wp_article_post.pager.replaceE=".fenye"),null!=DBSite.wp_article_post.pager.nextL)return 1==getAllCSS("#entry-content>#content-innerText, .entry-content>#content-innerText").length?DBSite.wp_article_post.pager.pageE="#entry-content>#content-innerText, .entry-content>#content-innerText":getAllCSS(".entry-content .single-content img").length>3?DBSite.wp_article_post.pager.pageE=".entry-content .single-content":1==getAllCSS(".entry-content").length?DBSite.wp_article_post.pager.pageE=".entry-content>*:not(.wbp-cbm):not(.page-links):not(.post-links):not(.article-paging):not(.entry-pagination):not(.pagination):not(.fenye):not(.open-message):not(#social):not(.article-social):not(.single-cat-tag):not(.single-meta):not(#fontsize):not(.clear):not(.tg-m):not(.tg-site):not(footer)":1==getAllCSS(".article-content").length?DBSite.wp_article_post.pager.pageE=".article-content>*:not(.page-links):not(.post-links):not(.article-paging):not(.entry-pagination):not(.pagination):not(.fenye):not(.open-message):not(#social):not(.article-social):not(.single-cat-tag):not(.single-meta):not(#fontsize):not(.clear):not(.tg-m):not(.tg-site):not(footer)":1==getAllCSS("article").length&&(DBSite.wp_article_post.pager.pageE="article>*:not(.page-links):not(.post-links):not(.article-paging):not(.entry-pagination):not(.pagination):not(.fenye):not(.open-message):not(#social):not(.article-social):not(.single-cat-tag):not(.single-meta):not(#fontsize):not(.clear):not(.tg-m):not(.tg-site):not(footer)"),null!=DBSite.wp_article_post.pager.pageE&&console.info("[自动无缝翻页] - 部分使用 WordPress 的网站 - 文章内"),11;if(getCSS("a.next, a.next-page"))DBSite.wp_article.pager.nextL="a.next, a.next-page";else if(getCSS('a[rel="next" i], a[aria-label="next" i], a[aria-label="下一个"].page-link, a[aria-label="Next Page" i], a[aria-label="下一页"], a[rel="下一页"], a[title="下一页"], a[aria-label="下一頁"], a[rel="下一頁"], a[title="下一頁"]'))DBSite.wp_article.pager.nextL='a[rel="next" i], a[aria-label="next" i], a[aria-label="下一个"].page-link, a[aria-label="Next Page" i], a[aria-label="下一页"], a[rel="下一页"], a[title="下一页"], a[aria-label="下一頁"], a[rel="下一頁"], a[title="下一頁"]';else if(getCSS("li.next-page > a, li.next > a, li.pagination-next>a"))DBSite.wp_article.pager.nextL="li.next-page > a, li.next > a, li.pagination-next>a";else if(getCSS("span.current+a"))DBSite.wp_article.pager.nextL="span.current+a";else if(getCSS(".nav-previous a, a.nav-previous"))DBSite.wp_article.pager.nextL=".nav-previous a, a.nav-previous";else if(getCSS(".pagination>.page-item.active+li.page-item>a"))DBSite.wp_article.pager.nextL=".pagination>.page-item.active+li.page-item>a";else{const e=getCSS('#nav-below, nav.navigation, nav.paging-navigation, #pagination:not([class*="entry"]), .pagination:not([class*="entry"]), .wp-pagenavi, .pagenavi, nav[role="navigation"]');e&&getXpath('//a[contains(text(), "下一页") or contains(text(), "下一頁") or contains(text(), ">") or contains(text(), "next") or contains(text(), "Next") or contains(text(), "NEXT")]',e)&&(DBSite.wp_article.pager.nextL='//*[self::ul or self::nav or self::div][@id="nav-below" or @id="pagination" or contains(@class, "navigation") or contains(@class, "pagination") or contains(@class, "pagenavi") or @role="navigation"]//a[contains(text(), "下一页") or contains(text(), "下一頁") or contains(text(), ">") or contains(text(), "next") or contains(text(), "Next") or contains(text(), "NEXT")]')}if(null!=DBSite.wp_article.pager.nextL){if(0!==DBSite.wp_article.pager.nextL.indexOf("//")&&(DBSite.wp_article.pager.replaceE+=","+DBSite.wp_article.pager.nextL),1==getAllCSS("main").length&&(getAllCSS("main .posts-wrapper.row>div>article").length>3?DBSite.wp_article.pager.pageE="main .posts-wrapper.row>div":getAllXpath('//main//div[contains(@class,"row")]/div/article').length>3?DBSite.wp_article.pager.pageE='//main//div[contains(@class,"row")]/div/article/parent::div':getAllCSS('main article[id^="post-"]').length>3?DBSite.wp_article.pager.pageE='main article[id^="post-"]':getAllCSS("main article[class]").length>3?DBSite.wp_article.pager.pageE="main article[class]":getAllCSS('main div[id^="post-"]').length>3?DBSite.wp_article.pager.pageE='main div[id^="post-"]':getAllCSS("main .post").length>3&&(DBSite.wp_article.pager.pageE="main .post"),null!=DBSite.wp_article.pager.pageE))return console.info("[自动无缝翻页] - 部分使用 WordPress 的网站"),10;if(getAllCSS(".posts-wrapper.row>div>article").length>3?DBSite.wp_article.pager.pageE=".posts-wrapper.row>div":getAllXpath('//div[contains(@class,"row")]/div/article').length>3?DBSite.wp_article.pager.pageE='//div[contains(@class,"row")]/div/article/parent::div':getAllCSS('article[id^="post-"]').length>3?DBSite.wp_article.pager.pageE='article[id^="post-"]':getAllCSS("article[class]").length>3?DBSite.wp_article.pager.pageE="article[class]":getAllCSS('div[id^="post-"]').length>3?DBSite.wp_article.pager.pageE='div[id^="post-"]':getAllCSS('ul[class*="post"]>li.item').length>3?DBSite.wp_article.pager.pageE='ul[class*="post"]>li.item':getAllCSS(".post").length>3?DBSite.wp_article.pager.pageE=".post":getAllCSS('.posts-row>posts[class*="post"]').length>3?DBSite.wp_article.pager.pageE='.posts-row>posts[class*="post"]':1==getAllCSS("#posts, .posts").length?DBSite.wp_article.pager.pageE="#posts, .posts":1==getAllCSS("#content .container>.row").length&&1==getAllCSS("#content .container>.row+.nav-pagination").length&&(DBSite.wp_article.pager.pageE="#content .container>.row"),null!=DBSite.wp_article.pager.pageE)return console.info("[自动无缝翻页] - 部分使用 WordPress 的网站"),10}}else{if(getCSS('meta[name="template" i][content="handsome" i]')&&getCSS(".page-navigator"))return console.info("[自动无缝翻页] - 部分使用 Typecho 的网站 (handsome)"),12;if(getCSS('meta[name="template" i][content="Mirages" i]')&&getCSS(".page-navigator"))return console.info("[自动无缝翻页] - 部分使用 Typecho 的网站 (Mirages)"),13;if(getCSS(".stui-page, .stui-page__item, #long-page, .myui-page, .myui-page__item"))return console.info("[自动无缝翻页] - 部分影视网站"),300;if(getCSS("#page")&&getCSS(".module-items,a.module-poster-item"))return console.info("[自动无缝翻页] - 部分影视网站 2"),301;if(getCSS(".ArticleImageBox, .PictureList")&&getCSS(".article_page")&&getXpath('//div[contains(@class,"article_page")]//a[text()="下一页"]'))return console.info("[自动无缝翻页] - 部分美女图站 - 手机版"),302;if(getCSS("meta[content^=SearXNG i], link[href*=SearXNG i], script[src*=SearXNG i]"))return console.info("[自动无缝翻页] - <SearXNG> 元搜索引擎"),303;if(getCSS(".content > #content")&&getXpath('//div[contains(@class,"page_chapter")]//a[text()="下一章"]'))return console.info("[自动无缝翻页] - <笔趣阁 1> 模板的小说网站"),200;if(getCSS("#nr1, #chaptercontent, .Readarea, .ReadAjax_content")&&getCSS("#pb_next, #linkNext"))return console.info("[自动无缝翻页] - <笔趣阁 1 - 手机版> 模板的小说网站"),201;if(getCSS("#txt, .txt")&&getCSS("#pb_next, .url_next")&&getCSS(".chapter-control, .chapter-page-btn"))return console.info("[自动无缝翻页] - <笔趣阁 2> 模板的小说网站"),202;if((getCSS('meta[name="description" i][content*="小说"], meta[name="description" i][content*="章节"], meta[name="description" i][content*="阅读"], meta[name="keywords" i][content*="笔趣"]')||-1!=location.hostname.indexOf("biqu")||null!=document.title.match(/笔趣阁|小说|章/))&&getXpath('//a[contains(text(), "下一章") or contains(text(), "下一页") or contains(text(), "下一节")]')){let e=['[id="chapter_content" i]','[class~="chapter_content" i]','[id="chaptercontent" i]','[class~="chaptercontent" i]','[id="booktext" i]','[class~="booktext" i]','[id="txtcontent" i]','[class~="txtcontent" i]','[id="textcontent" i]','[class~="textcontent" i]','[id="read-content" i]','[class~="read-content" i]','[id="txtnav" i]','[class~="txtnav" i]','[id="txt" i][class~="txt" i]','[id="contents" i]','[class~="contents" i]','[id="content" i]','[class~="content" i]'];for(let t of e)if(1===getAllCSS(t).length){DBSite.biquge3.pager.pageE=t,DBSite.biquge3.pager.insertP=[t,6],DBSite.biquge3.style=t+">.readinline, "+DBSite.biquge3.style;break}if(null!=DBSite.biquge3.pager.pageE)return console.info("[自动无缝翻页] - <笔趣阁 3> 模板的小说网站"),203}}return 0}function webTypeIf(){if(1!=webType)switch(webType){case 2:discuz_();break;case 3:DBSite.flarum.url();break;case 4:DBSite.phpbb.url();break;case 5:DBSite.xiuno.url();break;case 6:DBSite.xenforo.url();break;case 14:DBSite.mybb.url();break;case 7:DBSite.nexusphp.url();break;case 15:DBSite.forgejoGitea.url();break;case 8:DBSite.loadmore.url('.load-more, .load_more, .loadmore, #load-more, #load_more, #loadmore, [id^="loadmore"], .show-more, .show_more, .ajax-more');break;case 9:DBSite.loadmore.url('//*[self::a or self::span or self::button or self::div][text()="加载更多"][not(@href) or @href="#" or starts-with(@href, "javascript")]');break;case 10:DBSite.wp_article.url();break;case 11:curSite=DBSite.wp_article_post;break;case 12:DBSite.typecho_handsome.url();break;case 13:DBSite.typecho_mirages.url();break;case 200:DBSite.biquge1.url();break;case 201:curSite=DBSite.biquge1_m;break;case 202:DBSite.biquge2.url();break;case 203:curSite=DBSite.biquge3;break;case 300:curSite=DBSite.yingshi;break;case 301:curSite=DBSite.yingshi2;break;case 302:curSite=DBSite.meinvtu_m;break;case 303:document.cookie="infinite_scroll=1; expires=Thu, 18 Dec 2031 12:00:00 GMT; path=/",document.cookie="results_on_new_tab=1; expires=Thu, 18 Dec 2031 12:00:00 GMT; path=/"}}function setDBSite(){DBSite={loadmore:{ignore:!0,url:function(e){(curSite=DBSite.loadmore).pager.nextL=e},pager:{type:2,isHidden:!0,interval:1e3}},wp_article:{ignore:!0,url:()=>{indexOF("/post/")||getCSS("#comments, .comments-area, #disqus_thread")||(curSite=DBSite.wp_article,setTimeout((()=>{-1!=getOne(curSite.pager.pageE).style.cssText.indexOf("position: absolute")&&insStyle(curSite.pager.pageE+"{position: static !important; float: left !important; height: "+parseInt(1.1*getCSS(curSite.pager.pageE).offsetHeight)+"px !important;}")}),1500))},style:"img[data-src], img[data-original] {opacity: 1 !important;}",blank:3,pager:{replaceE:'#nav-below, nav.navigation, nav.paging-navigation, #pagination:not([class*="entry"]), .pagination:not([class*="entry"]), .wp-pagenavi, .pagenavi, nav[role="navigation"], ul[class*="-pagination"]',forceHTTPS:!0,scrollD:3e3},function:{bF:src_bF}},wp_article_post:{ignore:!0,pager:{type:3,scrollD:3e3},function:{bF:src_bF}},typecho_handsome:{ignore:!0,url:()=>{getCSS("nav:not([id=comment-navigation]) .page-navigator")&&(curSite=DBSite.typecho_handsome)},blank:3,pager:{nextL:".page-navigator li.next>a",pageE:".blog-post, .post-list",replaceE:".page-navigator"}},typecho_mirages:{ignore:!0,url:()=>{getAllCSS("#index>article, #archive>article").length>3&&getCSS("li.next")&&(curSite=DBSite.typecho_mirages)},blank:3,pager:{nextL:"li.next>a",pageE:"#index>article, #archive>article",scriptT:3,replaceE:".page-navigator"}},biquge1:{ignore:!0,url:()=>{curSite=DBSite.biquge1,xs_bF(getAllCSS(".content > #content"),[/<br>.{0,10}秒记住.+$/,""])},style:'img, .posterror, a[href*="posterror()"], [style*="background"][style*="url("]:not(html):not(body), #content > *:not(br):not(p), #content>.readinline {display: none !important;}',history:!0,retry:3e3,pager:{nextL:'//div[@class="page_chapter"]//a[text()="下一章"]',pageE:".content > #content",insertP:[".content > #content",6],replaceE:".page_chapter"},function:{bF:xs_bF,bFp:[/<br>.{0,10}秒记住.+$/,""]}},biquge1_m:{ignore:!0,style:'img, .posterror, .show-app2, a[href*="posterror()"], [onclick*="location.href"], [style*="background"][style*="url("]:not(html):not(body), #nr1>*:not(br):not(p), #chaptercontent>*:not(br):not(p), .Readarea>*:not(br):not(p), .ReadAjax_content>*:not(br):not(p), #nr1>.readinline, #chaptercontent>.readinline, .Readarea>.readinline, .ReadAjax_content>.readinline {display: none !important;}',history:!0,retry:3e3,pager:{nextL:"#pb_next, #linkNext",pageE:"#nr1, #chaptercontent, .Readarea, .ReadAjax_content",insertP:["#nr1, #chaptercontent, .Readarea, .ReadAjax_content",6],replaceE:'//a[@id="pb_next" or @id="linkNext"]/parent::*'}},biquge2:{ignore:!0,url:()=>{curSite=isMobile()||null!=getCSS(".chapter-page-btn")?DBSite.biquge2_m:DBSite.biquge2},style:'img, .posterror, a[href*="posterror()"], [style*="background"][style*="url("]:not(html):not(body), #txt > *:not(br):not(p), #txt>.readinline, .txt>.readinline {display: none !important;}',history:!0,retry:3e3,pager:{type:6,nextL:"#pb_next, .url_next",pageE:"#txt, .txt",insertP:["#txt, .txt",6],replaceE:".chapter-control, .chapter-page-btn",loadTime:1500,scrollD:3500}},biquge2_m:{ignore:!0,style:'img, .posterror, a[href*="posterror()"], [style*="background"][style*="url("]:not(html):not(body), #txt > *:not(br):not(p), #txt>.readinline, .txt>.readinline {display: none !important;}',history:!0,retry:3e3,pager:{nextL:"#pb_next, .url_next",pageE:"#txt, .txt",insertP:["#txt, .txt",6],replaceE:".chapter-control, .chapter-page-btn"}},biquge3:{ignore:!0,style:'img, .posterror, a[href*="posterror()"], [style*="background"][style*="url("]:not(html):not(body), script+div[style="padding:15px;"], p[style*="font-weight:"] {display: none !important;}',history:!0,retry:3e3,pager:{nextL:"js; const a=[fun.getNextE('//a[contains(text(), \"下一页\")]'),fun.getNextE('//a[contains(text(), \"下一章\")]'),fun.getNextE('//a[contains(text(), \"下一节\")]')];if (a[0]){return a[0];}else if(a[1]){return a[1];}else if(a[2]){return a[2];}",insertP6Br:!1,replaceE:'//a[contains(text(), "下一章") or contains(text(), "下一页") or contains(text(), "下一节")]/parent::*'},function:{bF:xs_bF,bFp:[/<br>.{0,10}秒记住.+$/,""]}},yingshi:{ignore:!0,style:"div.stui-page__all, div.myui-page__all {display: none !important;}",blank:3,pager:{nextL:".stui-page li.active+li>a, .stui-page__item li.active+li>a, #long-page .active+li>a, .myui-page .visible-xs+li>a",pageE:".stui-vodlist, .myui-vodlist>li, #content, #searchList",replaceE:".stui-page, .stui-page__item, #long-page, .myui-page, .myui-page__item"},function:{bF:src_bF,bFp:[1,"[data-original]","data-original"]}},yingshi2:{ignore:!0,blank:3,style:".module-poster-item, .module-items>* {display: inline-block !important;}",pager:{nextL:'#page a[title="下一页"], a.page-next',pageE:".module-items>*, a.module-poster-item",replaceE:"#page"},function:{bF:src_bF}},meinvtu_m:{ignore:!0,history:!0,blank:3,pager:{type:3,nextL:'//div[contains(@class,"article_page")]//a[text()="下一页"]',pageE:".ArticleImageBox, .PictureList",replaceE:".article_page",scrollD:500}},discuz_forum:{ignore:!0,pager:{type:2,nextL:"#autopbn",interval:800}},discuz_guide:{ignore:!0,pager:{nextL:'a.nxt:not([href^="javascript"]) ,a.next:not([href^="javascript"])',pageE:'tbody[id^="normalthread_"]',replaceE:".pg, .pages",forceHTTPS:!0}},discuz_waterfall:{ignore:!0,style:".pgbtn",pager:{nextL:'a.nxt:not([href^="javascript"]) ,a.next:not([href^="javascript"])',pageE:"#waterfall > li, #waterfall > dl",replaceE:".pg, .pages",forceHTTPS:!0}},discuz_thread:{ignore:!0,thread:!0,style:".pgbtn, .viewthread:not(:first-of-type)>h1, .viewthread:not(:first-of-type)>ins, .viewthread:not(:first-of-type)>.headactions {display: none;}",pager:{nextL:'a.nxt:not([href^="javascript"]) ,a.next:not([href^="javascript"])',pageE:'#postlist > div[id^="post_"], form>.viewthread',replaceE:'//div[contains(@class,"pg") or contains(@class,"pages")][./a[contains(@class,"nxt") or contains(@class,"next") or contains(@class,"prev")][not(contains(@href,"javascript") or contains(@href,"commentmore"))]]',forceHTTPS:!0},function:{bF:src_bF,bFp:[0,"img[file]","file"]}},discuz_search:{ignore:!0,pager:{nextL:'a.nxt:not([href^="javascript"]) ,a.next:not([href^="javascript"])',pageE:"#threadlist > ul",replaceE:".pg, .pages",forceHTTPS:!0}},discuz_youspace:{ignore:!0,pager:{nextL:'a.nxt:not([href^="javascript"]) ,a.next:not([href^="javascript"])',pageE:'form:not([action^="search.php?"]) tbody > tr:not(.th)',replaceE:".pg, .pages",forceHTTPS:!0}},discuz_collection:{ignore:!0,pager:{nextL:'a.nxt:not([href^="javascript"]) ,a.next:not([href^="javascript"])',pageE:"#ct .bm_c table > tbody",replaceE:".pg, .pages",forceHTTPS:!0}},discuz_archiver:{ignore:!0,pager:{nextL:'//div[@id="content"][last()]//div[@class="page"]/strong/following-sibling::a[1]',pageE:"#content"}},discuz_m:{ignore:!0,thread:!0,pager:{nextL:'//a[@class="nxt" or @class="next"] | //div[@class="page"]/a[text()="下一页" or contains(text(), ">")]',replaceE:".pg, .page",forceHTTPS:!0,scrollD:1e3}},discuz_m_forum:{ignore:!0,pager:{type:2,nextL:"a.loadmore",interval:500,scrollD:1e3}},flarum:{ignore:!0,url:()=>{urlC=!0,indexOF("/d/")||(getCSS(".DiscussionList-loadMore")?curSite=DBSite.flarum:getCSS("a.Button--primary")&&(curSite=DBSite.flarum2))},pager:{type:2,nextL:".DiscussionList-loadMore > button",isHidden:!0}},flarum2:{ignore:!0,blank:4,pager:{type:6,nextL:"a.Button--primary+a:not(.disabled)",pageE:".DiscussionList-discussions>li",replaceE:".Orion-DiscussionListPagination"}},phpbb:{ignore:!0,url:()=>{indexOF("/viewforum.php")?curSite=DBSite.phpbb:indexOF("/viewtopic.php")?curSite=DBSite.phpbb_post:indexOF("/search.php")&&(curSite=DBSite.phpbb_search)},pager:{nextL:'.pagination li.next a[rel="next"], .topic-actions .pagination strong~a',pageE:".forumbg:not(.announcement) ul.topiclist.topics > li",replaceE:".action-bar .pagination, .topic-actions .pagination"}},phpbb_post:{ignore:!0,thread:!0,pager:{nextL:'.pagination li.next a[rel="next"], .topic-actions .pagination strong~a',pageE:"div.post[id], div.post[id]+hr",replaceE:".action-bar .pagination, .topic-actions .pagination"}},phpbb_search:{ignore:!0,pager:{nextL:'.pagination li.next a[rel="next"], .topic-actions .pagination strong~a',pageE:"div.search.post",replaceE:".action-bar .pagination, .pagination"}},xenforo:{ignore:!0,url:()=>{indexOF(/\/(forums|f)\//)||getCSS(DBSite.xenforo.pager.nextL)&&getCSS(DBSite.xenforo.pager.pageE)?curSite=DBSite.xenforo:indexOF(/\/(threads|t)\//)||getCSS(DBSite.xenforo.pager.nextL)&&getCSS(DBSite.xenforo_post.pager.pageE)?curSite=DBSite.xenforo_post:(indexOF("/search/")||getCSS(DBSite.xenforo.pager.nextL)&&getCSS(DBSite.xenforo_search.pager.pageE))&&(curSite=DBSite.xenforo_search)},pager:{nextL:"a.pageNav-jump--next",pageE:".structItemContainer-group.js-threadList > div",replaceE:"nav.pageNavWrapper",scrollD:2500}},xenforo_post:{ignore:!0,thread:!0,pager:{nextL:"a.pageNav-jump--next",pageE:".block-body.js-replyNewMessageContainer > article",replaceE:"nav.pageNavWrapper",scrollD:2500}},xenforo_search:{ignore:!0,pager:{nextL:"a.pageNav-jump--next",pageE:"ol.block-body > li",replaceE:"nav.pageNavWrapper",scrollD:2500}},mybb:{ignore:!0,url:()=>{0==location.pathname.toLowerCase().indexOf("/forum")||0==location.pathname.toLowerCase().indexOf("/search")||getCSS(DBSite.mybb.pager.nextL)&&getCSS(DBSite.mybb.pager.pageE)?curSite=DBSite.mybb:(-1!==location.pathname.toLowerCase().indexOf("thread")||getCSS(DBSite.mybb.pager.nextL)&&getCSS(DBSite.mybb_post.pager.pageE))&&((curSite=DBSite.mybb_post).pager=Object.assign({},DBSite.mybb.pager,DBSite.mybb_post.pager))},blank:3,pager:{nextL:"div:not([id=breadcrumb_multipage_popup])>a.pagination_next, div:not([id=breadcrumb_multipage_popup])>.pagination_current+a.pagination_page",pageE:"tr.inline_row",replaceE:".pagination",scrollD:2500}},mybb_post:{ignore:!0,thread:!0,pager:{pageE:"#posts>*",scrollD:2500}},xiuno:{ignore:!0,url:()=>{"/"==lp||indexOF(/\/(index|forum)/)?curSite=DBSite.xiuno:indexOF("/thread")&&(curSite=DBSite.xiuno_post)},pager:{nextL:'//li[@class="page-item"]/a[text()="▶" or text()="»" or contains(text(),">") or contains(text(),"下一页")]',pageE:"ul.threadlist > li",replaceE:"ul.pagination"}},xiuno_post:{ignore:!0,thread:!0,pager:{nextL:'//li[@class="page-item"]/a[text()="▶" or text()="»" or contains(text(),">") or contains(text(),"下一页")]',pageE:"li.post[data-pid]:not(.newpost)",replaceE:"ul.pagination"}},forgejoGitea:{ignore:!0,url:()=>{(indexOF(/^\/explore\/.+/)||indexOF(/\/(issues|pulls|releases|tags)$/)||indexOF(/\/commits\/branch\/.+/)||getCSS(".pagination>.active+.item")&&getCSS(".flex-list>.flex-item"))&&(curSite=DBSite.forgejoGitea)},pager:{nextL:".pagination>.active+.item",pageE:".flex-list>.flex-item, #issue-list>div, #release-list>li, tbody.tag-list>tr, tbody.commit-list>tr",replaceE:".pagination"}},nexusphp:{ignore:!0,url:()=>{"/torrents.php"==lp||getCSS("table.torrents")?curSite=DBSite.nexusphp:"/subtitles.php"==lp?(curSite=DBSite.nexusphp).pager.pageE="#outer > table.main~table > tbody > tr:not(:first-of-type)":"/forums.php"==lp&&indexOF("action=viewforum","s")?(curSite=DBSite.nexusphp).pager.pageE="#outer > table.main+table > tbody > tr:not(:first-of-type):not(:last-of-type)":"/forums.php"==lp&&indexOF("action=viewtopic","s")&&((curSite=DBSite.nexusphp).thread=!0,curSite.pager.pageE="td.text > div, td.text > div+table.main")},pager:{nextL:'//a[./b[contains(text(), "下一页") or contains(text(), ">>")]]',pageE:"table.torrents > tbody > tr:not(:first-of-type)",replaceE:'//p[@align][./font[@class="gray"]]'}},nexusmods:{host:"www.nexusmods.com",url:()=>{urlC=!0,indexOF(/\/(mods|users)\/\d+/)?indexOF("tab=posts","s")?curSite=DBSite.nexusmods_posts:indexOF("tab=user+files","s")&&(curSite=DBSite.nexusmods):"/"!==lp&&getCSS(".pagination a.page-selected")&&(curSite=DBSite.nexusmods)},blank:1,history:!1,xRequestedWith:!0,pager:{nextL:nexusmods_nextL,pageE:"ul.tiles>li",replaceE:".pagination",scrollD:3500},function:{bF:nexusmods_bF}},nexusmods_posts:{ignore:!0,history:!1,xRequestedWith:!0,pager:{nextL:nexusmods_nextL,pageE:"#comment-container>ol>li.comment:not(.comment-sticky)",replaceE:".pagination",scrollD:3500}},mangabz:{host:["mangabz.com","www.mangabz.com"],url:()=>{indexOF(/\/m\d+/)?(setTimeout(mangabz_init,1500),curSite=DBSite.mangabz):indexOF(/\/\d+bz\//)?getCSS(".detail-list-form-more")&&getCSS(".detail-list-form-more").click():(indexOF("/manga-list")||"/search"==lp)&&(curSite=DBSite.mangabz_list)},style:"body > .container > div:not([id]) {display: none !important;} .top-bar {opacity: 0.3 !important;} #cp_img > img{display: block !important;margin: 0 auto !important; max-width: 99% !important; width: auto !important; height: auto !important;}",pager:{type:4,nextL:mangabz_nextL,insertP:["#cp_img",3],insertE:mangabz_insertE,replaceE:"p.top-title, body > .container > div:not([id])",interval:500}},mangabz_list:{ignore:!0,blank:4,pager:{nextL:'//div[contains(@class,"page-pagination")]//a[contains(text(), ">")]',pageE:"ul.mh-list > li",replaceE:".page-pagination",scrollD:800}},dm5:{host:"www.dm5.com",url:()=>{indexOF(/\/m\d+/)?(setTimeout(mangabz_init,1500),curSite=DBSite.dm5):indexOF("/manga-list")||"/search"==lp||getCSS(".box-body > ul.mh-list > li")?curSite=DBSite.mangabz_list:getCSS(".detail-more")&&getCSS(".detail-more").click()},style:".view-paging > .container, .view-comment {display: none !important;} .rightToolBar {opacity: 0.3 !important;} #cp_img > img, #barChapter > img{display: block !important;margin: 0 auto !important; max-width: 99% !important; width: auto !important; height: auto !important;} body {overflow: auto !important;}",pager:{type:4,nextL:dm5_nextL,insertP:["#barChapter,#cp_img",3],insertE:dm5_insertE,replaceE:".view-paging > .container, .rightToolBar",interval:500}},xmanhua:{host:["xmanhua.com","www.xmanhua.com","yymanhua.com","www.yymanhua.com"],url:()=>{indexOF(/\/m\d+/)?(setTimeout(mangabz_init,1500),-1!=location.hostname.indexOf("xmanhua")?unsafeWindow.MH_PREFIX23="XMANHUA_":unsafeWindow.MH_PREFIX23="YYMANHUA_",curSite=DBSite.xmanhua):indexOF(/\/\d+xm\//)?getCSS(".detail-list-form-more")&&getCSS(".detail-list-form-more").click():(indexOF("/manga-list")||"/search"==lp)&&(curSite=DBSite.xmanhua_list)},style:"a.reader-bottom-page {display: none !important;} .header, .reader-bottom {opacity: 0.3 !important;} #cp_img > img{display: block !important;margin: 0 auto !important; max-width: 99% !important; width: auto !important; height: auto !important;}",hiddenPN:!0,pager:{type:4,nextL:xmanhua_nextL,insertP:["#cp_img",3],insertE:xmanhua_insertE,replaceE:".reader-title, body > .container > div:not([id])",interval:500,scrollD:2500}},xmanhua_list:{ignore:!0,blank:4,pager:{nextL:'//div[@class="page-pagination"]//a[contains(text(), ">")]',pageE:"ul.mh-list > li",replaceE:".page-pagination",scrollD:1e3}}};let e=GM_getValue("menu_customRules",{}),t=GM_getValue("menu_rules",{});"[object Object]"!==Object.prototype.toString.call(e)&&(e={}),"[object Object]"!==Object.prototype.toString.call(t)&&(t={});let n=Object.keys(e),i=Object.keys(t);if(0===n.length)DBSite=Object.assign({},t,DBSite),DBSite2=structuredClone(t);else{for(let r=0;r<n.length;r++)-1!=i.indexOf(n[r])&&(!0===e[n[r]].inherits&&(null!=e[n[r]].pager&&null!=t[n[r]].pager&&(e[n[r]].pager=Object.assign({},t[n[r]].pager,e[n[r]].pager)),e[n[r]]=Object.assign({},t[n[r]],e[n[r]])),delete t[n[r]]);DBSite=Object.assign({},e,t,DBSite),DBSite2=Object.assign({},structuredClone(e),structuredClone(t))}setSiteTypeID()}function getRulesUrl(e=!1){function t(e=!1,t){void 0!==(t=e?urlArr2[Math.floor(Math.random()*urlArr2.length)]:urlArr[Math.floor(Math.random()*urlArr.length)])?GM_xmlhttpRequest({url:t,method:"GET",responseType:"json",overrideMimeType:"application/json; charset=utf-8",timeout:4e3,onload:function(n){try{200===n.status&&n.response&&"[object Object]"===Object.prototype.toString.call(n.response)&&Object.keys(n.response).length>100?(GM_setValue("menu_rules",n.response),GM_setValue("menu_ruleUpdateTime",parseInt(+new Date/1e3)),curSite={SiteTypeID:0},pageNum.now=1,registerMenuCommand(),webTypeIf(),GM_getValue("menu_thread")||curSite.thread&&(curSite={SiteTypeID:0},pageNum.now=1),GM_getValue("menu_page_number")?pageNumber("add"):pageNumber("set"),null!=curSite.blank&&setTimeout(forceTarget,1e3),curSite.style&&insStyle(curSite.style),pausePageEvent(),pageLoading(),e&&GM_notification({text:"✅ 已更新外置翻页规则！\n如果依然无法翻页，说明还不支持当前网页，点击此处提交申请~",timeout:5e3,onclick:function(){GM_openInTab("https://github.com/XIU2/UserScript#xiu2userscript",{active:!0,insert:!0,setParent:!0}),GM_openInTab("https://greasyfork.org/zh-CN/scripts/419215/feedback",{active:!0,insert:!0,setParent:!0})}})):(console.log("URL："+t,n),GM_notification({text:"❌ 为空！更新失败，请再试几次...\n如果依然更新失败，请联系作者解决...",timeout:5e3}),e?urlArr2.splice(urlArr2.indexOf(t),1):urlArr.splice(urlArr.indexOf(t),1))}catch(n){console.log("URL："+t,n),GM_notification({text:"❌ 报错！更新失败，请再试几次...\n如果依然更新失败，请联系作者解决...",timeout:5e3}),e?urlArr2.splice(urlArr2.indexOf(t),1):urlArr.splice(urlArr.indexOf(t),1)}},onerror:function(n){console.log("URL："+t,n),GM_notification({text:"❌ 错误！更新失败，请再试几次...\n如果依然更新失败，请联系作者解决...",timeout:5e3}),e?urlArr2.splice(urlArr2.indexOf(t),1):urlArr.splice(urlArr.indexOf(t),1)},ontimeout:function(n){console.log("URL："+t,n),GM_notification({text:"❌ 超时！更新失败，请再试几次...\n如果依然更新失败，请联系作者解决...",timeout:5e3}),e?urlArr2.splice(urlArr2.indexOf(t),1):urlArr.splice(urlArr.indexOf(t),1)}}):GM_notification({text:"❌ 所有更新地址均以试过，已无可用地址，请联系作者解决...",timeout:5e3})}"string"==typeof GM_getValue("menu_ruleUpdateTime","")&&(e=!0,"AdGuard"!=scriptHandler?alert("请点击【确定】开始首次获取【外置翻页规则】（大概几秒\n\n在此期间请不要 操作/跳转/关闭 当前网页~\n\n如果不小心没获取成功也没事，可以去脚本菜单中手动【更新外置翻页规则】即可（浏览器右上角 Tampermonkey 扩展图标内的脚本菜单\n\n\n另外，想要【临时暂停翻页】请点击左下角悬浮的【页码】按钮\n\n如果每次打开网页都会看到该提示，说明你的 油猴脚本管理器与本脚本之间 存在兼容性问题，请更换其他试试！"):urlArr2=urlArr),e?(GM_notification({text:"🔄 更新外置翻页规则中，请勿操作网页...",timeout:5e3}),t(!0)):parseInt(+new Date/1e3)-GM_getValue("menu_ruleUpdateTime",0)>5184e3&&t()}function discuzForum(e){"m"==e?(getCSS("a.loadmore")?curSite=DBSite.discuz_m_forum:getCSS(".threadlist")?(curSite=DBSite.discuz_m).pager.pageE=".threadlist > ul > li":getCSS('[id^="normalthread_"]')&&((curSite=DBSite.discuz_m).pager.pageE='[id^="normalthread_"]:not(.ZDlist)'),0!==curSite.SiteTypeID&&"keylol.com"===location.hostname&&(curSite.history=!1,urlC=!0)):getCSS("#autopbn")?curSite=DBSite.discuz_forum:getCSS("#waterfall")?getCSS("#pgbtn.pgbtn>a[href^=javascript]")||(curSite=DBSite.discuz_waterfall,waterfallStyle()):curSite=DBSite.discuz_guide}function discuzThreadM(){getCSS('[id^="pid"]')?(curSite=DBSite.discuz_m).pager.pageE='[id^="pid"], [id^="pid"]+div:not([id="post_new"])':getCSS('[id^="post_"]')&&((curSite=DBSite.discuz_m).pager.pageE='[id^="post_"]'),0!==curSite.SiteTypeID&&"keylol.com"===location.hostname&&(curSite.history=!1,urlC=!0)}function discuz_(){if(getCSS('body[id="nv_forum"][class^="pg_"][onkeydown*="27"]'))switch(getCSS('body[id="nv_forum"][class^="pg_"][onkeydown*="27"]').className){case"pg_forumdisplay":discuzForum();break;case"pg_viewthread":curSite=DBSite.discuz_thread;break;case"pg_guide":curSite=DBSite.discuz_guide;break;case"pg_collection":curSite=DBSite.discuz_collection}0===curSite.SiteTypeID&&(indexOF("search")||getCSS('body[id="nv_search"][onkeydown*="27"]'))&&(indexOF("mobile=2","s")?((curSite=DBSite.discuz_m).pager.pageE=".threadlist > ul > li",urlC=!0):curSite=DBSite.discuz_search),0===curSite.SiteTypeID&&(indexOF(".html")&&(indexOF("/forum-")?getXpath('//head/meta[@name="applicable-device" and @content="mobile"] | //head/title[contains(text(), "手机版")] | //head/link[contains(@href, "/mobile/")] | //head/script[contains(@src, "/mobile/")]')?discuzForum("m"):discuzForum():indexOF("/thread-")&&(getXpath('//head/meta[@name="applicable-device" and @content="mobile"] | //head/title[contains(text(), "手机版")] | //head/link[contains(@href, "/mobile/")] | //head/script[contains(@src, "/mobile/")]')?discuzThreadM():curSite=DBSite.discuz_thread)),indexOF("/archiver/")&&(curSite=DBSite.discuz_archiver)),0===curSite.SiteTypeID&&(indexOF("mod=forumdisplay","s")||indexOF("forumdisplay.php")?indexOF("mobile=2","s")||indexOF("mobile=yes","s")||getXpath('//head/meta[@name="applicable-device" and @content="mobile"] | //head/title[contains(text(), "手机版")] | //head/link[contains(@href, "/mobile/")] | //head/script[contains(@src, "/mobile/")]')?discuzForum("m"):discuzForum():indexOF("mod=viewthread","s")||indexOF("viewthread.php")?indexOF("mobile=2","s")||getXpath('//head/meta[@name="applicable-device" and @content="mobile"] | //head/title[contains(text(), "手机版")] | //head/link[contains(@href, "/mobile/")] | //head/script[contains(@src, "/mobile/")]')?discuzThreadM():curSite=DBSite.discuz_thread:indexOF("mod=guide","s")?curSite=DBSite.discuz_guide:indexOF("mod=space","s")&&indexOF("do=thread","s")?curSite=DBSite.discuz_youspace:indexOF("mod=collection","s")?curSite=DBSite.discuz_collection:getCSS('#threadlist, tbody[id^="normalthread_"]')?discuzForum():getCSS("#postlist, form>.viewthread")?curSite=DBSite.discuz_thread:isMobile()&&(discuzForum("m"),0===curSite.SiteTypeID&&discuzThreadM()))}function waterfallStyle(){let e=getCSS("#waterfall > li:first-child");e&&e.style&&e.style.width?insStyle(`#waterfall {height: auto !important; width: 100% !important;} #waterfall > li {width: ${e.style.width} !important; float: left !important; position: inherit !important; left: auto !important; top: auto !important;}`):(e=getAllCSS("#waterfall > dl"),e&&e.length>5&&insStyle("#waterfall > dl {display: unset !important;}"))}function nexusmods_nextL(){if(getCSS(".nexus-ui-blocker")||!getCSS(".pagination a.page-selected"))return;let e;if(e=indexOF("/news")?RH_NewsTabContent:indexOF("/users/")&&indexOF("tab=user+files","s")?RH_UserModsTab:indexOF("/mods/")&&indexOF("tab=posts","s")?RH_CommentContainer:RH_ModList,!e)return;let t=JSON.stringify(e.out_items).replace(/{|}|"/g,""),n=getXpath('//div[contains(@class, "pagination")][1]//a[contains(@class, "page-selected")]/../following-sibling::li[1]/a');if(n&&n.innerText){if(n=n.innerText,t.indexOf("page:")>-1?t=t.replace(/page:\d+/,`page:${n}`):t+=`,page:${n}`,!indexOF(/\/(mods|users)\/\d+/)){let n=e.out_items.categories,i=e.out_items.tags_yes,r=e.out_items.search,a="";if(n&&n!=[]){if(e.out_items.categories instanceof Array)for(let e=0;e<n.length;e++)a+=`categories[]:${n[e]},`;else for(let t in e.out_items.categories)a+=`categories[${t}]:${e.out_items.categories[t]},`;t.indexOf("categories:")>-1&&(t=t.replace("categories:",a))}if(a="",i&&i!=[]){if(e.out_items.tags_yes instanceof Array)for(let e=0;e<i.length;e++)a+=`tags_yes[]:${i[e]},`;else for(let t in e.out_items.tags_yes)a+=`tags_yes[${t}]:${e.out_items.tags_yes[t]},`;t.indexOf("tags_yes:")>-1&&(t=t.replace("tags_yes:",a))}if(a="",r&&0!=r.length){for(let t in e.out_items.search)a+=`search[${t}]:${e.out_items.search[t]},`;t.indexOf("search:")>-1&&(t=t.replace("search:",a))}a=""}return`https://www.nexusmods.com${e.uri}?RH_${e.id}=${t}`}return""}function nexusmods_bF(e){return e.forEach((function(e){let t=e.querySelector(".mod-tile-left");if(t){let e=t.querySelector(".downloadcount > span.flex-label");e&&GlobalModStats[t.dataset.gameId]&&GlobalModStats[t.dataset.gameId][t.dataset.modId]&&(e.textContent=shortFormat(parseInt(GlobalModStats[t.dataset.gameId][t.dataset.modId].total)))}})),e}function mangabz_init(){getCSS("#showimage")&&getCSS("#showimage").removeAttribute("oncontextmenu"),getCSS("#cp_img")&&getCSS("#cp_img").removeAttribute("oncontextmenu"),getCSS("#barChapter")&&getCSS("#barChapter").removeAttribute("oncontextmenu"),getCSS("#cp_image")&&(getCSS("#cp_image").removeAttribute("oncontextmenu"),getCSS("#cp_image").removeAttribute("style"),getCSS("#cp_image").removeAttribute("id"))}function mangabz_nextL(){var e="";if(MANGABZ_PAGE===MANGABZ_IMAGE_COUNT)getNextE_('//a[./img[contains(@src, "icon_xiayizhang")]]')&&getPageE_(curSite.pageUrl);else{if(!t)var t="";if((e=location.origin+location.pathname+"chapterimage.ashx"+`?cid=${MANGABZ_CID}&page=${MANGABZ_PAGE+1}&key=${t}&_cid=${MANGABZ_CID}&_mid=${MANGABZ_MID}&_dt=${MANGABZ_VIEWSIGN_DT}&_sign=${MANGABZ_VIEWSIGN}`)===curSite.pageUrl)return;curSite.pageUrl=e,getPageE_(curSite.pageUrl,"text","GET","","Next")}}function mangabz_insertE(pageE,type){if(pageE)if("Next"===type){let imgArr=eval(pageE),_img="";for(let e of imgArr)_img+=`<img src="${e}">`;_img&&(getOne(curSite.pager.insertP[0]).insertAdjacentHTML(getAddTo(curSite.pager.insertP[1]),_img),MANGABZ_PAGE+=imgArr.length,addHistory(pageE,document.title,location.origin+MANGABZ_CURL.substring(0,MANGABZ_CURL.length-1)+"-p"+MANGABZ_PAGE+"/"))}else insScript("html:not([dir]) > head > script:not([src])",pageE),addHistory(pageE),pageNumIncrement(),replaceElems(pageE),MANGABZ_PAGE=0,mangabz_nextL()}function dm5_nextL(){var e="";if(DM5_PAGE===DM5_IMAGE_COUNT)getNextE_('//div[@class="view-paging"]//a[text()="下一章"]')&&getPageE_(curSite.pageUrl);else{if(!t)var t="";if((e=location.origin+location.pathname+"chapterfun.ashx"+`?cid=${DM5_CID}&page=${DM5_PAGE+1}&key=${t}&language=1&gtk=6&_cid=${DM5_CID}&_mid=${DM5_MID}&_dt=${DM5_VIEWSIGN_DT}&_sign=${DM5_VIEWSIGN}`)===curSite.pageUrl)return;curSite.pageUrl=e,getPageE_(curSite.pageUrl,"text","GET","","Next")}}function dm5_insertE(pageE,type){if(pageE)if("Next"===type){let imgArr=eval(pageE),_img="";for(let e of imgArr)_img+=`<img src="${e}">`;_img&&(getOne(curSite.pager.insertP[0]).insertAdjacentHTML(getAddTo(curSite.pager.insertP[1]),_img),DM5_PAGE+=imgArr.length,addHistory(pageE,document.title,location.origin+DM5_CURL.substring(0,DM5_CURL.length-1)+"-p"+DM5_PAGE+"/"))}else insScript("html:not([dir])>head>script:not([src])",pageE),addHistory(pageE),pageNumIncrement(),replaceElems(pageE),DM5_PAGE=0,dm5_nextL()}function xmanhua_nextL(){var e="";if(unsafeWindow[unsafeWindow.MH_PREFIX23+"PAGE"]===unsafeWindow[unsafeWindow.MH_PREFIX23+"IMAGE_COUNT"])getNextE_('//a[./img[contains(@src, "reader-bottom-right-2.png")]]')&&getPageE_(curSite.pageUrl);else{if(!t)var t="";if((e=location.origin+location.pathname+"chapterimage.ashx"+`?cid=${unsafeWindow[unsafeWindow.MH_PREFIX23+"CID"]}&page=${unsafeWindow[unsafeWindow.MH_PREFIX23+"PAGE"]+1}&key=${t}&_cid=${unsafeWindow[unsafeWindow.MH_PREFIX23+"_CID"]}&_mid=${unsafeWindow[unsafeWindow.MH_PREFIX23+"MID"]}&_dt=${unsafeWindow[unsafeWindow.MH_PREFIX23+"VIEWSIGN_DT"]}&_sign=${unsafeWindow[unsafeWindow.MH_PREFIX23+"VIEWSIGN"]}`)===curSite.pageUrl)return;curSite.pageUrl=e,getPageE_(curSite.pageUrl,"text","GET","","Next")}}function xmanhua_insertE(pageE,type){if(pageE)if("Next"===type){let imgArr=eval(pageE),_img="";for(let e of imgArr)_img+=`<img src="${e}">`;_img&&(getOne(curSite.pager.insertP[0]).insertAdjacentHTML(getAddTo(curSite.pager.insertP[1]),_img),unsafeWindow[unsafeWindow.MH_PREFIX23+"PAGE"]+=imgArr.length,addHistory(pageE,document.title,location.origin+unsafeWindow[unsafeWindow.MH_PREFIX23+"CURL"].substring(0,unsafeWindow[unsafeWindow.MH_PREFIX23+"CURL"].length-1)+"-p"+unsafeWindow[unsafeWindow.MH_PREFIX23+"PAGE"]+"/"))}else insScript("html:not([dir]) > head > script:not([src])",pageE),addHistory(pageE),pageNumIncrement(),replaceElems(pageE),unsafeWindow[unsafeWindow.MH_PREFIX23+"PAGE"]=0,xmanhua_nextL()}function pageLoading(){function e(){curSite.pager.interval&&(pausePage=!1,setTimeout((function(){pausePage=!0}),curSite.pager.interval))}0!==curSite.SiteTypeID&&curSite.pager&&(void 0===curSite.pager.type&&(curSite.pager.type=1),void 0===curSite.pager.scrollD&&(curSite.pager.scrollD=2e3),void 0===curSite.pager.interval&&(curSite.pager.interval=500),curSite.pageUrl="",windowScroll((function(t,n){if("down"!=t||!pausePage||0==curSite.SiteTypeID)return;if(5==curSite.pager.type&&self!=top&&0==window.top.document.xiu_pausePage)return;let i=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,r=window.innerHeight||document.documentElement.clientHeight,a=curSite.pager.scrollD;if(3===curSite.pager.type){curSite.pager.scrollE||(curSite.pager.scrollE=curSite.pager.replaceE),getOne(curSite.pager.scrollE).offsetTop-(i+r)<=a&&(e(),checkURL(getPageE))}else if(document.documentElement.scrollHeight<=r+i+a)if(1===curSite.pager.type)e(),checkURL(getPageE);else if(2===curSite.pager.type){let t=getOne(curSite.pager.nextL);if(!t)return;if(curSite.pager.isHidden&&isHidden(t))return;curSite.pager.nextText?t.innerText===curSite.pager.nextText&&(t.click(),pageNumIncrement()):curSite.pager.nextTextOf?t.innerText.indexOf(curSite.pager.nextTextOf)>-1&&(t.click(),pageNumIncrement()):curSite.pager.nextHTML?t.innerHTML===curSite.pager.nextHTML&&(t.click(),pageNumIncrement()):(e(),t.click(),pageNumIncrement())}else 4===curSite.pager.type?(e(),"function"==typeof curSite.pager.nextL?curSite.pager.nextL():getNextE_(curSite.pager.nextL)&&getPageE_(curSite.pageUrl)):5===curSite.pager.type?checkURL(insIframe):6===curSite.pager.type&&checkURL(insIframe_)})))}function getPageE(e){if(curSite.gmxhr)GM_xmlhttpRequest({url:e,method:"GET",overrideMimeType:"text/html; charset="+(document.characterSet||document.charset||document.inputEncoding),headers:{"x-requested-with":!0===curSite.xRequestedWith?"XMLHttpRequest":null,Referer:!0===curSite.noReferer?null:location.href,Accept:"text/html,application/xhtml+xml,application/xml"},timeout:5e3,onload:function(t){try{processElems(createDocumentByString(t.responseText))}catch(n){console.error("[自动无缝翻页] - 处理获取到的下一页内容时出现问题，请检查！\n",n,"\nURL："+e,"\n最终 URL："+t.finalUrl,"\n返回状态："+t.statusText,"\n返回内容："+t.responseText)}},onerror:function(t){console.log("URL："+e,t),GM_notification({text:"❌ 获取下一页失败...",timeout:5e3})},ontimeout:function(t){setTimeout((function(){curSite.pageUrl=""}),3e3),console.log("URL："+e,t),GM_notification({text:"❌ 获取下一页超时，可 3 秒后再次滚动网页重试（或尝试刷新网页）...",timeout:5e3})}});else{const t=new XMLHttpRequest;t.open("GET",e,!0),t.overrideMimeType("text/html; charset="+(document.characterSet||document.charset||document.inputEncoding)),!0===curSite.xRequestedWith&&t.setRequestHeader("x-requested-with","XMLHttpRequest"),t.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml"),t.timeout=5e3,t.onload=function(){try{processElems(createDocumentByString(t.responseText))}catch(n){console.error("[自动无缝翻页] - 处理获取到的下一页内容时出现问题，请检查！\n",n,"\nURL："+e,"\n最终 URL："+t.responseURL,"\n返回状态："+t.statusText,"\n返回内容："+t.responseText)}},t.onerror=function(){console.log("URL："+e,t.statusText),GM_notification({text:"❌ 获取下一页失败...",timeout:5e3})},t.ontimeout=function(){setTimeout((function(){curSite.pageUrl=""}),3e3),console.log("URL："+e,t.statusText),GM_notification({text:"❌ 获取下一页超时，可 3 秒后再次滚动网页重试（或尝试刷新网页）...",timeout:5e3})},t.send()}}function getPageE_(e,t="",n="GET",i="",r){let a,o;switch(t){case"json":o="application/json",a="application/json; charset="+(document.characterSet||document.charset||document.inputEncoding);break;case"text":o="text/plain",a="text/plain; charset="+(document.characterSet||document.charset||document.inputEncoding);break;default:o="text/html,application/xhtml+xml,application/xml",a="text/html; charset="+(document.characterSet||document.charset||document.inputEncoding)}GM_xmlhttpRequest({url:e,method:n,data:i,responseType:t,overrideMimeType:a,headers:{Referer:!0===curSite.noReferer?null:location.href,"Content-Type":"POST"===n?"application/x-www-form-urlencoded":"",Accept:o},timeout:5e3,onload:function(e){try{switch(t){case"json":curSite.pager.insertE(e.response,r);break;case"text":curSite.pager.insertE(e.responseText,r);break;default:curSite.pager.insertE(createDocumentByString(e.responseText),r)}}catch(e){console.log(e)}},onerror:function(t){setTimeout((function(){curSite.pageUrl=""}),3e3),console.log("URL："+e,t),GM_notification({text:"❌ 获取下一页失败，可 3 秒后再次滚动网页重试（或尝试刷新网页）...",timeout:5e3})},ontimeout:function(t){setTimeout((function(){curSite.pageUrl=""}),3e3),console.log("URL："+e,t),GM_notification({text:"❌ 获取下一页超时，可 3 秒后再次滚动网页重试（或尝试刷新网页）...",timeout:5e3})}})}function insIframe(e){if(0==curSite.SiteTypeID)return;curSite.SiteTypeID=0;let t=document.createElement("iframe");t.id="Autopage_iframe",t.src=e.replace(/#.+$/,""),document.documentElement.appendChild(document.createElement("style")).textContent="iframe#Autopage_iframe {position: absolute !important; width: 100% !important; height: 100% !important; border: none !important;}";var n=document.documentElement.scrollTop||document.body.scrollTop;window.addEventListener("scroll",(function(){let e=document.documentElement.scrollTop||document.body.scrollTop,i=document.documentElement.clientHeight||document.body.clientHeight,r=document.documentElement.scrollHeight||document.body.scrollHeight,a=document.documentElement.scrollTop||document.body.scrollTop,o=a-n;if(0==o)return!1;if(n=a,o>0&&e+i+10>=r&&!getCSS("#Autopage_iframe-scroll")){let e=document.createElement("style");e.id="Autopage_iframe-scroll",e.textContent="html::-webkit-scrollbar, body::-webkit-scrollbar {width: 0 !important;height: 0 !important;} html, body {scrollbar-width: none !important;}",curSite.pager.style&&(e.textContent+=curSite.pager.style),document.documentElement.appendChild(e),t.contentWindow.document.querySelectorAll("#Autopage_iframe-scroll-hidden")&&t.contentWindow.document.querySelectorAll("#Autopage_iframe-scroll-hidden").forEach((e=>{e.remove()})),t.focus(),t.contentWindow.document.body&&(t.contentWindow.document.body.focus(),t.contentWindow.document.body.click())}else if(o<0&&e+i+10<=r&&getCSS("#Autopage_iframe-scroll")&&(getCSS("#Autopage_iframe-scroll").remove(),!t.contentWindow.document.getElementById("Autopage_iframe-scroll-hidden"))){let e=document.createElement("style");e.id="Autopage_iframe-scroll-hidden",e.textContent="html, body {overflow: hidden !important;}",t.contentWindow.document.documentElement.appendChild(e)}}),!1),t.onload=function(){if(!getCSS("#Autopage_iframe-scroll")&&!t.contentWindow.document.getElementById("Autopage_iframe-scroll-hidden")){let e=document.createElement("style");e.id="Autopage_iframe-scroll-hidden",e.textContent="html, body {overflow: hidden !important;}",t.contentWindow.document.documentElement.appendChild(e)}if(void 0===curSite.history?GM_getValue("menu_history",!0)&&addHistory(t.contentWindow.document,t.contentWindow.document.title):curSite.history&&addHistory(t.contentWindow.document,t.contentWindow.document.title),!curSite.hiddenPN){getCSS("#Autopage_number",window.top.document)&&pageNumIncrement()}},"www.cocomanga.com"==location.hostname?document.body.appendChild(t):document.documentElement.appendChild(t)}function insIframe_(e){if(!pausePage)return;pausePage=!1;let t=document.getElementById("Autopage_iframe");t||(t=document.createElement("iframe"),t.id="Autopage_iframe",t.src=e.replace(/#.+$/,""),document.documentElement.appendChild(document.createElement("style")).textContent="iframe#Autopage_iframe {position: absolute !important; top: -9999px !important; left: -9999px !important; width: 100% !important; height: 100% !important; border: none !important; z-index: -999 !important;}"),t.onload=function(){curSite.pager.loadTime||(curSite.pager.loadTime=300);let e=0,n=setInterval((function(){let i=(t.contentWindow.document.documentElement.scrollHeight||t.contentWindow.document.body.scrollHeight)/10;t.contentWindow.scrollTo(0,999999),t.contentWindow.scrollTo(0,i*e),10==++e&&(clearInterval(n),processElems(t.contentWindow.document),pausePage=!0)}),curSite.pager.loadTime/10)},document.getElementById("Autopage_iframe")?t.src=e.replace(/#.+$/,""):document.documentElement.appendChild(t)}function processElems(e){curSite.pager.insertP||(curSite.pager.insertP=[curSite.pager.pageE,5]);let t,n=getAll(curSite.pager.pageE,e,e);if(t=5===curSite.pager.insertP[1]?toE5pop(getAll(curSite.pager.insertP[0])):getOne(curSite.pager.insertP[0]),n.length>0&&t){curSite.function&&curSite.function.bF&&(n=curSite.function.bFp?"string"==typeof curSite.function.bF?new Function("pageE","bFp","fun",curSite.function.bF)(n,curSite.function.bFp,window.autoPage):curSite.function.bF(n,curSite.function.bFp):"string"==typeof curSite.function.bF?new Function("pageE","fun",curSite.function.bF)(n,window.autoPage):curSite.function.bF(n)),4!==curSite.blank&&5!==curSite.blank&&6!==curSite.blank||(n=forceTarget(n));let i=getAddTo(curSite.pager.insertP[1]);if(6===curSite.pager.insertP[1]){let r="";if(!1===curSite.pager.insertP6Br){if(!0===unsafeWindow.insertP6Br)r+="<br/><br/>";else if(void 0===unsafeWindow.insertP6Br&&getAll("br",getOne(curSite.pager.pageE)).length>10){function a(e){const t=Array.from(e.childNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE&&""!==e.textContent.trim())),n=t[t.length-1];return"BR"===n.tagName||!("P"!==n.tagName||!n.classList.contains("readinline"))&&"BR"===t[t.length-2].tagName}a(getOne(curSite.pager.pageE))?unsafeWindow.insertP6Br=!1:(unsafeWindow.insertP6Br=!0,r+="<br/><br/>")}}else curSite.pager.insertP6Br&&(r+="<br/><br/>");n.forEach((function(e){r+=e.innerHTML})),t.insertAdjacentHTML(i,r)}else 2!==curSite.pager.insertP[1]&&4!==curSite.pager.insertP[1]&&5!==curSite.pager.insertP[1]||n.reverse(),n.forEach((function(e){t.insertAdjacentElement(i,e)}));if(pageNumIncrement(),void 0===curSite.history?GM_getValue("menu_history",!0)&&addHistory(e):curSite.history&&addHistory(e),""!==curSite.pager.replaceE&&replaceElems(e),curSite.pager.scriptT||0==curSite.pager.scriptT)switch(curSite.pager.scriptT){case 0:insScript("script",e);break;case 1:insScript("script:not([src])",e);break;case 2:2!==curSite.pager.insertP[1]&&4!==curSite.pager.insertP[1]&&5!==curSite.pager.insertP[1]||n.reverse(),insScript(null,n);break;case 3:2!==curSite.pager.insertP[1]&&4!==curSite.pager.insertP[1]&&5!==curSite.pager.insertP[1]||n.reverse(),insScript("script:not([src])",n)}curSite.function&&curSite.function.aF&&(curSite.function.aFp?"string"==typeof curSite.function.aF?new Function("aFp","fun",curSite.function.aF)(curSite.function.aFp,window.autoPage):curSite.function.aF(curSite.function.aFp):"string"==typeof curSite.function.aF?new Function("fun",curSite.function.aF)(window.autoPage):curSite.function.aF())}else console.log(curSite.pager.pageE,n,curSite.pager.insertP,t,e),curSite.retry?(console.warn("[自动无缝翻页] 获取主体元素失败，"+curSite.retry+"毫秒 后可向下翻网页来触发脚本尝试重新获取..."),setTimeout((function(){curSite.pageUrl=""}),curSite.retry)):console.error("[自动无缝翻页] 获取主体元素失败...")}function src_bF(e,t=[0,"img[data-original], img[data-src]","data-original"]){return void 0===t[2]&&(t[2]="data-original"),e.forEach((function(e){0==t[0]?"IMG"===e.tagName?e.getAttribute(t[2])?e.src=e.getAttribute(t[2]):e.dataset.src&&(e.src=e.dataset.src):e.querySelectorAll(t[1]).forEach((function(e){e.getAttribute(t[2])?e.src=e.getAttribute(t[2]):e.dataset.src&&(e.src=e.dataset.src)})):1==t[0]&&("IMG"===e.tagName?e.getAttribute(t[2])?e.style.backgroundImage='url("'+e.getAttribute(t[2])+'")':e.dataset.src&&(e.style.backgroundImage='url("'+e.dataset.src+'")'):e.querySelectorAll(t[1]).forEach((function(e){e.getAttribute(t[2])?e.style.backgroundImage='url("'+e.getAttribute(t[2])+'")':e.dataset.src&&(e.style.backgroundImage='url("'+e.dataset.src+'")')})))})),e}function xs_bF(e,t){return e.forEach((function(e){e.innerHTML=e.innerHTML.replace(t[0],t[1])})),e}function getNextE_(e){e||(e=curSite.pager.nextL);let t=getOne(e);if(t&&1===t.nodeType&&t.href&&"http"===t.href.slice(0,4)&&"#"!==t.getAttribute("href").slice(0,1)){if(t.href==curSite.pageUrl)return!1;if(curSite.pager.forceHTTPS&&"https:"===location.protocol){if(t.href.replace(/^http:/,"https:")===curSite.pageUrl)return!1;curSite.pageUrl=t.href.replace(/^http:/,"https:")}else curSite.pageUrl=t.href;return!0}return!1}function getNextE(e){if(!e){if("string"!=typeof curSite.pager.nextL||null!==curSite.pager.nextL.match(/^js;/i))return"";e=curSite.pager.nextL}let t=getOne(e);return t&&1===t.nodeType&&t.href&&"http"===t.href.slice(0,4)&&"#"!==t.getAttribute("href").slice(0,1)&&t.href!=curSite.pageUrl?curSite.pager.forceHTTPS&&"https:"===location.protocol?t.href.replace(/^http:/,"https:")===curSite.pageUrl?"":t.href.replace(/^http:/,"https:"):t.href:""}function getNextEP(e,t,n){let i=getOne(e),r="";return i&&i.textContent&&(i=i.textContent.replaceAll(" ",""),r=location.search?indexOF(t,"s")?location.search.replace(n,t+i):location.search+"&"+t+i:"?"+t+i,r=location.origin+location.pathname+r),r}function getNextSP(e,t,n){let i="";return e?("number"==typeof e&&(e=e.toString()),i=location.search?indexOF(t,"s")?location.search.replace(n,t+e):location.search+"&"+t+e:"?"+t+e,location.origin+location.pathname+i):i}function getNextEPN(e,t,n,i=""){let r=getOne(e),a="";return r&&r.textContent&&(r=r.textContent.replaceAll(" ",""),a=location.pathname&&indexOF(t)?location.pathname.replace(t,n+r+i):location.pathname+n+r+i,a=location.origin+a+location.search),a}function getNextUPN(e,t,n,i="",r="2",a){let o=e.exec(location.pathname);if(o){if(o=o.length>1?String(parseInt(o[1])+1):String(parseInt(o[0])+1),a&&parseInt(o)>parseInt(a))return""}else if(o=r,a&&parseInt(o)>=parseInt(a))return"";let c="";return c=location.pathname&&indexOF(t)?location.pathname.replace(t,n+o+i):location.pathname+n+o+i,c=location.origin+c+location.search,c}function getNextUP(e,t,n=location.pathname,i="2",r){let a=getSearch(e.replace("=",""));if(a){if(a=String(parseInt(a)+1),r&&parseInt(a)>parseInt(r))return""}else if(a=i,r&&parseInt(a)>=parseInt(r))return"";let o="";return o=location.search?indexOF(e,"s")?location.search.replace(t,e+a):location.search+"&"+e+a:"?"+e+a,o=location.origin+n+o,o}function getNextF(e){let t=getOne(e),n="";return t&&(t.querySelectorAll("input[name]").forEach((function(e){n+=e.name+"="+e.value+"&"})),n=encodeURI(n.replace(/&$/,"")),t.action&&n)?t.action+"?"+n:""}function checkURL(e){if(curSite.pager.nextL)if("function"==typeof curSite.pager.nextL){let t=curSite.pager.nextL();if(!t||t===curSite.pageUrl||"http"!==t.slice(0,4))return;curSite.pageUrl=t,e(curSite.pageUrl)}else if(0===curSite.pager.nextL.search(/^js;/i))try{let t=new Function("fun",curSite.pager.nextL.slice(3))(window.autoPage);if(!t||t===curSite.pageUrl||"http"!==t.slice(0,4))return;curSite.pageUrl=t,e(curSite.pageUrl)}catch(e){console.error('[自动无缝翻页] - 当前网页规则 "nextL" 内 JS 代码有误，请检查：\n',curSite.pager.nextL+"\n\n",e)}else getNextE_()&&e(curSite.pageUrl)}function replaceElems(e,t=curSite.pager.replaceE,n=curSite.pager.replaceE){let i,r;if(void 0===curSite.pager.replaceE&&curSite.pager.nextL&&0!==curSite.pager.nextL.search(/^js;/i)){let a=getOne(curSite.pager.nextL);a.nextElementSibling&&a.nextElementSibling.tagName===a.tagName||a.previousElementSibling&&a.previousElementSibling.tagName===a.tagName?"/"===curSite.pager.nextL.slice(0,1)||"./"===curSite.pager.nextL.slice(0,2)||"(/"===curSite.pager.nextL.slice(0,2)||"id("===curSite.pager.nextL.slice(0,3)?t=n=curSite.pager.nextL+"/..":(i=getAllParentElement(curSite.pager.nextL),r=getAllParentElement(curSite.pager.nextL,e,e)):t=n=curSite.pager.nextL}if(!i&&!r&&t&&n&&(i=getAll(t),r=getAll(n,e,e)),i&&r&&0!=i.length&&0!=r.length&&i.length===r.length){for(let e=0;e<i.length;e++)i[e].outerHTML=r[e].outerHTML;return!0}return void 0!==curSite.pager.replaceE&&console.log(e,i,r),!1}function addHistory(e,t,n){curSite.pageUrl&&"[object History]"===window.top.history.toString()&&(t=t||(e.querySelector("title")?e.querySelector("title").textContent:window.top.document.title),n=n||curSite.pageUrl,window.top.document.Autopage_nowUrl=curSite.pageUrl,-1===n.indexOf(window.top.location.protocol)&&(n=n.replace(/^https?:/,window.top.location.protocol)),window.top.history.pushState("Autopage_history",t,n),window.top.document.title=t)}function insScript(e,t=document,n=document.body){let i=t;e&&(t instanceof Array?(i=[],t.forEach((function(t){i=i.concat(getAll(e,t,t))}))):i=getAll(e,t,t)),i.forEach((function(e){"SCRIPT"===e.tagName&&(e.src?n.appendChild(document.createElement("script")).src=e.src:n.appendChild(document.createElement("script")).textContent=e.textContent)}))}function insStyle(e){-1===e.indexOf("{")&&(e+="{display: none !important;}"),document.documentElement.appendChild(document.createElement("style")).textContent=e}function getCSS(e,t=document){return t.querySelector(e)}function getAllCSS(e,t=document){return[].slice.call(t.querySelectorAll(e))}function getXpath(e,t,n=document){t=t||n;try{const i=n.evaluate(e,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return i.singleNodeValue&&1===i.singleNodeValue.nodeType&&i.singleNodeValue}catch(t){throw new Error(`无效 Xpath: ${e}`)}}function getAllXpath(e,t,n=document){t=t||n;const i=[];try{const r=n.evaluate(e,t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<r.snapshotLength;e++){const t=r.snapshotItem(e);1===t.nodeType&&i.push(t)}}catch(t){throw new Error(`无效 Xpath: ${e}`)}return i}function getOne(e,t=void 0,n=document){if(e)return t=t||n,"/"===e.slice(0,1)||"./"===e.slice(0,2)||"(/"===e.slice(0,2)||"id("===e.slice(0,3)?getXpath(e,t,n):getCSS(e,t)}function getAll(e,t=void 0,n=document){return e?(t=t||n,"/"===e.slice(0,1)||"./"===e.slice(0,2)||"(/"===e.slice(0,2)||"id("===e.slice(0,3)?getAllXpath(e,t,n):getAllCSS(e,t)):[]}function getAllParentElement(e,t=void 0,n=document){const i=[];return getAll(e,t=t||n,n).forEach((e=>{const t=e.parentElement;i.includes(t)||i.push(t)})),i}function createDocumentByString(e){if(e){if("HTML"!==document.documentElement.nodeName)return(new DOMParser).parseFromString(e,"application/xhtml+xml");var t;try{t=(new DOMParser).parseFromString(e,"text/html")}catch(e){}if(t)return t;if(document.implementation.createHTMLDocument)t=document.implementation.createHTMLDocument("ADocument");else try{(t=document.cloneNode(!1)).appendChild(t.importNode(document.documentElement,!1)),t.documentElement.appendChild(t.createElement("head")),t.documentElement.appendChild(t.createElement("body"))}catch(e){}if(t){var n=document.createRange(),i=n.createContextualFragment(e);n.selectNodeContents(document.body),t.body.appendChild(i);for(var r,a={TITLE:!0,META:!0,LINK:!0,STYLE:!0,BASE:!0},o=t.body,c=o.childNodes,l=c.length-1;l>=0;l--)a[(r=c[l]).nodeName]&&o.removeChild(r);return t}}else console.error("没有找到要转成 DOM 的字符串",e)}function openInTab(e,t){window.open(e)}function forceTarget(e){if(1===curSite.blank)document.head.appendChild(document.createElement("base")).target="_blank";else{if(5===curSite.blank||6===curSite.blank)return e||(e=getAll(curSite.pager.pageE)),e.forEach((function(e){getAllCSS('a[href]:not([target="_blank"]):not([onclick]):not([href^="#"]):not([href^="javascript:"])',e).forEach((function(e){if("http"==e.href.slice(0,4)){const t=e.cloneNode(!0);t.target="_blank",6===curSite.blank&&t.addEventListener("click",(function(e){e.stopPropagation()})),e.insertAdjacentElement("afterend",t),e.remove()}}))})),e;if(4===curSite.blank)return e||(e=getAll(curSite.pager.pageE)),e.forEach((function(e){getAllCSS('a[href]:not([target="_blank"]):not([onclick]):not([href^="#"]):not([href^="javascript:"])',e).forEach((function(e){"http"==e.href.slice(0,4)&&(e.target="_blank")}))})),e;{let t;if(2===curSite.blank)t=document.body;else if(3===curSite.blank){let i=toE5pop(getAll(curSite.pager.pageE));i&&null!=i.parentElement&&(t=i.parentElement)}if(!t)return;function n(e,t){e.href&&"_blank"!=e.target&&!e.getAttribute("onclick")&&"http"==e.href.slice(0,4)&&"#"!=e.getAttribute("href").slice(0,1)&&(t.stopPropagation(),t.preventDefault(),GM_openInTab(e.href,{active:!0,insert:!0,setParent:!0}))}t.addEventListener("click",(function(e){if("A"===e.target.tagName)n(e.target,e);else{let t=e.path||e.composedPath();for(let i=1;i<t.length-4;i++)if("A"===t[i].tagName){n(t[i],e);break}}}))}}}function cleanuEvent(e,t=0,n=-1){setTimeout((()=>{getAll(e).forEach((function(e){const t=e.cloneNode(!0);0!=n&&1!=n||null!=t.getAttribute("onclick")&&t.removeAttribute("onclick"),0!=n&&2!=n||t.addEventListener("click",(function(e){e.stopPropagation()})),e.insertAdjacentElement("afterend",t),e.remove()}),t)}))}function isHidden(e){return null===e.offsetParent}function isMobile(){return/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|MicroMessenger|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(navigator.userAgent)||window.screen.width<500&&window.screen.height<800}function isUrlC(){urlC=!0}function indexOF(e,t="p",n=!0){switch(t){case"h":t=location.href;break;case"p":t=location.pathname;break;case"s":t=location.search}if(e instanceof RegExp){if(e.test(t))return!0}else if(n&&(e=e.toLowerCase(),t=t.toLowerCase()),-1!=t.indexOf(e))return!0;return!1}function isTitle(e){return document.title.indexOf(e)>-1}function isPager(e){if(!e){if(!DBSiteNow.pager)return!1;if(void 0===DBSiteNow.pager.type||1===DBSiteNow.pager.type||3===DBSiteNow.pager.type||6===DBSiteNow.pager.type)"string"==typeof DBSiteNow.pager.nextL&&null===DBSiteNow.pager.nextL.match(/^js;/i)&&(e="n"),DBSiteNow.pager.pageE&&(e=e?"n,p":"p");else if(2===DBSiteNow.pager.type||5===DBSiteNow.pager.type)"string"==typeof DBSiteNow.pager.nextL&&null===DBSiteNow.pager.nextL.match(/^js;/i)&&(e="n");else if(4===DBSiteNow.pager.type)return!1;if(!e)return!1}const t="n,p".split(",");for(let e=0;e<t.length;e++)switch(t[e]){case"n":if(!getOne(DBSiteNow.pager.nextL))return!1;break;case"p":if(!getOne(DBSiteNow.pager.pageE))return!1;break;case"i":if(!getOne(DBSiteNow.pager.insertP[0]))return!1;break;case"r":if(!getOne(DBSiteNow.pager.replaceE))return!1}return!0}function getSearch(e){let t=window.location.search.substring(1).split("&");for(var n=0;n<t.length;n++){var i=t[n].split("=");if(i[0]==e)return i[1]}return""}function menu_disable(e){switch(e){case"check":return t();case"add":!function(){if(t())return;let e=GM_getValue("menu_disable");e.push(location.hostname),GM_setValue("menu_disable",e),location.reload()}();break;case"del":!function(){if(!t())return;let e=GM_getValue("menu_disable"),n=e.indexOf(location.hostname);e.splice(n,1),GM_setValue("menu_disable",e),location.reload()}()}function t(){return-1!=GM_getValue("menu_disable").indexOf(location.hostname)}}function pausePageEvent(){GM_getValue("menu_pause_page")&&0!==curSite.SiteTypeID&&(curSite.pager&&5==curSite.pager.type&&(window.top.document.xiu_pausePage=pausePage),document.body.addEventListener("dblclick",(function(){pausePage?GM_notification({text:"❌ 已暂停本页 [自动无缝翻页]\n    （再次双击可恢复）",timeout:2e3}):GM_notification({text:"✅ 已恢复本页 [自动无缝翻页]\n    （再次双击可暂停）",timeout:2e3}),document.querySelector("#Autopage_number")?document.querySelector("#Autopage_number").shadowRoot.querySelector("#Autopage_number_button").click():(pausePage=!pausePage,curSite.pager&&5==curSite.pager.type&&(window.top.document.xiu_pausePage=pausePage))})))}function customRules(){if(getCSS("#Autopage_customRules"))return;let e=customStringify(GM_getValue("menu_customRules",{}));"{}"==e&&(e="{\n    \n}");document.documentElement.insertAdjacentHTML("beforeend",'<div id="Autopage_customRules" style="display: initial !important;position: fixed !important;z-index: 9999999 !important;"></div>');let t=getCSS("#Autopage_customRules").attachShadow({mode:"open"});t.innerHTML='<style>* {font-family: system-ui !important;}</style><div style="left: 0; right: 0; top: 0; bottom: 0; width: 100%; height: 100%; margin: auto; padding: 25px 10px 10px 10px; position: fixed; opacity: 0.95; z-index: 9999999; background-color: #eee; color: #222; font-size: 14px; overflow: scroll; text-align: left;-webkit-touch-callout: text !important;-webkit-user-select: text !important;-khtml-user-select: text !important;-moz-user-select: text !important;-ms-user-select: text !important;user-select: text !important;">\n<h3 style="font-size: 22px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"><strong># 自定义翻页规则（优先级最高，会覆盖同名的外置翻页规则）-【将规则插入默认的 <code>{ }</code> 中间】</strong></h3>\n<details><summary style="cursor: pointer;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"><kbd><strong>「 点击展开 查看规则示例 」（为了避免需要的时候还要找，我干脆把常用规则都一股脑塞进去了）</strong></kbd></summary>\n<ul style="list-style: disc; margin-left: 35px;">\n<li>翻页规则为 JSON 格式，因此大家需要多少<strong>了解一点 JSON 的基本格式</strong>（主要就是末尾逗号、转义、双引号等）。</li>\n<li>具体的翻页规则说明、示例，为了方便更新及补充，我都写到 <strong><a href="https://github.com/XIU2/UserScript/issues/176" target="_blank">Github Issues</a></strong> 里面了。</li>\n<li>脚本会自动格式化规则，因此<strong>无需手动缩进、换行</strong>，只需把规则<strong>插入默认的 { } 中间</strong>即可。</li>\n</ul>\n<pre class="notranslate" style="white-space: pre-wrap;user-select: auto;">\n// 下面示例是把所有规则都塞进去了，但实际上大部分都用不上，大多数网站只需要像第一个 "aaa" 这样的规则（下方 示例一 中 url、replaceE、scrollD 均可按需省略）：\n\n// "aaa"       是规则名，唯一，因为 自定义翻页规则 优先级最高，所以会覆盖同名的 外置翻页规则\n// "host"      是域名，支持正则表达式（如 示例四），也可以像这样 示例三 那样写多个域名或正则表达式（当然也可以混用），如果省略，则默认匹配所有域名（会对所有域名匹配 url 规则判断，可以当成一个简单的外置/自定义通用规则的方案）\n// "url"       是用来控制哪些网站中页面适用该规则，省略后代表该规则应用于全站（如果不知道写什么，那么就写 return fun.isPager() 这样脚本会默认自动匹配当前网站下存在 nextL 及 pageE 元素的网页，大部分网站是没问题的，如果改为匹配 replaceE 或者其他组合，那么请去上面的 Github Issues 里的 内置函数 中查看具体使用方法）\n\n// "nextL"     是用来指定含有下一页地址的元素选择器（CSS 或 XPath 都行，一般都是 &lt;a&gt; 元素）\n// "pageE"     是指定要从下一页获取的元素选择器（也就是网页主体内容），并将其插入当前网页中同样元素的末尾\n// "replaceE"  用于将当前网页中的页码元素替换为下一页的页码元素选择器（这样才能无限翻页下去），省略后将会自动判断是替换 nextL 元素自身还是 nextL 元素的父元素（当 nextL 元素后面或前面有其自身 &lt;a&gt; 元素的相邻兄弟元素时脚本会替换其父元素，反之没有相邻兄弟元素则替换其自身，仅限模式1/3/6，且 "js;" 开头的 nextL 规则除外），值为空 "" 时则完全不替换\n// "scrollD"   是用来指定触发翻页的滚动条与底部之间的距离，当滚动条底部距离网页底部之间的距离等于或小于该值时，将触发翻页，因此值越大就越早触发翻页，访问速度慢的网站需要调大，可省略(记得移除上一行末尾逗号)，省略后默认 2000\n\n// "inherits"  是继承标识，当你只需要对某个外置规则中 增删改 部分规则内容时（比如只是修改域名），那么就可以像下面第二个 "aaa" 规则一样写一个同名规则，规则内只需要有要修改的 host 内容，以及 inherits 标识，这样脚本就会将这个自定义翻页规则中的 host 覆盖掉外置翻页规则中的 host，而该翻页规则内的其他规则内容则不变。即更灵活了，无需每次为了修改部分规则而去复制全部规则了，也不用担心我后续更新这个外置规则后，你还需要再次复制一遍来修改。。。\n\n{\n    "aaa": {\n        "host": "aaaa",\n        "url": "return fun.isPager()",\n        "pager": {\n            "nextL": "xxxx",\n            "pageE": "xxxx",\n            "replaceE": "xxxx",\n            "scrollD": 2000\n        }\n    },\n    "aaa": {\n        "host": "cccc",\n        "inherits": true\n    },\n    "bbb": {\n        "host": ["bbb1.com", "bbb2.com"],\n        "url": "/^\\\\/s$/",\n        "style": ".aaaa {xxx: xxx}（如果只是为了单纯屏蔽隐藏某些元素，那么这里只需要写 CSS 选择器即可，脚本会自动在末尾加上 {display: none !important;} 的）",\n        "blank": 3,\n        "hiddenPN": true,\n        "history": false,\n        "thread": true,\n        "iframe": true,\n        "pager": {\n            "type": 1,\n            "nextL": "id(\'page\')//a[contains(text(),\'下一页\')] || id(\'page2\')//a[text()=\'下一页\']",\n            "pageE": "aaa",\n            "insertP": [".bbb",3],\n            "replaceE": ".page",\n            "scriptT": 1,\n            "forceHTTPS": true,\n            "interval": 500,\n            "scrollD": 2000\n        },\n        "function": {\n            "bF": "return fun.src_bF(pageE, [0,\'img[data-src]\',\'data-src\'])",\n            "bFp": "关于上面这个解决图片懒加载的 bF，如果你要选择的图片是 img[data-original] 或 img[data-src]，那么是可以直接省略为：return fun.src_bF(pageE)",\n            "aF": "document.body.appendChild(document.createElement(\'script\')).textContent = \'xxx\'"\n        }\n    },\n    "这里也可以用中文": {\n        "host": "/\\\\.ccc\\\\.com/",\n        "url": "fun.isUrlC(); return (fun.lp() == \'/\' || fun.indexOF(\'/s\') || fun.isMobile())",\n        "pager": {\n            "type": 2,\n            "nextL": "#autopbn",\n            "nextText": "下一页",\n            "nextTextOf": "下一页",\n            "isHidden": true,\n            "interval": 1000,\n            "scrollD": 2000\n        }\n    }\n}\n</pre></details>\n<details><summary style="cursor: pointer;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"><kbd><strong>「 点击展开 查看所有规则 」（可按 Ctrl+F 搜索规则，脚本内置的通用规则因格式限制无法列出）</strong></kbd></summary>\n<pre id="Autopage_customRules_all" class="notranslate" style="overflow-y: scroll; overflow-x: hidden; height: 500px; word-break: break-all; white-space: pre-wrap;user-select: auto;"> </pre></details>\n\n<textarea id="Autopage_customRules_textarea" style="min-width:95%; min-height:70%; display: block; margin: 10px 0 10px 0; white-space:pre; overflow:scroll; resize: revert; text-transform: initial;" placeholder="留空等于默认的 {}，请把规则插入 {} 之间"></textarea>\n<button id="Autopage_customRules_save" style="margin-right: 20px;">保存并刷新</button><button id="Autopage_customRules_cancel">取消修改</button>\n</div>',document.documentElement.style.overflow=document.body.style.overflow="hidden",getCSS("#Autopage_customRules_textarea",t).textContent=e,getCSS("#Autopage_customRules_all",t).textContent=customStringify(DBSite2),getCSS("#Autopage_customRules_save",t).onclick=function(){e=getCSS("#Autopage_customRules_textarea",t).value,e||(e="{}");try{e=JSON.parse(e),GM_setValue("menu_customRules",e),location.reload()}catch(e){console.error("自定义规则存在格式错误：\n"+e+'\n\n格式错误一般为：\n· 逗号：每组 {} 中的最后一个值末尾不能加逗号\n\n· 转义：如果正则表达式中含有转义符 \\ 那就要对其再次转义为 \\\\\n\n· 双引号：规则中冒号左右的内容都需要加上双引号，如果内容中含有双引号则需要对双引号转义（即 \\" 这样），或改为单引号'),window.alert("自定义规则存在格式错误：\n"+e+'\n\n格式错误一般为：\n· 逗号：每组 {} 中的最后一个值末尾不能加逗号\n\n· 转义：如果正则表达式中含有转义符 \\ 那就要对其再次转义为 \\\\\n\n· 双引号：规则中冒号左右的内容都需要加上双引号，如果内容中含有双引号则需要对双引号转义（即 \\" 这样），或改为单引号')}},getCSS("#Autopage_customRules_cancel",t).onclick=function(){document.documentElement.style.overflow=document.body.style.overflow="",getCSS("#Autopage_customRules").remove()}}function customStringify(e){return JSON.stringify(e,null,4).replace(/(: \[)([\s\S]*?)(\],?\n)/g,((e,t,n,i)=>t+n.replace(/\n/g,"").replace(/\s{4}/g,"")+i))}function pageNumber(e){if(0===curSite.SiteTypeID||curSite.hiddenPN||curSite.pager&&5==curSite.pager.type&&self!=top)return void(getCSS("#Autopage_number")&&getCSS("#Autopage_number").shadowRoot&&(getCSS("#Autopage_number_button",getCSS("#Autopage_number").shadowRoot).style.display="none"));let t;switch(getCSS("#Autopage_number")&&getCSS("#Autopage_number").shadowRoot&&(t=getCSS("#Autopage_number_button",getCSS("#Autopage_number").shadowRoot)),e){case"add":!function(){if(t)return void("none"===t.style.display&&(t.style.display="flex"));let e="<style>#Autopage_number_button {top: calc(75vh);left: 0;width: 32px;height: 32px;padding: 6px;display: flex;position: fixed;opacity: 0.3;transition: .2s;z-index: 9999998;cursor: pointer;user-select: none;flex-direction: column;align-items: center;justify-content: center;box-sizing: content-box;border-radius: 0 50% 50% 0;transform-origin: center;transform: translateX(-8px);background-color: #eee;-webkit-tap-highlight-color: transparent;box-shadow: 1px 1px 3px 0px #aaa;color: #000;font-size: medium;font-family: system-ui;} @media (any-hover: none) {#Autopage_number_button:active {opacity: 0.8;transform: translateX(0);}}@media (any-hover: hover) {#Autopage_number_button:hover {opacity: 0.8;transform: translateX(0);}}</style>",i=`<div id="Autopage_number_button" title="1. 此为【当前页码】（仅指脚本翻了多少页，并非实际页码，该页码可在脚本菜单中关闭）&#10;&#10;2. 鼠标【左键】点击此处可【临时暂停翻页】（再次点击可恢复）&#10;&#10;3. 鼠标【右键】点击此处可【回到顶部】">${pageNum._now}</div>`;document.documentElement.insertAdjacentHTML("beforeend",'<div id="Autopage_number" style="display: flex !important;position: fixed !important;z-index: 9999998 !important;"></div>');let r=getCSS("#Autopage_number").attachShadow({mode:"open"});r.innerHTML=e+i,curSite.pager&&5==curSite.pager.type&&(window.top.document.xiu_pausePage=pausePage);t=getCSS("#Autopage_number_button",r),t.onclick=function(e){return pausePage?(this.style.color="#FF5722",this.style.fontStyle="italic"):this.style="",pausePage=!pausePage,curSite.pager&&5==curSite.pager.type&&(window.top.document.xiu_pausePage=pausePage),e.preventDefault(),e.stopPropagation(),!1},t.oncontextmenu=function(e){return window.scrollTo(0,0),e.preventDefault(),e.stopPropagation(),!1},n()}();break;case"del":!function(){if(!t)return;t.style.display="none"}();break;case"set":n()}function n(){Object.defineProperty(pageNum,"now",{set:function(e){this._now=e,t&&(t.textContent=e)}})}}function pageNumIncrement(e=1){pageNum.now=pageNum._now+e}function menu_switch(e,t,n){!0===e?GM_setValue(t,!1):GM_setValue(t,!0),"menu_page_number"===t?(pageNumber(!0===e?"del":"add"),registerMenuCommand(),0!==curSite.SiteTypeID&&curSite.pager&&(void 0===curSite.pager.type&&(curSite.pager.type=1),void 0===curSite.pager.scrollD&&(curSite.pager.scrollD=2e3),void 0===curSite.pager.interval&&(curSite.pager.interval=500))):location.reload()}function setSiteTypeID(){let e=0;for(let t in DBSite)DBSite[t].SiteTypeID=++e}function loadMoreExclude(e){for(let t=0;t<e.length;t++)if(-1!=location.hostname.indexOf(e[t]))return!1;return!0}function getCookie(e){if(!e)return"";let t=document.cookie.split(";");e+="=";for(let n=0;n<t.length;n++){let i=t[n].trim();if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""}function getAddTo(e){switch(e){case 1:return"beforebegin";case 2:return"afterbegin";case 3:case 6:return"beforeend";case 4:case 5:return"afterend"}}function toE5pop(e){if(0===e.length)return;let t=e.pop();return"SCRIPT"===t.tagName||"STYLE"===t.tagName||"LINK"===t.tagName?toE5pop(e):t}function windowScroll(e){var t=document.documentElement.scrollTop||document.body.scrollTop,n=e||function(){};setTimeout((function(){let e=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,i=window.innerHeight||document.documentElement.clientHeight;0===e&&document.documentElement.scrollHeight===i&&insStyle(`html, body {min-height: ${document.documentElement.scrollHeight+10}px;}`),window.addEventListener("scroll",(function(e){var i=document.documentElement.scrollTop||document.body.scrollTop,r=i-t;if(0==r)return!1;n(r>0?"down":"up",e),t=i}),!1)}),1e3)}function addUrlChangeEvent(){var e;history.pushState=(e=history.pushState,function(){var t=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("urlchange")),t}),history.replaceState=(e=>function(){var t=e.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("urlchange")),t})(history.replaceState),window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("urlchange"))}))}"function"!=typeof GM_openInTab&&(GM_openInTab=openInTab),"function"!=typeof window.structuredClone&&(window.structuredClone=function(e){return JSON.parse(JSON.stringify(e))}),getRulesUrl(),registerMenuCommand(),menuId.length<4||(webTypeIf(),GM_getValue("menu_thread")||curSite.thread&&(curSite={SiteTypeID:0},pageNum.now=1),GM_getValue("menu_page_number")?pageNumber("add"):pageNumber("set"),pausePageEvent(),null!=curSite.blank&&setTimeout(forceTarget,1e3),urlC&&(nowLocation=location.href,void 0===window.onurlchange&&addUrlChangeEvent(),1===webType?window.addEventListener("urlchange",(function(){lp=location.pathname,!1===curSite.history||window.top.document.Autopage_nowUrl!==location.href?nowLocation!=location.href&&(curSite.pager&&5==curSite.pager.type&&(self!=top?window.top.location.href=location.href:getCSS("iframe#Autopage_iframe")&&getCSS("iframe#Autopage_iframe").remove(),pausePage=!0),nowLocation=location.href,curSite={SiteTypeID:0},pageNum.now=1,registerMenuCommand(),null!=curSite.blank&&setTimeout(forceTarget,1e3),curSite.style&&insStyle(curSite.style),GM_getValue("menu_thread")||curSite.thread&&(curSite={SiteTypeID:0},pageNum.now=1),GM_getValue("menu_page_number")?pageNumber("add"):pageNumber("set"),pausePageEvent(),pageLoading()):nowLocation=location.href})):2===webType?window.addEventListener("urlchange",(function(){lp=location.pathname,nowLocation!=location.href&&setTimeout((function(){nowLocation=location.href,curSite={SiteTypeID:0},pageNum.now=1,discuz_(),GM_getValue("menu_thread")||curSite.thread&&(curSite={SiteTypeID:0},pageNum.now=1),curSite.style&&insStyle(curSite.style),GM_getValue("menu_page_number")?pageNumber("add"):pageNumber("set"),pausePageEvent(),pageLoading()}),500)})):3===webType&&window.addEventListener("urlchange",(function(){lp=location.pathname,nowLocation!=location.href&&(nowLocation=location.href,curSite={SiteTypeID:0},pageNum.now=1,DBSite.flarum.url(),curSite.style&&insStyle(curSite.style),GM_getValue("menu_page_number")?pageNumber("add"):pageNumber("set"),pausePageEvent(),pageLoading())}))),curSite.style&&insStyle(curSite.style),pageLoading())})();