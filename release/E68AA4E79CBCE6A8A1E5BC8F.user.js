// ==UserScript==
// @name         æŠ¤çœ¼æ¨¡å¼
// @name:zh-CN   æŠ¤çœ¼æ¨¡å¼
// @name:zh-TW   è­·çœ¼æ¨¡å¼
// @name:en      Dark Mode
// @version      1.5.5
// @author       X.I.U
// @description  ç®€å•æœ‰æ•ˆçš„å…¨ç½‘é€šç”¨æŠ¤çœ¼æ¨¡å¼ï¼ˆå¤œé—´æ¨¡å¼ã€æš—é»‘æ¨¡å¼ã€æ·±è‰²æ¨¡å¼ï¼‰
// @description:zh-CN  ç®€å•æœ‰æ•ˆçš„å…¨ç½‘é€šç”¨æŠ¤çœ¼æ¨¡å¼ï¼ˆå¤œé—´æ¨¡å¼ã€æš—é»‘æ¨¡å¼ã€æ·±è‰²æ¨¡å¼ï¼‰
// @description:zh-TW  ç°¡å–®æœ‰æ•ˆçš„å…¨ç¶²é€šç”¨è­·çœ¼æ¨¡å¼ï¼ˆå¤œé–“æ¨¡å¼ã€æš—é»‘æ¨¡å¼ã€æ·±è‰²æ¨¡å¼ï¼‰
// @description:en  Simple and effective network-wide eye protection mode (night mode, dark mode, dark mode)
// @match        *://*/*
// @icon         data:image/png;base64,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
// @grant        GM_registerMenuCommand
// @grant        GM_unregisterMenuCommand
// @grant        GM_openInTab
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_notification
// @sandbox      JavaScript
// @noframes
// @license      GPL-3.0 License
// @run-at       document-start
// @namespace    https://github.com/XIU2/UserScript
// @supportURL   https://github.com/XIU2/UserScript
// @homepageURL  https://github.com/XIU2/UserScript
// @downloadURL https://raw.githubusercontent.com/s0uboxxx/Userscripts-GCC/release/release/E68AA4E79CBCE6A8A1E5BC8F.user.js
// @updateURL https://raw.githubusercontent.com/s0uboxxx/Userscripts-GCC/release/release/E68AA4E79CBCE6A8A1E5BC8F.meta.js
// ==/UserScript==
!function(){"use strict";var e=[["menu_disable","âœ… å·²å¯ç”¨ (ç‚¹å‡»å¯¹å½“å‰ç½‘ç«™ç¦ç”¨)","âŒ å·²ç¦ç”¨ (ç‚¹å‡»å¯¹å½“å‰ç½‘ç«™å¯ç”¨)",[]],["menu_runDuringTheDay","ç™½å¤©ä¿æŒå¼€å¯ (æ¯”æ™šä¸Šäº®ä¸€ç‚¹ç‚¹)","ç™½å¤©ä¿æŒå¼€å¯",!0],["menu_darkModeAuto","æŠ¤çœ¼æ¨¡å¼è·Ÿéšæµè§ˆå™¨","æŠ¤çœ¼æ¨¡å¼è·Ÿéšæµè§ˆå™¨",!1],["menu_autoRecognition","æ™ºèƒ½æ’é™¤è‡ªå¸¦æš—é»‘æ¨¡å¼çš„ç½‘é¡µ (beta)","æ™ºèƒ½æ’é™¤è‡ªå¸¦æš—é»‘æ¨¡å¼çš„ç½‘é¡µ (beta)",!0],["menu_forcedToEnable","âœ… å·²å¼ºåˆ¶å½“å‰ç½‘ç«™å¯ç”¨æŠ¤çœ¼æ¨¡å¼ (ğŸ‘†)","âŒ æœªå¼ºåˆ¶å½“å‰ç½‘ç«™å¯ç”¨æŠ¤çœ¼æ¨¡å¼ (ğŸ‘†)",[]],["menu_darkModeType","ç‚¹å‡»åˆ‡æ¢æ¨¡å¼","ç‚¹å‡»åˆ‡æ¢æ¨¡å¼",2],["menu_customMode","è‡ªå®šä¹‰å½“å‰æ¨¡å¼","è‡ªå®šä¹‰å½“å‰æ¨¡å¼",!0],["menu_customMode1",,,"60|50"],["menu_customMode2",,,"60|40|50|50"],["menu_customMode3",,,"90"],["menu_customMode3_exclude",,,'img, .img, video, [style*="background"][style*="url"], svg'],["menu_customTime","è‡ªå®šä¹‰æ˜¼å¤œæ—¶é—´","è‡ªå®šä¹‰æ˜¼å¤œæ—¶é—´","6:00|18:00"],["menu_autoSwitch","æ™šä¸Šè‡ªåŠ¨åˆ‡æ¢æ¨¡å¼","æ™šä¸Šè‡ªåŠ¨åˆ‡æ¢æ¨¡å¼",""]],t=[];for(let t=0;t<e.length;t++)null==GM_getValue(e[t][0])&&GM_setValue(e[t][0],e[t][3]);function o(){if(t.length!=[])for(let e=0;e<t.length;e++)GM_unregisterMenuCommand(t[e]);for(let s=0;s<e.length;s++)if(e[s][3]=GM_getValue(e[s][0]),"menu_disable"===e[s][0]){if(i("check"))return void(t[s]=GM_registerMenuCommand(`${e[s][2]}`,(function(){i("del")})));if(GM_getValue("menu_darkModeAuto")&&!window.matchMedia("(prefers-color-scheme: dark)").matches)return void(t[s]=GM_registerMenuCommand("âŒ å½“å‰æµè§ˆå™¨ä¸ºç™½å¤©æ¨¡å¼ (ç‚¹å‡»å…³é—­ [æŠ¤çœ¼æ¨¡å¼è·Ÿéšæµè§ˆå™¨])",(function(){GM_setValue("menu_darkModeAuto",!1),location.reload()})));t[s]=GM_registerMenuCommand(`${e[s][1]}`,(function(){i("add")}))}else if("menu_darkModeType"===e[s][0]){e[s][3]>3&&(e[s][3]=1,GM_setValue(e[s][0],e[s][3]));let n=a();t[s]=GM_registerMenuCommand(`${o=n,["0ï¸âƒ£","1ï¸âƒ£","2ï¸âƒ£","3ï¸âƒ£","4ï¸âƒ£","5ï¸âƒ£","6ï¸âƒ£","7ï¸âƒ£","8ï¸âƒ£","9ï¸âƒ£","ğŸ”Ÿ"][o]} ${e[s][1]}`,(function(){m(`${e[s][3]}`,`${e[s][0]}`)}))}else"menu_customMode"===e[s][0]?(GM_setValue(e[s][0],e[s][3]),t[s]=GM_registerMenuCommand(`#ï¸âƒ£ ${e[s][1]}`,(function(){r()}))):"menu_customTime"===e[s][0]?(GM_setValue(e[s][0],e[s][3]),t[s]=GM_registerMenuCommand(`#ï¸âƒ£ ${e[s][1]}`,(function(){l()}))):"menu_customMode1"===e[s][0]||"menu_customMode2"===e[s][0]||"menu_customMode3"===e[s][0]||"menu_customMode3_exclude"===e[s][0]?GM_setValue(e[s][0],e[s][3]):"menu_autoSwitch"===e[s][0]?t[s]=GM_registerMenuCommand(`#ï¸âƒ£ ${e[s][1]}`,(function(){n()})):"menu_forcedToEnable"===e[s][0]?c("menu_autoRecognition")&&(u("check")?t[s]=GM_registerMenuCommand(`${e[s][1]}`,(function(){u("del")})):t[s]=GM_registerMenuCommand(`${e[s][2]}`,(function(){u("add")}))):t[s]=GM_registerMenuCommand(`${e[s][3]?"âœ…":"âŒ"} ${e[s][1]}`,(function(){d(`${e[s][3]}`,`${e[s][0]}`,`${e[s][2]}`)}));var o;t[t.length]=GM_registerMenuCommand("ğŸ’¬ åé¦ˆ & å»ºè®®",(function(){window.GM_openInTab("https://github.com/XIU2/UserScript#xiu2userscript",{active:!0,insert:!0,setParent:!0}),window.GM_openInTab("https://greasyfork.org/zh-CN/scripts/426377/feedback",{active:!0,insert:!0,setParent:!0})}))}function n(){let e=prompt("ç™½å¤©ã€æ™šä¸Šä½¿ç”¨ä¸åŒæ¨¡å¼ï¼Œä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ~\næ ¼å¼ï¼šç™½å¤©æ¨¡å¼|æ™šä¸Šæ¨¡å¼\nä¾‹å¦‚ï¼š1|3ï¼ˆå³ç™½å¤©æ¨¡å¼ 1 æ™šä¸Šæ¨¡å¼ 3ï¼‰\né»˜è®¤ï¼šç•™ç©ºï¼ˆå³å…³é—­è¯¥åŠŸèƒ½ï¼‰",GM_getValue("menu_autoSwitch"));""===e?GM_setValue("menu_autoSwitch",""):null!=e&&(2==e.split("|").length?GM_setValue("menu_autoSwitch",e):alert("å¡«å…¥å†…å®¹æ ¼å¼é”™è¯¯...")),o(),document.getElementById("XIU2DarkMode")&&(document.getElementById("XIU2DarkMode").remove(),s())}function a(){let e=GM_getValue("menu_darkModeType");(new Date).getHours(),GM_getValue("menu_customTime").split("|").map(Number);return""!=GM_getValue("menu_autoSwitch")&&(e=h()?GM_getValue("menu_autoSwitch").split("|")[0]:GM_getValue("menu_autoSwitch").split("|")[1]),parseInt(e)}function r(){let e,t,n,r;switch(a()){case 1:t="è‡ªå®šä¹‰ [æ¨¡å¼ 1]ï¼Œä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ (éƒ¨åˆ†ç½‘é¡µå¯èƒ½éœ€è¦åˆ·æ–°)~\næ ¼å¼ï¼šäº®åº¦ (ç™½å¤©)|äº®åº¦ (æ™šä¸Š)\né»˜è®¤ï¼š60|50ï¼ˆå‡ä¸ºç™¾åˆ†æ¯” 1~100ï¼Œä¸éœ€è¦ % ç¬¦å·ï¼‰",n="60|50",r="menu_customMode1";break;case 2:t="è‡ªå®šä¹‰ [æ¨¡å¼ 2]ï¼Œä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ (éƒ¨åˆ†ç½‘é¡µå¯èƒ½éœ€è¦åˆ·æ–°)~\næ ¼å¼ï¼šäº®åº¦ (ç™½å¤©)|æš–è‰² (ç™½å¤©)|äº®åº¦ (æ™šä¸Š)|æš–è‰² (æ™šä¸Š)\né»˜è®¤ï¼š60|40|50|50ï¼ˆå‡ä¸ºç™¾åˆ†æ¯” 1~100ï¼Œä¸éœ€è¦ % ç¬¦å·ï¼‰",n="60|40|50|50",r="menu_customMode2";break;case 3:t="è‡ªå®šä¹‰ [æ¨¡å¼ 3]ï¼Œä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ (éƒ¨åˆ†ç½‘é¡µå¯èƒ½éœ€è¦åˆ·æ–°)~\næ ¼å¼ï¼šåè‰²\né»˜è®¤ï¼š90ï¼ˆå‡ä¸ºç™¾åˆ†æ¯” 50~100ï¼Œä¸éœ€è¦ % ç¬¦å·ï¼‰",n="90",r="menu_customMode3"}e=prompt(t,GM_getValue(`${r}`)),""===e?(GM_setValue(`${r}`,n),o()):null!=e&&(GM_setValue(`${r}`,e),o()),3==a()&&(t='è‡ªå®šä¹‰ [æ¨¡å¼ 3] æ’é™¤ç›®æ ‡ï¼Œä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ (éƒ¨åˆ†ç½‘é¡µå¯èƒ½éœ€è¦åˆ·æ–°)~\næ ¼å¼ï¼šCSS é€‰æ‹©å™¨ (å¦‚æœä¸ä¼šå†™å¯ä»¥æ‰¾æˆ‘)\né»˜è®¤ï¼šimg, .img, video, [style*="background"][style*="url"], svg\n (ä½¿ç”¨è‹±æ–‡é€—å·é—´éš”ï¼Œæœ«å°¾ä¸è¦æœ‰é€—å·)',n='img, .img, video, [style*="background"][style*="url"], svg',r="menu_customMode3_exclude",e=prompt(t,GM_getValue(`${r}`)),""===e?(GM_setValue(`${r}`,n),o()):null!=e&&(GM_setValue(`${r}`,e),o())),document.getElementById("XIU2DarkMode")&&(document.getElementById("XIU2DarkMode").remove(),s())}function l(){let e=prompt("è‡ªå®šä¹‰è„šæœ¬å†…å’Œç™½å¤©/æ™šä¸Šç›¸å…³çš„æ—¶é—´ï¼Œä¿®æ”¹ååˆ·æ–°ç½‘é¡µç”Ÿæ•ˆ~\næ ¼å¼ï¼š6:00|18:30 (å³ 6:00 ~ 18:30 ä¹‹é—´æ˜¯ç™½å¤©æ—¶é—´)\nä¹Ÿæ”¯æŒåå‘è®¾ç½®ï¼š14:00|12:00 (å³ 12:00 ~ 14:00 ä¹‹é—´æ˜¯å¤œæ™šæ—¶é—´)",GM_getValue("menu_customTime"));""===e?(GM_setValue("menu_customTime","6:00|18:00"),o()):null!=e&&(GM_setValue("menu_customTime",e),o())}function u(e){switch(e){case"check":return!!t();case"add":!function(){if(t())return;let e=c("menu_forcedToEnable");e.push(location.host),GM_setValue("menu_forcedToEnable",e),location.reload()}();break;case"del":!function(){if(!t())return;let e=c("menu_forcedToEnable"),o=e.indexOf(location.host);e.splice(o,1),GM_setValue("menu_forcedToEnable",e),location.reload()}()}function t(){return-1!==c("menu_forcedToEnable").indexOf(location.host)}}function i(e){switch(e){case"check":return!!t();case"add":!function(){if(t())return;let e=c("menu_disable");e.push(location.host),GM_setValue("menu_disable",e),location.reload()}();break;case"del":!function(){if(!t())return;let e=c("menu_disable"),o=e.indexOf(location.host);e.splice(o,1),GM_setValue("menu_disable",e),location.reload()}()}function t(){return-1!==c("menu_disable").indexOf(location.host)}}function m(e,t){(e=parseInt(e))>=3?e=1:e+=1,GM_setValue(`${t}`,e),o(),document.getElementById("XIU2DarkMode")&&(document.getElementById("XIU2DarkMode").remove(),s())}function d(e,t,n){"true"==e?(GM_setValue(`${t}`,!1),GM_notification({text:`å·²å…³é—­ [${n}] åŠŸèƒ½\nï¼ˆç‚¹å‡»åˆ·æ–°ç½‘é¡µåç”Ÿæ•ˆï¼‰`,timeout:3500,onclick:function(){location.reload()}})):(GM_setValue(`${t}`,!0),GM_notification({text:`å·²å¼€å¯ [${n}] åŠŸèƒ½\nï¼ˆç‚¹å‡»åˆ·æ–°ç½‘é¡µåç”Ÿæ•ˆï¼‰`,timeout:3500,onclick:function(){location.reload()}})),"menu_autoRecognition"===t&&location.reload(),o()}function c(t){for(let o of e)if(o[0]==t)return o[3]}function s(){let e=!1,t=document.createElement("style"),o=((new Date).getHours(),c("menu_customMode1").split("|")),n=c("menu_customMode2").split("|"),r=c("menu_customMode3").split("|"),l="",u=`html {filter: brightness(${o[0]}%) !important;}`,i=`html {filter: brightness(${o[0]}%) !important; background-image: url();}`,m=`html {filter: brightness(${o[1]}%) !important;}`,d=`html {filter: brightness(${o[1]}%) !important; background-image: url();}`,s=`html {filter: brightness(${n[0]}%) sepia(${n[1]}%) !important;}`,_=`html {filter: brightness(${n[0]}%) sepia(${n[1]}%) !important; background-image: url();}`,f=`html {filter: brightness(${n[2]}%) sepia(${n[3]}%) !important;}`,b=`html {filter: brightness(${n[2]}%) sepia(${n[3]}%) !important; background-image: url();}`,p=`html {filter: invert(${r[0]}%) !important; text-shadow: 0 0 0 !important;}\n            ${c("menu_customMode3_exclude")} {filter: invert(1) !important;}\n            img[alt="[å…¬å¼]"] {filter: none !important;}`,M=`html {filter: invert(${r[0]}%) !important; background-image: url(); text-shadow: 0 0 0 !important;}\n            ${c("menu_customMode3_exclude")} {filter: invert(1) !important;}\n            img[alt="[å…¬å¼]"] {filter: none !important;}`;switch(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(u=i,m=d,s=_,f=b,p=M),h()&&(c("menu_runDuringTheDay")?(m=u,f=s):m=f=""),a()){case 1:l+=m;break;case 2:l+=f;break;case 3:l+=p+"::-webkit-scrollbar {height: 12px !important;}\n::-webkit-scrollbar-thumb {border-radius: 0;border-color: transparent;border-style: dashed;background-color: #3f4752 !important;background-clip: padding-box;transition: background-color .32s ease-in-out;}\n::-webkit-scrollbar-corner {background: #202020 !important;}\n::-webkit-scrollbar-track {background-color: #22272e !important;}\n::-webkit-scrollbar-thumb:hover {background: #3f4752 !important;}",location.hostname.indexOf("search.bilibili.com")>-1?l+="ul.video-list img, ul.video-list .video-item .img .mask-video, ul.video-list .video-item .img .van-danmu, ul.video-list .video-item .img .van-framepreview {filter: none !important;}":location.hostname.indexOf(".bilibili.com")>-1?l+='\n.bpx-player-container[data-screen="full"] .bpx-player-video-wrap {filter: invert(1) !important;}\n.bpx-player-container[data-screen="web"] {filter: invert(1) !important;}\n.bpx-player-container[data-screen="web"] video {filter: none !important;}\n* {font-weight: bold !important;}':location.hostname.indexOf(".huya.com")>-1&&(l+='#player-wrap[style="height: 100%;"], .player-loading, .sidebar-show, #player-ctrl-wrap {filter: invert(1) !important;}')}if(t.id="XIU2DarkMode",t.type="text/css",document.lastElementChild)document.lastElementChild.appendChild(t).textContent=l;else{let e=setInterval((function(){document.lastElementChild&&(clearInterval(e),document.lastElementChild.appendChild(t).textContent=l)}))}let k=[];c("menu_autoRecognition")&&(k=c("menu_forcedToEnable"));let w=setInterval((function(){document.body&&(clearInterval(w),setTimeout((function(){if(console.log("[æŠ¤çœ¼æ¨¡å¼] html:",window.getComputedStyle(document.lastElementChild).backgroundColor,"body:",window.getComputedStyle(document.body).backgroundColor),"rgba(0, 0, 0, 0)"!==window.getComputedStyle(document.body).backgroundColor||"rgba(0, 0, 0, 0)"!==window.getComputedStyle(document.lastElementChild).backgroundColor||document.querySelector('head>meta[name="color-scheme"],head>link[href^="resource:"]')&&window.matchMedia("(prefers-color-scheme: dark)").matches){if((document.querySelector('head>meta[name="color-scheme"],head>link[href^="resource:"]')&&window.matchMedia("(prefers-color-scheme: dark)").matches||document.querySelector("html[class*=dark], html[data-dark-theme*=dark], html[data-theme*=dark], html[data-color-mode*=dark], body[class*=dark]")||"rgb(0, 0, 0)"===window.getComputedStyle(document.body).backgroundColor||g(document.body)>0&&g(document.body)<898989||g(document.lastElementChild)>0&&g(document.lastElementChild)<898989||"rgba(0, 0, 0, 0)"===window.getComputedStyle(document.body).backgroundColor&&"rgb(0, 0, 0)"===window.getComputedStyle(document.lastElementChild).backgroundColor)&&c("menu_autoRecognition")){for(let e=0;e<k.length;e++)if(k[e]===location.host)return;console.log("[æŠ¤çœ¼æ¨¡å¼] æ£€æµ‹åˆ°å½“å‰ç½‘é¡µè‡ªå¸¦æš—é»‘æ¨¡å¼ï¼Œåœç”¨æœ¬è„šæœ¬æ»¤é•œ..."),document.getElementById("XIU2DarkMode").remove(),e=!0}}else{let e=document.createElement("style");e.id="XIU2DarkMode2",document.lastElementChild.appendChild(e).textContent="html, body {background-color: #ffffff !important;}"}}),150),setTimeout((function(){if(console.log("[æŠ¤çœ¼æ¨¡å¼] html:",window.getComputedStyle(document.lastElementChild).backgroundColor,"body:",window.getComputedStyle(document.body).backgroundColor),(document.querySelector('head>meta[name="color-scheme"],head>link[href^="resource:"]')&&window.matchMedia("(prefers-color-scheme: dark)").matches||document.querySelector("html[class*=dark], html[data-dark-theme*=dark], html[data-theme*=dark], html[data-color-mode*=dark], body[class*=dark]")||"rgb(0, 0, 0)"===window.getComputedStyle(document.body).backgroundColor||g(document.body)>0&&g(document.body)<898989||g(document.lastElementChild)>0&&g(document.lastElementChild)<898989||"rgba(0, 0, 0, 0)"===window.getComputedStyle(document.body).backgroundColor&&"rgb(0, 0, 0)"===window.getComputedStyle(document.lastElementChild).backgroundColor)&&c("menu_autoRecognition")){for(let e=0;e<k.length;e++)if(k[e]===location.host)return;if(e)return;console.log("[æŠ¤çœ¼æ¨¡å¼] æ£€æµ‹åˆ°å½“å‰ç½‘é¡µè‡ªå¸¦æš—é»‘æ¨¡å¼ï¼Œåœç”¨æœ¬è„šæœ¬æ»¤é•œ...."),document.getElementById("XIU2DarkMode")&&document.getElementById("XIU2DarkMode").remove(),document.getElementById("XIU2DarkMode2")&&document.getElementById("XIU2DarkMode2").remove()}}),1500))}));if("bbs.pcbeta.com"===location.hostname){let e=setInterval((function(){document.getElementById("XIU2DarkMode")||(document.lastElementChild.appendChild(t).textContent=l,clearInterval(e))}))}}function g(e){let t=window.getComputedStyle(e).backgroundColor.replace(/rgba|rgb|\(|\)| /g,"").split(",");return parseInt(t[0]+t[1]+t[2])}function h(){let e=new Date("2022/03/07 "+(new Date).getHours()+":"+(new Date).getMinutes()+":00").getTime()/1e3,t=GM_getValue("menu_customTime").split("|");return t[0]=new Date("2022/03/07 "+t[0]+":00").getTime()/1e3,t[1]=new Date("2022/03/07 "+t[1]+":00").getTime()/1e3,t[0]<t[1]?e>t[0]&&e<t[1]:e>t[0]||e<t[1]}o(),-1===GM_getValue("menu_customTime","").indexOf(":")&&GM_setValue("menu_customTime",GM_getValue("menu_customTime","6|18").replace("|",":00|")+":00"),t.length>1&&s()}();